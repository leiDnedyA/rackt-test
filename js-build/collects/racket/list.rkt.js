import * as $rjs_core from '../../runtime/core.js';import * as M0 from "./private/for.rkt.js";import * as M1 from "./private/kw.rkt.js";import * as M2 from "../../runtime/kernel.rkt.js";import * as M3 from "./private/member.rkt.js";import * as M4 from "./private/map.rkt.js";import * as M5 from "./private/pre-base.rkt.js";import * as M6 from "./private/list.rkt.js";import * as M7 from "./private/qq-and-or.rkt.js";import * as M8 from "./private/reverse.rkt.js";import * as M9 from "./private/more-scheme.rkt.js";import * as M10 from "../../runtime/unsafe.rkt.js";var first = function(x1145) {if (M2.pair_p(x1145)!==false) {var if_res603 = M2.list_p(x1145);} else {var if_res603 = false;}if (if_res603!==false) {var if_res604 = M2.car(x1145);} else {var if_res604 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("first"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),x1145);}return if_res604;};var second = function(l01146) {if (M2.list_p(l01146)!==false) {var loop1147 = function(l1148, pos1149) {if (M2.pair_p(l1148)!==false) {if (M2.eq_p(pos1149,1)!==false) {var if_res605 = M2.car(l1148);} else {var if_res605 = loop1147(M2.cdr(l1148),M2.sub1(pos1149));}var if_res606 = if_res605;} else {var if_res606 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("second"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01146);}return if_res606;};var if_res607 = loop1147(l01146,2);} else {var if_res607 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("second"),$rjs_core.UString.make("list?"),l01146);}return if_res607;};var third = function(l01150) {if (M2.list_p(l01150)!==false) {var loop1151 = function(l1152, pos1153) {if (M2.pair_p(l1152)!==false) {if (M2.eq_p(pos1153,1)!==false) {var if_res608 = M2.car(l1152);} else {var if_res608 = loop1151(M2.cdr(l1152),M2.sub1(pos1153));}var if_res609 = if_res608;} else {var if_res609 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("third"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01150);}return if_res609;};var if_res610 = loop1151(l01150,3);} else {var if_res610 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("third"),$rjs_core.UString.make("list?"),l01150);}return if_res610;};var fourth = function(l01154) {if (M2.list_p(l01154)!==false) {var loop1155 = function(l1156, pos1157) {if (M2.pair_p(l1156)!==false) {if (M2.eq_p(pos1157,1)!==false) {var if_res611 = M2.car(l1156);} else {var if_res611 = loop1155(M2.cdr(l1156),M2.sub1(pos1157));}var if_res612 = if_res611;} else {var if_res612 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("fourth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01154);}return if_res612;};var if_res613 = loop1155(l01154,4);} else {var if_res613 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("fourth"),$rjs_core.UString.make("list?"),l01154);}return if_res613;};var fifth = function(l01158) {if (M2.list_p(l01158)!==false) {var loop1159 = function(l1160, pos1161) {if (M2.pair_p(l1160)!==false) {if (M2.eq_p(pos1161,1)!==false) {var if_res614 = M2.car(l1160);} else {var if_res614 = loop1159(M2.cdr(l1160),M2.sub1(pos1161));}var if_res615 = if_res614;} else {var if_res615 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("fifth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01158);}return if_res615;};var if_res616 = loop1159(l01158,5);} else {var if_res616 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("fifth"),$rjs_core.UString.make("list?"),l01158);}return if_res616;};var sixth = function(l01162) {if (M2.list_p(l01162)!==false) {var loop1163 = function(l1164, pos1165) {if (M2.pair_p(l1164)!==false) {if (M2.eq_p(pos1165,1)!==false) {var if_res617 = M2.car(l1164);} else {var if_res617 = loop1163(M2.cdr(l1164),M2.sub1(pos1165));}var if_res618 = if_res617;} else {var if_res618 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("sixth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01162);}return if_res618;};var if_res619 = loop1163(l01162,6);} else {var if_res619 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("sixth"),$rjs_core.UString.make("list?"),l01162);}return if_res619;};var seventh = function(l01166) {if (M2.list_p(l01166)!==false) {var loop1167 = function(l1168, pos1169) {if (M2.pair_p(l1168)!==false) {if (M2.eq_p(pos1169,1)!==false) {var if_res620 = M2.car(l1168);} else {var if_res620 = loop1167(M2.cdr(l1168),M2.sub1(pos1169));}var if_res621 = if_res620;} else {var if_res621 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("seventh"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01166);}return if_res621;};var if_res622 = loop1167(l01166,7);} else {var if_res622 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("seventh"),$rjs_core.UString.make("list?"),l01166);}return if_res622;};var eighth = function(l01170) {if (M2.list_p(l01170)!==false) {var loop1171 = function(l1172, pos1173) {if (M2.pair_p(l1172)!==false) {if (M2.eq_p(pos1173,1)!==false) {var if_res623 = M2.car(l1172);} else {var if_res623 = loop1171(M2.cdr(l1172),M2.sub1(pos1173));}var if_res624 = if_res623;} else {var if_res624 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("eighth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01170);}return if_res624;};var if_res625 = loop1171(l01170,8);} else {var if_res625 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("eighth"),$rjs_core.UString.make("list?"),l01170);}return if_res625;};var ninth = function(l01174) {if (M2.list_p(l01174)!==false) {var loop1175 = function(l1176, pos1177) {if (M2.pair_p(l1176)!==false) {if (M2.eq_p(pos1177,1)!==false) {var if_res626 = M2.car(l1176);} else {var if_res626 = loop1175(M2.cdr(l1176),M2.sub1(pos1177));}var if_res627 = if_res626;} else {var if_res627 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("ninth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01174);}return if_res627;};var if_res628 = loop1175(l01174,9);} else {var if_res628 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("ninth"),$rjs_core.UString.make("list?"),l01174);}return if_res628;};var tenth = function(l01178) {if (M2.list_p(l01178)!==false) {var loop1179 = function(l1180, pos1181) {if (M2.pair_p(l1180)!==false) {if (M2.eq_p(pos1181,1)!==false) {var if_res629 = M2.car(l1180);} else {var if_res629 = loop1179(M2.cdr(l1180),M2.sub1(pos1181));}var if_res630 = if_res629;} else {var if_res630 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("tenth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01178);}return if_res630;};var if_res631 = loop1179(l01178,10);} else {var if_res631 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("tenth"),$rjs_core.UString.make("list?"),l01178);}return if_res631;};var last_pair = function(l1182) {if (M2.pair_p(l1182)!==false) {var loop1183 = function(l1184, x1185) {if (M2.pair_p(x1185)!==false) {var if_res632 = loop1183(x1185,M2.cdr(x1185));} else {var if_res632 = l1184;}return if_res632;};var if_res633 = loop1183(l1182,M2.cdr(l1182));} else {var if_res633 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("last-pair"),$rjs_core.UString.make("pair?"),l1182);}return if_res633;};var last = function(l1186) {if (M2.pair_p(l1186)!==false) {var if_res634 = M2.list_p(l1186);} else {var if_res634 = false;}if (if_res634!==false) {var loop1187 = function(l1188, x1189) {if (M2.pair_p(x1189)!==false) {var if_res635 = loop1187(x1189,M2.cdr(x1189));} else {var if_res635 = M2.car(l1188);}return if_res635;};var if_res636 = loop1187(l1186,M2.cdr(l1186));} else {var if_res636 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("last"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),l1186);}return if_res636;};var rest = function(l1190) {if (M2.pair_p(l1190)!==false) {var if_res637 = M2.list_p(l1190);} else {var if_res637 = false;}if (if_res637!==false) {var if_res638 = M2.cdr(l1190);} else {var if_res638 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("rest"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),l1190);}return if_res638;};var empty = $rjs_core.Pair.makeList();var make_list = function(n1191, x1192) {if (M2.exact_nonnegative_integer_p(n1191)!==false) {var if_res639 = M2.rvoid();} else {var if_res639 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("make-list"),$rjs_core.UString.make("exact-nonnegative-integer?"),0,n1191,x1192);}if_res639;var loop1193 = function(n1194, r1195) {if (M2.zero_p(n1194)!==false) {var if_res640 = r1195;} else {var if_res640 = loop1193(M2.sub1(n1194),M2.cons(x1192,r1195));}return if_res640;};return loop1193(n1191,$rjs_core.Pair.makeList());};var list_update = function(l1196, i1197, f1198) {if (M2.list_p(l1196)!==false) {var if_res641 = M2.rvoid();} else {var if_res641 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("list?"),0,l1196,i1197,f1198);}if_res641;if (M2.exact_nonnegative_integer_p(i1197)!==false) {var if_res642 = M2.rvoid();} else {var if_res642 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1196,i1197,f1198);}if_res642;if (M2.procedure_p(f1198)!==false) {var if_res643 = M2.procedure_arity_includes_p(f1198,1);} else {var if_res643 = false;}if (if_res643!==false) {var if_res644 = M2.rvoid();} else {var if_res644 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("(-> any/c any/c)"),2,l1196,i1197,f1198);}if_res644;if (M2.zero_p(i1197)!==false) {var if_res645 = M2.cons(f1198(M2.car(l1196)),M2.cdr(l1196));} else {var if_res645 = M2.cons(M2.car(l1196),list_update(M2.cdr(l1196),M2.sub1(i1197),f1198));}return if_res645;};var list_set = function(l1199, k1200, v1201) {if (M2.list_p(l1199)!==false) {var if_res646 = M2.rvoid();} else {var if_res646 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-set"),$rjs_core.UString.make("list?"),0,l1199,k1200,v1201);}if_res646;if (M2.exact_nonnegative_integer_p(k1200)!==false) {var if_res647 = M2.rvoid();} else {var if_res647 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-set"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1199,k1200,v1201);}if_res647;return list_update(l1199,k1200,function(_1202) {return v1201;});};var drop_times_ = function(list1203, n1204) {if (M2.zero_p(n1204)!==false) {var if_res649 = list1203;} else {if (M2.pair_p(list1203)!==false) {var if_res648 = drop_times_(M2.cdr(list1203),M2.sub1(n1204));} else {var if_res648 = false;}var if_res649 = if_res648;}return if_res649;};var too_large = function(who1205, list1206, n1207) {var proper_p1208 = M2.list_p(list1206);var temp652 = $rjs_core.UString.make("a ~alist with at least ~a ~a");if (proper_p1208!==false) {var if_res651 = $rjs_core.UString.make("");} else {var if_res651 = $rjs_core.UString.make("(possibly improper) ");}if (proper_p1208!==false) {var if_res650 = $rjs_core.UString.make("elements");} else {var if_res650 = $rjs_core.UString.make("pairs");}return M2.raise_argument_error(who1205,M2.format(temp652,if_res651,n1207,if_res650),list1206);};var take = function(list01209, n01210) {if (M2.exact_nonnegative_integer_p(n01210)!==false) {var if_res653 = M2.rvoid();} else {var if_res653 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("take"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list01209,n01210);}if_res653;var loop1211 = function(list1212, n1213) {if (M2.zero_p(n1213)!==false) {var if_res655 = $rjs_core.Pair.makeList();} else {if (M2.pair_p(list1212)!==false) {var if_res654 = M2.cons(M2.car(list1212),loop1211(M2.cdr(list1212),M2.sub1(n1213)));} else {var if_res654 = too_large($rjs_core.PrimitiveSymbol.make("take"),list01209,n01210);}var if_res655 = if_res654;}return if_res655;};return loop1211(list01209,n01210);};var drop = function(list1214, n1215) {if (M2.exact_nonnegative_integer_p(n1215)!==false) {var if_res656 = M2.rvoid();} else {var if_res656 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("drop"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1214,n1215);}if_res656;var or_part1216 = drop_times_(list1214,n1215);if (or_part1216!==false) {var if_res657 = or_part1216;} else {var if_res657 = too_large($rjs_core.PrimitiveSymbol.make("drop"),list1214,n1215);}return if_res657;};var split_at = function(list01217, n01218) {if (M2.exact_nonnegative_integer_p(n01218)!==false) {var if_res658 = M2.rvoid();} else {var if_res658 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("split-at"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list01217,n01218);}if_res658;var loop1219 = function(list1220, n1221, pfx1222) {if (M2.zero_p(n1221)!==false) {var if_res660 = M2.values(M8.alt_reverse(pfx1222),list1220);} else {if (M2.pair_p(list1220)!==false) {var if_res659 = loop1219(M2.cdr(list1220),M2.sub1(n1221),M2.cons(M2.car(list1220),pfx1222));} else {var if_res659 = too_large($rjs_core.PrimitiveSymbol.make("split-at"),list01217,n01218);}var if_res660 = if_res659;}return if_res660;};return loop1219(list01217,n01218,$rjs_core.Pair.makeList());};var takef = function(list1223, pred1224) {if (M2.procedure_p(pred1224)!==false) {var if_res661 = M2.rvoid();} else {var if_res661 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("takef"),$rjs_core.UString.make("procedure?"),1,list1223,pred1224);}if_res661;var loop1225 = function(list1226) {if (M2.pair_p(list1226)!==false) {var x1227 = M2.car(list1226);if (pred1224(x1227)!==false) {var if_res662 = M2.cons(x1227,loop1225(M2.cdr(list1226)));} else {var if_res662 = $rjs_core.Pair.makeList();}var if_res663 = if_res662;} else {var if_res663 = $rjs_core.Pair.makeList();}return if_res663;};return loop1225(list1223);};var dropf = function(list1228, pred1229) {if (M2.procedure_p(pred1229)!==false) {var if_res664 = M2.rvoid();} else {var if_res664 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("dropf"),$rjs_core.UString.make("procedure?"),1,list1228,pred1229);}if_res664;var loop1230 = function(list1231) {if (M2.pair_p(list1231)!==false) {var if_res665 = pred1229(M2.car(list1231));} else {var if_res665 = false;}if (if_res665!==false) {var if_res666 = loop1230(M2.cdr(list1231));} else {var if_res666 = list1231;}return if_res666;};return loop1230(list1228);};var splitf_at = function(list1232, pred1233) {if (M2.procedure_p(pred1233)!==false) {var if_res667 = M2.rvoid();} else {var if_res667 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("splitf-at"),$rjs_core.UString.make("procedure?"),1,list1232,pred1233);}if_res667;var loop1234 = function(list1235, pfx1236) {if (M2.pair_p(list1235)!==false) {var if_res668 = pred1233(M2.car(list1235));} else {var if_res668 = false;}if (if_res668!==false) {var if_res669 = loop1234(M2.cdr(list1235),M2.cons(M2.car(list1235),pfx1236));} else {var if_res669 = M2.values(M8.alt_reverse(pfx1236),list1235);}return if_res669;};return loop1234(list1232,$rjs_core.Pair.makeList());};var take_right = function(list1237, n1238) {if (M2.exact_nonnegative_integer_p(n1238)!==false) {var if_res670 = M2.rvoid();} else {var if_res670 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("take-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1237,n1238);}if_res670;var loop1239 = function(list1240, lead1241) {if (M2.pair_p(lead1241)!==false) {var if_res672 = loop1239(M2.cdr(list1240),M2.cdr(lead1241));} else {var if_res672 = list1240;}return if_res672;};var or_part1242 = drop_times_(list1237,n1238);if (or_part1242!==false) {var if_res671 = or_part1242;} else {var if_res671 = too_large($rjs_core.PrimitiveSymbol.make("take-right"),list1237,n1238);}return loop1239(list1237,if_res671);};var drop_right = function(list1243, n1244) {if (M2.exact_nonnegative_integer_p(n1244)!==false) {var if_res673 = M2.rvoid();} else {var if_res673 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("drop-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1243,n1244);}if_res673;var loop1245 = function(list1246, lead1247) {if (M2.pair_p(lead1247)!==false) {var if_res675 = M2.cons(M2.car(list1246),loop1245(M2.cdr(list1246),M2.cdr(lead1247)));} else {var if_res675 = $rjs_core.Pair.makeList();}return if_res675;};var or_part1248 = drop_times_(list1243,n1244);if (or_part1248!==false) {var if_res674 = or_part1248;} else {var if_res674 = too_large($rjs_core.PrimitiveSymbol.make("drop-right"),list1243,n1244);}return loop1245(list1243,if_res674);};var split_at_right = function(list1249, n1250) {if (M2.exact_nonnegative_integer_p(n1250)!==false) {var if_res676 = M2.rvoid();} else {var if_res676 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("split-at-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1249,n1250);}if_res676;var loop1251 = function(list1252, lead1253, pfx1254) {if (M2.pair_p(lead1253)!==false) {var if_res678 = loop1251(M2.cdr(list1252),M2.cdr(lead1253),M2.cons(M2.car(list1252),pfx1254));} else {var if_res678 = M2.values(M8.alt_reverse(pfx1254),list1252);}return if_res678;};var or_part1255 = drop_times_(list1249,n1250);if (or_part1255!==false) {var if_res677 = or_part1255;} else {var if_res677 = too_large($rjs_core.PrimitiveSymbol.make("split-at-right"),list1249,n1250);}return loop1251(list1249,if_res677,$rjs_core.Pair.makeList());};var count_from_right = function(who1256, list1257, pred1258) {if (M2.procedure_p(pred1258)!==false) {var if_res679 = M2.rvoid();} else {var if_res679 = M2.raise_argument_error(who1256,$rjs_core.UString.make("procedure?"),1,list1257,pred1258);}if_res679;var loop1259 = function(list1260, rev1261, n1262) {if (M2.pair_p(list1260)!==false) {var if_res682 = loop1259(M2.cdr(list1260),M2.cons(M2.car(list1260),rev1261),M2.add1(n1262));} else {var loop1263 = function(n1264, list1265) {if (M2.pair_p(list1265)!==false) {var if_res680 = pred1258(M2.car(list1265));} else {var if_res680 = false;}if (if_res680!==false) {var if_res681 = loop1263(M2.sub1(n1264),M2.cdr(list1265));} else {var if_res681 = n1264;}return if_res681;};var if_res682 = loop1263(n1262,rev1261);}return if_res682;};return loop1259(list1257,$rjs_core.Pair.makeList(),0);};var takef_right = function(list1266, pred1267) {return drop(list1266,count_from_right($rjs_core.PrimitiveSymbol.make("takef-right"),list1266,pred1267));};var dropf_right = function(list1268, pred1269) {return take(list1268,count_from_right($rjs_core.PrimitiveSymbol.make("dropf-right"),list1268,pred1269));};var splitf_at_right = function(list1270, pred1271) {return split_at(list1270,count_from_right($rjs_core.PrimitiveSymbol.make("splitf-at-right"),list1270,pred1271));};var list_prefix_p1272 = function(ls21273, rs31274, same_p11275) {var ls1276 = ls21273;var rs1277 = rs31274;if (M2.eq_p(same_p11275,M10.unsafe_undefined)!==false) {var if_res683 = M2.equal_p;} else {var if_res683 = same_p11275;}var same_p1278 = if_res683;if (M2.list_p(ls1276)!==false) {var if_res684 = M2.rvoid();} else {var if_res684 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("list?"),0,ls1276,rs1277);}if_res684;if (M2.list_p(rs1277)!==false) {var if_res685 = M2.rvoid();} else {var if_res685 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("list?"),1,ls1276,rs1277);}if_res685;if (M2.procedure_p(same_p1278)!==false) {var if_res686 = M2.procedure_arity_includes_p(same_p1278,2);} else {var if_res686 = false;}if (if_res686!==false) {var if_res687 = M2.rvoid();} else {var if_res687 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,ls1276,rs1277,same_p1278);}if_res687;var or_part1279 = M2.null_p(ls1276);if (or_part1279!==false) {var if_res690 = or_part1279;} else {if (M2.pair_p(rs1277)!==false) {if (same_p1278(M2.car(ls1276),M2.car(rs1277))!==false) {var if_res688 = list_prefix_p(M2.cdr(ls1276),M2.cdr(rs1277));} else {var if_res688 = false;}var if_res689 = if_res688;} else {var if_res689 = false;}var if_res690 = if_res689;}return if_res690;};var cl691 = function(ls1280, rs1281) {return list_prefix_p1272(ls1280,rs1281,M10.unsafe_undefined);};var cl692 = function(ls1282, rs1283, same_p11284) {return list_prefix_p1272(ls1282,rs1283,same_p11284);};var list_prefix_p = $rjs_core.attachProcedureArity(function() {var fixed_lam693 = {'2':cl691,'3':cl692}[arguments.length];if (fixed_lam693!==undefined) {return fixed_lam693.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var internal_split_common_prefix = function(as1285, bs1286, same_p1287, keep_prefix_p1288, name1289) {if (M2.list_p(as1285)!==false) {var if_res694 = M2.rvoid();} else {var if_res694 = M2.raise_argument_error(name1289,$rjs_core.UString.make("list?"),0,as1285,bs1286);}if_res694;if (M2.list_p(bs1286)!==false) {var if_res695 = M2.rvoid();} else {var if_res695 = M2.raise_argument_error(name1289,$rjs_core.UString.make("list?"),1,as1285,bs1286);}if_res695;if (M2.procedure_p(same_p1287)!==false) {var if_res696 = M2.procedure_arity_includes_p(same_p1287,2);} else {var if_res696 = false;}if (if_res696!==false) {var if_res697 = M2.rvoid();} else {var if_res697 = M2.raise_argument_error(name1289,$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,as1285,bs1286,same_p1287);}if_res697;var loop1290 = function(as1291, bs1292) {if (M2.pair_p(as1291)!==false) {if (M2.pair_p(bs1292)!==false) {var if_res698 = same_p1287(M2.car(as1291),M2.car(bs1292));} else {var if_res698 = false;}var if_res699 = if_res698;} else {var if_res699 = false;}if (if_res699!==false) {var let_result700 = loop1290(M2.cdr(as1291),M2.cdr(bs1292));var prefix1293 = let_result700.getAt(0);var atail1294 = let_result700.getAt(1);var btail1295 = let_result700.getAt(2);if (keep_prefix_p1288!==false) {var if_res701 = M2.cons(M2.car(as1291),prefix1293);} else {var if_res701 = false;}var if_res702 = M2.values(if_res701,atail1294,btail1295);} else {var if_res702 = M2.values(M2.rnull,as1291,bs1292);}return if_res702;};return loop1290(as1285,bs1286);};var split_common_prefix1296 = function(as51297, bs61298, same_p41299) {var as1300 = as51297;var bs1301 = bs61298;if (M2.eq_p(same_p41299,M10.unsafe_undefined)!==false) {var if_res703 = M2.equal_p;} else {var if_res703 = same_p41299;}var same_p1302 = if_res703;return internal_split_common_prefix(as1300,bs1301,same_p1302,true,$rjs_core.PrimitiveSymbol.make("split-common-prefix"));};var cl704 = function(as1303, bs1304) {return split_common_prefix1296(as1303,bs1304,M10.unsafe_undefined);};var cl705 = function(as1305, bs1306, same_p41307) {return split_common_prefix1296(as1305,bs1306,same_p41307);};var split_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam706 = {'2':cl704,'3':cl705}[arguments.length];if (fixed_lam706!==undefined) {return fixed_lam706.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var take_common_prefix1308 = function(as81309, bs91310, same_p71311) {var as1312 = as81309;var bs1313 = bs91310;if (M2.eq_p(same_p71311,M10.unsafe_undefined)!==false) {var if_res707 = M2.equal_p;} else {var if_res707 = same_p71311;}var same_p1314 = if_res707;var let_result708 = internal_split_common_prefix(as1312,bs1313,same_p1314,true,$rjs_core.PrimitiveSymbol.make("take-common-prefix"));var prefix1315 = let_result708.getAt(0);var atail1316 = let_result708.getAt(1);var btail1317 = let_result708.getAt(2);return prefix1315;};var cl709 = function(as1318, bs1319) {return take_common_prefix1308(as1318,bs1319,M10.unsafe_undefined);};var cl710 = function(as1320, bs1321, same_p71322) {return take_common_prefix1308(as1320,bs1321,same_p71322);};var take_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam711 = {'2':cl709,'3':cl710}[arguments.length];if (fixed_lam711!==undefined) {return fixed_lam711.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var drop_common_prefix1323 = function(as111324, bs121325, same_p101326) {var as1327 = as111324;var bs1328 = bs121325;if (M2.eq_p(same_p101326,M10.unsafe_undefined)!==false) {var if_res712 = M2.equal_p;} else {var if_res712 = same_p101326;}var same_p1329 = if_res712;var let_result713 = internal_split_common_prefix(as1327,bs1328,same_p1329,false,$rjs_core.PrimitiveSymbol.make("drop-common-prefix"));var prefix1330 = let_result713.getAt(0);var atail1331 = let_result713.getAt(1);var btail1332 = let_result713.getAt(2);return M2.values(atail1331,btail1332);};var cl714 = function(as1333, bs1334) {return drop_common_prefix1323(as1333,bs1334,M10.unsafe_undefined);};var cl715 = function(as1335, bs1336, same_p101337) {return drop_common_prefix1323(as1335,bs1336,same_p101337);};var drop_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam716 = {'2':cl714,'3':cl715}[arguments.length];if (fixed_lam716!==undefined) {return fixed_lam716.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var cl717 = function(ls1338) {return M2.apply(M2.append,ls1338);};var cl718 = function(l11339, l21340) {return M2.apply(M2.append,l11339,l21340);};var cl719 = function(l11341, l21342, l31343) {return M2.apply(M2.append,l11341,l21342,l31343);};var cl720 = function(l11344, l21345, l31346, l41347) {return M2.apply(M2.append,l11344,l21345,l31346,l41347);};var cl721 = $rjs_core.attachProcedureArity(function(l1348, ...lss1349724) {var lss1349 = $rjs_core.Pair.listFromArray(lss1349724);return M2.apply(M5.new_apply_proc,M2.append,l1348,lss1349);});var append_times_ = $rjs_core.attachProcedureArity(function() {var fixed_lam722 = {'1':cl717,'2':cl718,'3':cl719,'4':cl720}[arguments.length];if (fixed_lam722!==undefined) {return fixed_lam722.apply(null,arguments);} else {if (M2.__gt__eq_(cl721.length,1)!==false) {var if_res723 = cl721.apply(null,arguments);} else {var if_res723 = M2.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res723;}},[M2.make_arity_at_least(1)]);var flatten = function(orig_sexp1350) {var loop1351 = function(sexp1352, acc1353) {if (M2.null_p(sexp1352)!==false) {var if_res726 = acc1353;} else {if (M2.pair_p(sexp1352)!==false) {var if_res725 = loop1351(M2.car(sexp1352),loop1351(M2.cdr(sexp1352),acc1353));} else {var if_res725 = M2.cons(sexp1352,acc1353);}var if_res726 = if_res725;}return if_res726;};return loop1351(orig_sexp1350,M2.rnull);};var add_between = function(after_last161354, before_first141355, before_last151356, splice_p131357, l211358, x221359) {var l1360 = l211358;var x1361 = x221359;if (false!==false) {var if_res727 = false;} else {var if_res727 = splice_p131357;}var splice_p1362 = if_res727;if (false!==false) {var if_res728 = $rjs_core.Pair.makeList();} else {var if_res728 = before_first141355;}var before_first1363 = if_res728;if (M2.eq_p(before_last151356,M10.unsafe_undefined)!==false) {var if_res729 = x1361;} else {var if_res729 = before_last151356;}var before_last1364 = if_res729;if (false!==false) {var if_res730 = $rjs_core.Pair.makeList();} else {var if_res730 = after_last161354;}var after_last1365 = if_res730;if (M2.list_p(l1360)!==false) {var if_res731 = M2.rvoid();} else {var if_res731 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("add-between"),$rjs_core.UString.make("list?"),0,l1360,x1361);}if_res731;if (splice_p1362!==false) {var check_list1366 = function(x1367, which1368) {if (M2.list_p(x1367)!==false) {var if_res732 = M2.rvoid();} else {var if_res732 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("add-between"),M2.string_append($rjs_core.UString.make("list needed in splicing mode"),which1368),$rjs_core.UString.make("given"),x1367,$rjs_core.UString.make("given list..."),l1360);}return if_res732;};check_list1366(x1361,$rjs_core.UString.make(""));check_list1366(before_first1363,$rjs_core.UString.make(" for #:before-first"));check_list1366(before_last1364,$rjs_core.UString.make(" for #:before-last"));var if_res734 = check_list1366(after_last1365,$rjs_core.UString.make(" for #:after-last"));} else {var check_not_given1369 = function(x1370, which1371) {if (M2.eq_p($rjs_core.Pair.makeList(),x1370)!==false) {var if_res733 = M2.rvoid();} else {var if_res733 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("add-between"),M2.string_append(which1371,$rjs_core.UString.make(" can only be used in splicing mode")),$rjs_core.UString.make("given"),x1370,$rjs_core.UString.make("given list..."),l1360);}return if_res733;};check_not_given1369(before_first1363,$rjs_core.UString.make("#:before-first"));var if_res734 = check_not_given1369(after_last1365,$rjs_core.UString.make("#:after-last"));}if_res734;var or_part1372 = M2.null_p(l1360);if (or_part1372!==false) {var if_res735 = or_part1372;} else {var if_res735 = M2.null_p(M2.cdr(l1360));}if (if_res735!==false) {if (splice_p1362!==false) {var if_res736 = M2.append(before_first1363,l1360,after_last1365);} else {var if_res736 = l1360;}var if_res741 = if_res736;} else {if (splice_p1362!==false) {var x1373 = M8.alt_reverse(x1361);var loop1375 = function(i1376, l1377, r1378) {if (M2.pair_p(l1377)!==false) {var if_res737 = loop1375(M2.car(l1377),M2.cdr(l1377),M2.cons(i1376,M2.append(x1373,r1378)));} else {var if_res737 = M2.cons(i1376,M2.append(M8.alt_reverse(before_last1364),r1378));}return if_res737;};var r1374 = loop1375(M2.cadr(l1360),M2.cddr(l1360),$rjs_core.Pair.makeList());var r1379 = M8.alt_reverse(M2.append(M8.alt_reverse(after_last1365),r1374));var r1380 = M7.__rjs_quoted__.qq_append(before_first1363,M2.list_times_(M2.car(l1360),r1379));var if_res740 = r1380;} else {var temp739 = M2.car(l1360);var loop1381 = function(i1382, l1383, r1384) {if (M2.pair_p(l1383)!==false) {var if_res738 = loop1381(M2.car(l1383),M2.cdr(l1383),M2.cons(i1382,M2.cons(x1361,r1384)));} else {var if_res738 = M2.cons(i1382,M2.cons(before_last1364,r1384));}return if_res738;};var if_res740 = M2.cons(temp739,M8.alt_reverse(loop1381(M2.cadr(l1360),M2.cddr(l1360),$rjs_core.Pair.makeList())));}var if_res741 = if_res740;}return if_res741;};var add_between1142 = function(given_kws1385, given_args1386, l211387, x221388) {if (M2.pair_p(given_kws1385)!==false) {var if_res742 = M2.eq_p($rjs_core.Keyword.make("after-last"),M2.car(given_kws1385));} else {var if_res742 = false;}var after_last201389 = if_res742;if (after_last201389!==false) {var if_res743 = M2.car(given_args1386);} else {var if_res743 = $rjs_core.Pair.makeList();}var after_last161390 = if_res743;if (after_last201389!==false) {var if_res744 = M2.cdr(given_kws1385);} else {var if_res744 = given_kws1385;}var kws796511391 = if_res744;if (after_last201389!==false) {var if_res745 = M2.cdr(given_args1386);} else {var if_res745 = given_args1386;}var kw_args796521392 = if_res745;if (M2.pair_p(kws796511391)!==false) {var if_res746 = M2.eq_p($rjs_core.Keyword.make("before-first"),M2.car(kws796511391));} else {var if_res746 = false;}var before_first181393 = if_res746;if (before_first181393!==false) {var if_res747 = M2.car(kw_args796521392);} else {var if_res747 = $rjs_core.Pair.makeList();}var before_first141394 = if_res747;if (before_first181393!==false) {var if_res748 = M2.cdr(kws796511391);} else {var if_res748 = kws796511391;}var kws796531395 = if_res748;if (before_first181393!==false) {var if_res749 = M2.cdr(kw_args796521392);} else {var if_res749 = kw_args796521392;}var kw_args796541396 = if_res749;if (M2.pair_p(kws796531395)!==false) {var if_res750 = M2.eq_p($rjs_core.Keyword.make("before-last"),M2.car(kws796531395));} else {var if_res750 = false;}var before_last191397 = if_res750;if (before_last191397!==false) {var if_res751 = M2.car(kw_args796541396);} else {var if_res751 = M10.unsafe_undefined;}var before_last151398 = if_res751;if (before_last191397!==false) {var if_res752 = M2.cdr(kws796531395);} else {var if_res752 = kws796531395;}var kws796551399 = if_res752;if (before_last191397!==false) {var if_res753 = M2.cdr(kw_args796541396);} else {var if_res753 = kw_args796541396;}var kw_args796561400 = if_res753;var splice_p171401 = M2.pair_p(kws796551399);if (splice_p171401!==false) {var if_res754 = M2.car(kw_args796561400);} else {var if_res754 = false;}var splice_p131402 = if_res754;return add_between(after_last161390,before_first141394,before_last151398,splice_p131402,l211387,x221388);};var cl758 = function(given_kws1413, given_args1414, l1415, x1416) {return add_between1142(given_kws1413,given_args1414,l1415,x1416);};var temp760 = $rjs_core.attachProcedureArity(function() {var fixed_lam759 = {'4':cl758}[arguments.length];if (fixed_lam759!==undefined) {return fixed_lam759.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4]);var temp757 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("after-last"),$rjs_core.Keyword.make("before-first"),$rjs_core.Keyword.make("before-last"),$rjs_core.Keyword.make("splice?"));var cl755 = function(l1417, x1418) {return add_between1142(M2.rnull,M2.rnull,l1417,x1418);};var add_between23 = M1.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1403, given_argc1404) {if (M2.__eq_(given_argc1404,4)!==false) {var l1796571405 = given_kws1403;if (M2.null_p(l1796571405)!==false) {var if_res762 = l1796571405;} else {if (M2.eq_p(M2.car(l1796571405),$rjs_core.Keyword.make("after-last"))!==false) {var if_res761 = M2.cdr(l1796571405);} else {var if_res761 = l1796571405;}var if_res762 = if_res761;}var l1796571406 = if_res762;var l1796581407 = l1796571406;if (M2.null_p(l1796581407)!==false) {var if_res764 = l1796581407;} else {if (M2.eq_p(M2.car(l1796581407),$rjs_core.Keyword.make("before-first"))!==false) {var if_res763 = M2.cdr(l1796581407);} else {var if_res763 = l1796581407;}var if_res764 = if_res763;}var l1796581408 = if_res764;var l1796591409 = l1796581408;if (M2.null_p(l1796591409)!==false) {var if_res766 = l1796591409;} else {if (M2.eq_p(M2.car(l1796591409),$rjs_core.Keyword.make("before-last"))!==false) {var if_res765 = M2.cdr(l1796591409);} else {var if_res765 = l1796591409;}var if_res766 = if_res765;}var l1796591410 = if_res766;var l1796601411 = l1796591410;if (M2.null_p(l1796601411)!==false) {var if_res768 = l1796601411;} else {if (M2.eq_p(M2.car(l1796601411),$rjs_core.Keyword.make("splice?"))!==false) {var if_res767 = M2.cdr(l1796601411);} else {var if_res767 = l1796601411;}var if_res768 = if_res767;}var l1796601412 = if_res768;var if_res769 = M2.null_p(l1796601412);} else {var if_res769 = false;}return if_res769;},temp760,M2.rnull,temp757,$rjs_core.attachProcedureArity(function() {var fixed_lam756 = {'2':cl755}[arguments.length];if (fixed_lam756!==undefined) {return fixed_lam756.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2]));var remove_duplicates = function(key241419, l271420, __eq__p261421) {var l1422 = l271420;if (M2.eq_p(__eq__p261421,M10.unsafe_undefined)!==false) {var if_res770 = M2.equal_p;} else {var if_res770 = __eq__p261421;}var __eq__p1423 = if_res770;if (false!==false) {var if_res771 = false;} else {var if_res771 = key241419;}var key1424 = if_res771;if (M2.list_p(l1422)!==false) {var if_res772 = M2.rvoid();} else {var if_res772 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("remove-duplicates"),$rjs_core.UString.make("list?"),l1422);}if_res772;var len1425 = M2.length(l1422);if (M2.__lt__eq_(len1425,1)!==false) {var if_res776 = true;} else {if (M2.__lt__eq_(len1425,40)!==false) {var if_res775 = false;} else {if (M2.eq_p(__eq__p1423,M2.eq_p)!==false) {var if_res774 = M2.make_hasheq();} else {if (M2.eq_p(__eq__p1423,M2.equal_p)!==false) {var if_res773 = M2.make_hash();} else {var if_res773 = false;}var if_res774 = if_res773;}var if_res775 = if_res774;}var if_res776 = if_res775;}var h1426 = if_res776;var tmp1427 = h1426;if (M2.equal_p(tmp1427,true)!==false) {var if_res795 = l1422;} else {if (M2.equal_p(tmp1427,false)!==false) {var or_part1429 = key1424;if (or_part1429!==false) {var if_res777 = or_part1429;} else {var if_res777 = function(x1430) {return x1430;};}var key1428 = if_res777;if (M2.eq_p(__eq__p1423,M2.equal_p)!==false) {var loop1431 = function(l1432, seen1433) {if (M2.null_p(l1432)!==false) {var if_res779 = l1432;} else {var x1434 = M2.car(l1432);var k1435 = key1428(x1434);var l1436 = M2.cdr(l1432);if (M3.member(k1435,seen1433)!==false) {var if_res778 = loop1431(l1436,seen1433);} else {var if_res778 = M2.cons(x1434,loop1431(l1436,M2.cons(k1435,seen1433)));}var if_res779 = if_res778;}return if_res779;};var if_res788 = loop1431(l1422,M2.rnull);} else {if (M2.eq_p(__eq__p1423,M2.eq_p)!==false) {var loop1437 = function(l1438, seen1439) {if (M2.null_p(l1438)!==false) {var if_res781 = l1438;} else {var x1440 = M2.car(l1438);var k1441 = key1428(x1440);var l1442 = M2.cdr(l1438);if (M2.memq(k1441,seen1439)!==false) {var if_res780 = loop1437(l1442,seen1439);} else {var if_res780 = M2.cons(x1440,loop1437(l1442,M2.cons(k1441,seen1439)));}var if_res781 = if_res780;}return if_res781;};var if_res787 = loop1437(l1422,M2.rnull);} else {if (M2.eq_p(__eq__p1423,M2.eqv_p)!==false) {var loop1443 = function(l1444, seen1445) {if (M2.null_p(l1444)!==false) {var if_res783 = l1444;} else {var x1446 = M2.car(l1444);var k1447 = key1428(x1446);var l1448 = M2.cdr(l1444);if (M2.memv(k1447,seen1445)!==false) {var if_res782 = loop1443(l1448,seen1445);} else {var if_res782 = M2.cons(x1446,loop1443(l1448,M2.cons(k1447,seen1445)));}var if_res783 = if_res782;}return if_res783;};var if_res786 = loop1443(l1422,M2.rnull);} else {var loop1449 = function(l1450, seen1451) {if (M2.null_p(l1450)!==false) {var if_res785 = l1450;} else {var x1452 = M2.car(l1450);var k1453 = key1428(x1452);var l1454 = M2.cdr(l1450);if ((function(x1455, seen1456) {return M4.ormap(function(y1457) {return __eq__p1423(x1455,y1457);},seen1456);})(k1453,seen1451)!==false) {var if_res784 = loop1449(l1454,seen1451);} else {var if_res784 = M2.cons(x1452,loop1449(l1454,M2.cons(k1453,seen1451)));}var if_res785 = if_res784;}return if_res785;};var if_res786 = loop1449(l1422,M2.rnull);}var if_res787 = if_res786;}var if_res788 = if_res787;}var if_res794 = if_res788;} else {if (key1424!==false) {var loop1458 = function(l1459) {if (M2.null_p(l1459)!==false) {var if_res790 = l1459;} else {var x1460 = M2.car(l1459);var k1461 = key1424(x1460);var l1462 = M2.cdr(l1459);if (M2.hash_ref(h1426,k1461,false)!==false) {var if_res789 = loop1458(l1462);} else {M2.hash_set_bang_(h1426,k1461,true);var if_res789 = M2.cons(x1460,loop1458(l1462));}var if_res790 = if_res789;}return if_res790;};var if_res793 = loop1458(l1422);} else {var loop1463 = function(l1464) {if (M2.null_p(l1464)!==false) {var if_res792 = l1464;} else {var x1465 = M2.car(l1464);var k1466 = x1465;var l1467 = M2.cdr(l1464);if (M2.hash_ref(h1426,k1466,false)!==false) {var if_res791 = loop1463(l1467);} else {M2.hash_set_bang_(h1426,k1466,true);var if_res791 = M2.cons(x1465,loop1463(l1467));}var if_res792 = if_res791;}return if_res792;};var if_res793 = loop1463(l1422);}var if_res794 = if_res793;}var if_res795 = if_res794;}return if_res795;};var remove_duplicates1143 = function(given_kws1468, given_args1469, l271470, __eq__p261471) {var key251472 = M2.pair_p(given_kws1468);if (key251472!==false) {var if_res796 = M2.car(given_args1469);} else {var if_res796 = false;}var key241473 = if_res796;return remove_duplicates(key241473,l271470,__eq__p261471);};var cl801 = function(given_kws1478, given_args1479, l1480) {return remove_duplicates1143(given_kws1478,given_args1479,l1480,M10.unsafe_undefined);};var cl802 = function(given_kws1481, given_args1482, l1483, __eq__p261484) {return remove_duplicates1143(given_kws1481,given_args1482,l1483,__eq__p261484);};var temp804 = $rjs_core.attachProcedureArity(function() {var fixed_lam803 = {'3':cl801,'4':cl802}[arguments.length];if (fixed_lam803!==undefined) {return fixed_lam803.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var temp800 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("key"));var cl797 = function(l1485) {return remove_duplicates1143(M2.rnull,M2.rnull,l1485,M10.unsafe_undefined);};var cl798 = function(l1486, __eq__p261487) {return remove_duplicates1143(M2.rnull,M2.rnull,l1486,__eq__p261487);};var remove_duplicates28 = M1.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1474, given_argc1475) {if (M2.__gt__eq_(given_argc1475,3)!==false) {var if_res805 = M2.__lt__eq_(given_argc1475,4);} else {var if_res805 = false;}if (if_res805!==false) {var l1796691476 = given_kws1474;if (M2.null_p(l1796691476)!==false) {var if_res807 = l1796691476;} else {if (M2.eq_p(M2.car(l1796691476),$rjs_core.Keyword.make("key"))!==false) {var if_res806 = M2.cdr(l1796691476);} else {var if_res806 = l1796691476;}var if_res807 = if_res806;}var l1796691477 = if_res807;var if_res808 = M2.null_p(l1796691477);} else {var if_res808 = false;}return if_res808;},temp804,M2.rnull,temp800,$rjs_core.attachProcedureArity(function() {var fixed_lam799 = {'1':cl797,'2':cl798}[arguments.length];if (fixed_lam799!==undefined) {return fixed_lam799.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]));var check_duplicates = function(default301488, key291489, items341490, same_p331491) {var items1492 = items341490;if (M2.eq_p(same_p331491,M10.unsafe_undefined)!==false) {var if_res809 = M2.equal_p;} else {var if_res809 = same_p331491;}var same_p1493 = if_res809;if (M2.eq_p(key291489,M10.unsafe_undefined)!==false) {var if_res810 = M2.values;} else {var if_res810 = key291489;}var key1494 = if_res810;if (M2.eq_p(default301488,M10.unsafe_undefined)!==false) {var if_res811 = function() {return false;};} else {var if_res811 = default301488;}var failure_result1495 = if_res811;if (M2.list_p(items1492)!==false) {var if_res812 = M2.rvoid();} else {var if_res812 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("list?"),0,items1492);}if_res812;if (M2.procedure_p(key1494)!==false) {var if_res813 = M2.procedure_arity_includes_p(key1494,1);} else {var if_res813 = false;}if (if_res813!==false) {var if_res814 = M2.rvoid();} else {var if_res814 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("(-> any/c any/c)"),key1494);}if_res814;if (M2.procedure_p(failure_result1495)!==false) {var if_res815 = failure_result1495;} else {var if_res815 = function() {return failure_result1495;};}var fail_k1496 = if_res815;if (M2.eq_p(same_p1493,M2.equal_p)!==false) {var if_res820 = check_duplicates_by_t(items1492,key1494,M2.make_hash(),fail_k1496);} else {if (M2.eq_p(same_p1493,M2.eq_p)!==false) {var if_res819 = check_duplicates_by_t(items1492,key1494,M2.make_hasheq(),fail_k1496);} else {if (M2.eq_p(same_p1493,M2.eqv_p)!==false) {var if_res818 = check_duplicates_by_t(items1492,key1494,M2.make_hasheqv(),fail_k1496);} else {if (M2.procedure_p(same_p1493)!==false) {var if_res816 = M2.procedure_arity_includes_p(same_p1493,2);} else {var if_res816 = false;}if (if_res816!==false) {var if_res817 = M2.rvoid();} else {var if_res817 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),1,items1492,same_p1493);}if_res817;var if_res818 = check_duplicates_by_list(items1492,key1494,same_p1493,fail_k1496);}var if_res819 = if_res818;}var if_res820 = if_res819;}return if_res820;};var check_duplicates1144 = function(given_kws1497, given_args1498, items341499, same_p331500) {if (M2.pair_p(given_kws1497)!==false) {var if_res821 = M2.eq_p($rjs_core.Keyword.make("default"),M2.car(given_kws1497));} else {var if_res821 = false;}var default321501 = if_res821;if (default321501!==false) {var if_res822 = M2.car(given_args1498);} else {var if_res822 = M10.unsafe_undefined;}var default301502 = if_res822;if (default321501!==false) {var if_res823 = M2.cdr(given_kws1497);} else {var if_res823 = given_kws1497;}var kws796701503 = if_res823;if (default321501!==false) {var if_res824 = M2.cdr(given_args1498);} else {var if_res824 = given_args1498;}var kw_args796711504 = if_res824;var key311505 = M2.pair_p(kws796701503);if (key311505!==false) {var if_res825 = M2.car(kw_args796711504);} else {var if_res825 = M10.unsafe_undefined;}var key291506 = if_res825;return check_duplicates(default301502,key291506,items341499,same_p331500);};var cl830 = function(given_kws1513, given_args1514, items1515) {return check_duplicates1144(given_kws1513,given_args1514,items1515,M10.unsafe_undefined);};var cl831 = function(given_kws1516, given_args1517, items1518, same_p331519) {return check_duplicates1144(given_kws1516,given_args1517,items1518,same_p331519);};var temp833 = $rjs_core.attachProcedureArity(function() {var fixed_lam832 = {'3':cl830,'4':cl831}[arguments.length];if (fixed_lam832!==undefined) {return fixed_lam832.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var temp829 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("default"),$rjs_core.Keyword.make("key"));var cl826 = function(items1520) {return check_duplicates1144(M2.rnull,M2.rnull,items1520,M10.unsafe_undefined);};var cl827 = function(items1521, same_p331522) {return check_duplicates1144(M2.rnull,M2.rnull,items1521,same_p331522);};var check_duplicates35 = M1.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1507, given_argc1508) {if (M2.__gt__eq_(given_argc1508,3)!==false) {var if_res834 = M2.__lt__eq_(given_argc1508,4);} else {var if_res834 = false;}if (if_res834!==false) {var l1796721509 = given_kws1507;if (M2.null_p(l1796721509)!==false) {var if_res836 = l1796721509;} else {if (M2.eq_p(M2.car(l1796721509),$rjs_core.Keyword.make("default"))!==false) {var if_res835 = M2.cdr(l1796721509);} else {var if_res835 = l1796721509;}var if_res836 = if_res835;}var l1796721510 = if_res836;var l1796731511 = l1796721510;if (M2.null_p(l1796731511)!==false) {var if_res838 = l1796731511;} else {if (M2.eq_p(M2.car(l1796731511),$rjs_core.Keyword.make("key"))!==false) {var if_res837 = M2.cdr(l1796731511);} else {var if_res837 = l1796731511;}var if_res838 = if_res837;}var l1796731512 = if_res838;var if_res839 = M2.null_p(l1796731512);} else {var if_res839 = false;}return if_res839;},temp833,M2.rnull,temp829,$rjs_core.attachProcedureArity(function() {var fixed_lam828 = {'1':cl826,'2':cl827}[arguments.length];if (fixed_lam828!==undefined) {return fixed_lam828.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]));var check_duplicates_by_t = function(items1523, key1524, table1525, fail_k1526) {var loop1527 = function(items1528) {if (M2.pair_p(items1528)!==false) {var key_item1529 = key1524(M2.car(items1528));if (M2.hash_ref(table1525,key_item1529,false)!==false) {var if_res840 = M2.car(items1528);} else {M2.hash_set_bang_(table1525,key_item1529,true);var if_res840 = loop1527(M2.cdr(items1528));}var if_res841 = if_res840;} else {var if_res841 = fail_k1526();}return if_res841;};return loop1527(items1523);};var check_duplicates_by_list = function(items1530, key1531, same_p1532, fail_k1533) {var loop1534 = function(items1535, sofar1536) {if (M2.pair_p(items1535)!==false) {var key_item1537 = key1531(M2.car(items1535));var lst1538 = sofar1536;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res842 = M2.rvoid();} else {var if_res842 = M0.__rjs_quoted__.check_list(lst1538);}if_res842;var for_loop1539 = function(result1540, lst1541) {if (M2.pair_p(lst1541)!==false) {var prev1542 = M10.unsafe_car(lst1541);var rest1543 = M10.unsafe_cdr(lst1541);if (true!==false) {var result1545 = result1540;var result1546 = same_p1532(key_item1537,prev1542);var result1544 = M2.values(result1546);if (true!==false) {var if_res844 = M2.not($rjs_core.attachProcedureArity(function(...x1547843) {var x1547 = $rjs_core.Pair.listFromArray(x1547843);return result1544;})(prev1542));} else {var if_res844 = false;}if (if_res844!==false) {var if_res845 = M2.not(false);} else {var if_res845 = false;}if (if_res845!==false) {var if_res846 = for_loop1539(result1544,rest1543);} else {var if_res846 = result1544;}var if_res847 = if_res846;} else {var if_res847 = result1540;}var if_res848 = if_res847;} else {var if_res848 = result1540;}return if_res848;};if (for_loop1539(false,lst1538)!==false) {var if_res849 = M2.car(items1535);} else {var if_res849 = loop1534(M2.cdr(items1535),M2.cons(key_item1537,sofar1536));}var if_res850 = if_res849;} else {var if_res850 = fail_k1533();}return if_res850;};return loop1534(items1530,M2.rnull);};var check_filter_arguments = function(who1548, f1549, l1550, ls1551) {if (M2.procedure_p(f1549)!==false) {var if_res851 = M2.rvoid();} else {var if_res851 = M2.apply(M2.raise_argument_error,who1548,$rjs_core.UString.make("procedure?"),0,f1549,l1550,ls1551);}if_res851;if (M2.procedure_arity_includes_p(f1549,M2.add1(M2.length(ls1551)))!==false) {var if_res852 = M2.rvoid();} else {var if_res852 = M2.raise_arguments_error(who1548,$rjs_core.UString.make("mismatch between procedure arity and argument count"),$rjs_core.UString.make("procedure"),f1549,$rjs_core.UString.make("expected arity"),M2.add1(M2.length(ls1551)));}if_res852;if (M2.list_p(l1550)!==false) {var if_res853 = M4.andmap(M2.list_p,ls1551);} else {var if_res853 = false;}if (if_res853!==false) {var if_res873 = M2.rvoid();} else {var let_result854 = M0.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),M2.cons(l1550,ls1551));var pos__gt_vals1552 = let_result854.getAt(0);var pos_pre_inc1553 = let_result854.getAt(1);var pos_next1554 = let_result854.getAt(2);var init1555 = let_result854.getAt(3);var pos_cont_p1556 = let_result854.getAt(4);var val_cont_p1557 = let_result854.getAt(5);var all_cont_p1558 = let_result854.getAt(6);var start1559 = 0;if (M2.rvoid()!==false) {if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res855 = M2.rvoid();} else {var if_res855 = M0.__rjs_quoted__.check_naturals(start1559);}var if_res856 = if_res855;} else {var if_res856 = false;}if_res856;var for_loop1560 = function(pos1561, pos1562) {if (pos_cont_p1556!==false) {var if_res857 = pos_cont_p1556(pos1561);} else {var if_res857 = true;}if (if_res857!==false) {var if_res858 = true;} else {var if_res858 = false;}if (if_res858!==false) {var x1567 = pos__gt_vals1552(pos1561);if (all_cont_p1558!==false) {var if_res859 = function(pos1568) {return all_cont_p1558(pos1568,x1567);};} else {var if_res859 = false;}var let_result860 = M2.values(x1567,if_res859);var x1563 = let_result860.getAt(0);var all_cont_p_by_pos1564 = let_result860.getAt(1);if (pos_pre_inc1553!==false) {var if_res861 = pos_pre_inc1553(pos1561);} else {var if_res861 = pos1561;}var pos1565 = if_res861;var i1566 = pos1562;if (val_cont_p1557!==false) {var if_res862 = val_cont_p1557(x1563);} else {var if_res862 = true;}if (if_res862!==false) {var if_res863 = true;} else {var if_res863 = false;}if (if_res863!==false) {if (M2.list_p(x1563)!==false) {var if_res864 = M2.rvoid();} else {var if_res864 = M2.apply(M2.raise_argument_error,who1548,$rjs_core.UString.make("list?"),M2.add1(i1566),f1549,l1550,ls1551);}if_res864;var let_result865 = M2.values();var let_result866 = M2.values();if (all_cont_p_by_pos1564!==false) {var if_res867 = all_cont_p_by_pos1564(pos1565);} else {var if_res867 = true;}if (if_res867!==false) {var if_res868 = true;} else {var if_res868 = false;}if (if_res868!==false) {var if_res869 = M2.not(false);} else {var if_res869 = false;}if (if_res869!==false) {var if_res870 = for_loop1560(pos_next1554(pos1565),pos1562+1);} else {var if_res870 = M2.values();}var if_res871 = if_res870;} else {var if_res871 = M2.values();}var if_res872 = if_res871;} else {var if_res872 = M2.values();}return if_res872;};for_loop1560(init1555,start1559);var if_res873 = M2.rvoid();}return if_res873;};var filter_map = $rjs_core.attachProcedureArity(function(f1569, l1570, ...ls1571874) {var ls1571 = $rjs_core.Pair.listFromArray(ls1571874);check_filter_arguments($rjs_core.PrimitiveSymbol.make("filter-map"),f1569,l1570,ls1571);if (M2.pair_p(ls1571)!==false) {var len1572 = M2.length(l1570);if (M4.andmap(function(l1573) {return M2.__eq_(len1572,M2.length(l1573));},ls1571)!==false) {var loop1574 = function(l1575, ls1576) {if (M2.null_p(l1575)!==false) {var if_res876 = M2.rnull;} else {var x1577 = M2.apply(f1569,M2.car(l1575),M4.map(M2.car,ls1576));if (x1577!==false) {var if_res875 = M2.cons(x1577,loop1574(M2.cdr(l1575),M4.map(M2.cdr,ls1576)));} else {var if_res875 = loop1574(M2.cdr(l1575),M4.map(M2.cdr,ls1576));}var if_res876 = if_res875;}return if_res876;};var if_res877 = loop1574(l1570,ls1571);} else {var if_res877 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("filter-map"),$rjs_core.UString.make("all lists must have same size"));}var if_res880 = if_res877;} else {var loop1578 = function(l1579) {if (M2.null_p(l1579)!==false) {var if_res879 = M2.rnull;} else {var x1580 = f1569(M2.car(l1579));if (x1580!==false) {var if_res878 = M2.cons(x1580,loop1578(M2.cdr(l1579)));} else {var if_res878 = loop1578(M2.cdr(l1579));}var if_res879 = if_res878;}return if_res879;};var if_res880 = loop1578(l1570);}return if_res880;});var count = $rjs_core.attachProcedureArity(function(f1581, l1582, ...ls1583881) {var ls1583 = $rjs_core.Pair.listFromArray(ls1583881);check_filter_arguments($rjs_core.PrimitiveSymbol.make("count"),f1581,l1582,ls1583);if (M2.pair_p(ls1583)!==false) {var len1584 = M2.length(l1582);if (M4.andmap(function(l1585) {return M2.__eq_(len1584,M2.length(l1585));},ls1583)!==false) {var loop1586 = function(l1587, ls1588, c1589) {if (M2.null_p(l1587)!==false) {var if_res885 = c1589;} else {var temp884 = M2.cdr(l1587);var temp883 = M4.map(M2.cdr,ls1588);if (M2.apply(f1581,M2.car(l1587),M4.map(M2.car,ls1588))!==false) {var if_res882 = M2.add1(c1589);} else {var if_res882 = c1589;}var if_res885 = loop1586(temp884,temp883,if_res882);}return if_res885;};var if_res886 = loop1586(l1582,ls1583,0);} else {var if_res886 = M2.raise_arguments_error($rjs_core.PrimitiveSymbol.make("count"),$rjs_core.UString.make("all lists must have same size"));}var if_res890 = if_res886;} else {var loop1590 = function(l1591, c1592) {if (M2.null_p(l1591)!==false) {var if_res889 = c1592;} else {var temp888 = M2.cdr(l1591);if (f1581(M2.car(l1591))!==false) {var if_res887 = M2.add1(c1592);} else {var if_res887 = c1592;}var if_res889 = loop1590(temp888,if_res887);}return if_res889;};var if_res890 = loop1590(l1582,0);}return if_res890;});var partition = function(pred1593, l1594) {if (M2.procedure_p(pred1593)!==false) {var if_res891 = M2.procedure_arity_includes_p(pred1593,1);} else {var if_res891 = false;}if (if_res891!==false) {var if_res892 = M2.rvoid();} else {var if_res892 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("partition"),$rjs_core.UString.make("(any/c . -> . any/c)"),0,pred1593,l1594);}if_res892;if (M2.list_p(l1594)!==false) {var if_res893 = M2.rvoid();} else {var if_res893 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("partition"),$rjs_core.UString.make("list?"),1,pred1593,l1594);}if_res893;var loop1595 = function(l1596, i1597, o1598) {if (M2.null_p(l1596)!==false) {var if_res895 = M2.values(M8.alt_reverse(i1597),M8.alt_reverse(o1598));} else {var x1599 = M2.car(l1596);var l1600 = M2.cdr(l1596);if (pred1593(x1599)!==false) {var if_res894 = loop1595(l1600,M2.cons(x1599,i1597),o1598);} else {var if_res894 = loop1595(l1600,i1597,M2.cons(x1599,o1598));}var if_res895 = if_res894;}return if_res895;};return loop1595(l1594,$rjs_core.Pair.makeList(),$rjs_core.Pair.makeList());};var cl896 = function(end1602) {var start1603 = 0;var end1604 = end1602;var inc1605 = 1;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res900 = M2.rvoid();} else {var if_res900 = M0.__rjs_quoted__.check_range(start1603,end1604,inc1605);}if_res900;var for_loop1606 = function(fold_var1607, pos1608) {if (M2.__lt_(pos1608,end1604)!==false) {var i1609 = pos1608;if (true!==false) {var fold_var1611 = fold_var1607;var fold_var1612 = M2.cons(i1609,fold_var1611);var fold_var1610 = M2.values(fold_var1612);if (true!==false) {var if_res901 = M2.not(false);} else {var if_res901 = false;}if (if_res901!==false) {var if_res902 = for_loop1606(fold_var1610,pos1608+inc1605);} else {var if_res902 = fold_var1610;}var if_res903 = if_res902;} else {var if_res903 = fold_var1607;}var if_res904 = if_res903;} else {var if_res904 = fold_var1607;}return if_res904;};return M8.alt_reverse(for_loop1606(M2.rnull,start1603));};var cl897 = function(start1613, end1614) {var start1615 = start1613;var end1616 = end1614;var inc1617 = 1;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res905 = M2.rvoid();} else {var if_res905 = M0.__rjs_quoted__.check_range(start1615,end1616,inc1617);}if_res905;var for_loop1618 = function(fold_var1619, pos1620) {if (M2.__lt_(pos1620,end1616)!==false) {var i1621 = pos1620;if (true!==false) {var fold_var1623 = fold_var1619;var fold_var1624 = M2.cons(i1621,fold_var1623);var fold_var1622 = M2.values(fold_var1624);if (true!==false) {var if_res906 = M2.not(false);} else {var if_res906 = false;}if (if_res906!==false) {var if_res907 = for_loop1618(fold_var1622,pos1620+inc1617);} else {var if_res907 = fold_var1622;}var if_res908 = if_res907;} else {var if_res908 = fold_var1619;}var if_res909 = if_res908;} else {var if_res909 = fold_var1619;}return if_res909;};return M8.alt_reverse(for_loop1618(M2.rnull,start1615));};var cl898 = function(start1625, end1626, step1627) {var start1628 = start1625;var end1629 = end1626;var inc1630 = step1627;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res910 = M2.rvoid();} else {var if_res910 = M0.__rjs_quoted__.check_range(start1628,end1629,inc1630);}if_res910;var for_loop1631 = function(fold_var1632, pos1633) {if (M2.__gt__eq_(step1627,0)!==false) {var if_res911 = M2.__lt_(pos1633,end1629);} else {var if_res911 = M2.__gt_(pos1633,end1629);}if (if_res911!==false) {var i1634 = pos1633;if (true!==false) {var fold_var1636 = fold_var1632;var fold_var1637 = M2.cons(i1634,fold_var1636);var fold_var1635 = M2.values(fold_var1637);if (true!==false) {var if_res912 = M2.not(false);} else {var if_res912 = false;}if (if_res912!==false) {var if_res913 = for_loop1631(fold_var1635,pos1633+inc1630);} else {var if_res913 = fold_var1635;}var if_res914 = if_res913;} else {var if_res914 = fold_var1632;}var if_res915 = if_res914;} else {var if_res915 = fold_var1632;}return if_res915;};return M8.alt_reverse(for_loop1631(M2.rnull,start1628));};var range1601 = $rjs_core.attachProcedureArity(function() {var fixed_lam899 = {'1':cl896,'2':cl897,'3':cl898}[arguments.length];if (fixed_lam899!==undefined) {return fixed_lam899.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2,3]);var range_proc = range1601;var cl916 = function(start1639, end1640) {var start1641 = start1639;var end1642 = end1640;var inc1643 = 1;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res919 = M2.rvoid();} else {var if_res919 = M0.__rjs_quoted__.check_range_generic($rjs_core.PrimitiveSymbol.make("in-inclusive-range"),start1641,end1642,inc1643);}if_res919;var for_loop1644 = function(fold_var1645, pos1646) {if (M2.__lt__eq_(pos1646,end1642)!==false) {var i1647 = pos1646;if (true!==false) {var fold_var1649 = fold_var1645;var fold_var1650 = M2.cons(i1647,fold_var1649);var fold_var1648 = M2.values(fold_var1650);if (true!==false) {var if_res920 = M2.not(false);} else {var if_res920 = false;}if (if_res920!==false) {var if_res921 = for_loop1644(fold_var1648,pos1646+inc1643);} else {var if_res921 = fold_var1648;}var if_res922 = if_res921;} else {var if_res922 = fold_var1645;}var if_res923 = if_res922;} else {var if_res923 = fold_var1645;}return if_res923;};return M8.alt_reverse(for_loop1644(M2.rnull,start1641));};var cl917 = function(start1651, end1652, step1653) {var start1654 = start1651;var end1655 = end1652;var inc1656 = step1653;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res924 = M2.rvoid();} else {var if_res924 = M0.__rjs_quoted__.check_range_generic($rjs_core.PrimitiveSymbol.make("in-inclusive-range"),start1654,end1655,inc1656);}if_res924;var for_loop1657 = function(fold_var1658, pos1659) {if (M2.__gt__eq_(step1653,0)!==false) {var if_res925 = M2.__lt__eq_(pos1659,end1655);} else {var if_res925 = M2.__gt__eq_(pos1659,end1655);}if (if_res925!==false) {var i1660 = pos1659;if (true!==false) {var fold_var1662 = fold_var1658;var fold_var1663 = M2.cons(i1660,fold_var1662);var fold_var1661 = M2.values(fold_var1663);if (true!==false) {var if_res926 = M2.not(false);} else {var if_res926 = false;}if (if_res926!==false) {var if_res927 = for_loop1657(fold_var1661,pos1659+inc1656);} else {var if_res927 = fold_var1661;}var if_res928 = if_res927;} else {var if_res928 = fold_var1658;}var if_res929 = if_res928;} else {var if_res929 = fold_var1658;}return if_res929;};return M8.alt_reverse(for_loop1657(M2.rnull,start1654));};var inclusive_range1638 = $rjs_core.attachProcedureArity(function() {var fixed_lam918 = {'2':cl916,'3':cl917}[arguments.length];if (fixed_lam918!==undefined) {return fixed_lam918.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var inclusive_range_proc = inclusive_range1638;var cl930 = function(f1664, l1665) {return M2.apply(M2.append,M4.map(f1664,l1665));};var cl931 = function(f1666, l11667, l21668) {return M2.apply(M2.append,M4.map(f1666,l11667,l21668));};var cl932 = $rjs_core.attachProcedureArity(function(f1669, l1670, ...ls1671935) {var ls1671 = $rjs_core.Pair.listFromArray(ls1671935);return M2.apply(M2.append,M2.apply(M4.map,f1669,l1670,ls1671));});var append_map = $rjs_core.attachProcedureArity(function() {var fixed_lam933 = {'2':cl930,'3':cl931}[arguments.length];if (fixed_lam933!==undefined) {return fixed_lam933.apply(null,arguments);} else {if (M2.__gt__eq_(cl932.length,1)!==false) {var if_res934 = cl932.apply(null,arguments);} else {var if_res934 = M2.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res934;}},[M2.make_arity_at_least(2)]);var filter_not = function(f1672, list1673) {if (M2.procedure_p(f1672)!==false) {var if_res936 = M2.procedure_arity_includes_p(f1672,1);} else {var if_res936 = false;}if (if_res936!==false) {var if_res937 = M2.rvoid();} else {var if_res937 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("filter-not"),$rjs_core.UString.make("(any/c . -> . any/c)"),0,f1672,list1673);}if_res937;if (M2.list_p(list1673)!==false) {var if_res938 = M2.rvoid();} else {var if_res938 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("filter-not"),$rjs_core.UString.make("list?"),1,f1672,list1673);}if_res938;var loop1674 = function(l1675, result1676) {if (M2.null_p(l1675)!==false) {var if_res941 = M8.alt_reverse(result1676);} else {var temp940 = M2.cdr(l1675);if (f1672(M2.car(l1675))!==false) {var if_res939 = result1676;} else {var if_res939 = M2.cons(M2.car(l1675),result1676);}var if_res941 = loop1674(temp940,if_res939);}return if_res941;};return loop1674(list1673,M2.rnull);};var shuffle = function(l1677) {if (M2.list_p(l1677)!==false) {var if_res942 = M2.rvoid();} else {var if_res942 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("shuffle"),$rjs_core.UString.make("list?"),0,l1677);}if_res942;var let_result943 = M2.values();var a1678 = M2.make_vector(M2.length(l1677));var lst1679 = l1677;var start1680 = 0;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res944 = M2.rvoid();} else {var if_res944 = M0.__rjs_quoted__.check_list(lst1679);}if_res944;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res945 = M2.rvoid();} else {var if_res945 = M0.__rjs_quoted__.check_naturals(start1680);}if_res945;var for_loop1681 = function(lst1682, pos1683) {if (M2.pair_p(lst1682)!==false) {var if_res946 = true;} else {var if_res946 = false;}if (if_res946!==false) {var x1684 = M10.unsafe_car(lst1682);var rest1685 = M10.unsafe_cdr(lst1682);var i1686 = pos1683;if (true!==false) {var if_res947 = true;} else {var if_res947 = false;}if (if_res947!==false) {var j1687 = M5.random(M2.add1(i1686));if (M2.__eq_(j1687,i1686)!==false) {var if_res948 = M2.rvoid();} else {var if_res948 = M2.vector_set_bang_(a1678,i1686,M2.vector_ref(a1678,j1687));}if_res948;M2.vector_set_bang_(a1678,j1687,x1684);var let_result949 = M2.values();var let_result950 = M2.values();if (true!==false) {if (true!==false) {var if_res951 = M2.not(false);} else {var if_res951 = false;}var if_res952 = if_res951;} else {var if_res952 = false;}if (if_res952!==false) {var if_res953 = for_loop1681(rest1685,pos1683+1);} else {var if_res953 = M2.values();}var if_res954 = if_res953;} else {var if_res954 = M2.values();}var if_res955 = if_res954;} else {var if_res955 = M2.values();}return if_res955;};for_loop1681(lst1679,start1680);M2.rvoid();return M2.vector__gt_list(a1678);};var combinations1688 = function(l371689, k361690) {var l1691 = l371689;if (false!==false) {var if_res956 = false;} else {var if_res956 = k361690;}var k1692 = if_res956;var let_result957 = M0.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),in_combinations(l1691,k1692));var pos__gt_vals1693 = let_result957.getAt(0);var pos_pre_inc1694 = let_result957.getAt(1);var pos_next1695 = let_result957.getAt(2);var init1696 = let_result957.getAt(3);var pos_cont_p1697 = let_result957.getAt(4);var val_cont_p1698 = let_result957.getAt(5);var all_cont_p1699 = let_result957.getAt(6);M2.rvoid();var for_loop1700 = function(fold_var1701, pos1702) {if (pos_cont_p1697!==false) {var if_res958 = pos_cont_p1697(pos1702);} else {var if_res958 = true;}if (if_res958!==false) {var x1706 = pos__gt_vals1693(pos1702);if (all_cont_p1699!==false) {var if_res959 = function(pos1707) {return all_cont_p1699(pos1707,x1706);};} else {var if_res959 = false;}var let_result960 = M2.values(x1706,if_res959);var x1703 = let_result960.getAt(0);var all_cont_p_by_pos1704 = let_result960.getAt(1);if (pos_pre_inc1694!==false) {var if_res961 = pos_pre_inc1694(pos1702);} else {var if_res961 = pos1702;}var pos1705 = if_res961;if (val_cont_p1698!==false) {var if_res962 = val_cont_p1698(x1703);} else {var if_res962 = true;}if (if_res962!==false) {var fold_var1709 = fold_var1701;var fold_var1710 = M2.cons(x1703,fold_var1709);var fold_var1708 = M2.values(fold_var1710);if (all_cont_p_by_pos1704!==false) {var if_res963 = all_cont_p_by_pos1704(pos1705);} else {var if_res963 = true;}if (if_res963!==false) {var if_res964 = M2.not(false);} else {var if_res964 = false;}if (if_res964!==false) {var if_res965 = for_loop1700(fold_var1708,pos_next1695(pos1705));} else {var if_res965 = fold_var1708;}var if_res966 = if_res965;} else {var if_res966 = fold_var1701;}var if_res967 = if_res966;} else {var if_res967 = fold_var1701;}return if_res967;};return M8.alt_reverse(for_loop1700(M2.rnull,init1696));};var cl968 = function(l1711) {return combinations1688(l1711,false);};var cl969 = function(l1712, k361713) {return combinations1688(l1712,k361713);};var combinations = $rjs_core.attachProcedureArity(function() {var fixed_lam970 = {'1':cl968,'2':cl969}[arguments.length];if (fixed_lam970!==undefined) {return fixed_lam970.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var in_combinations1714 = function(l391715, k381716) {var l1717 = l391715;if (false!==false) {var if_res971 = false;} else {var if_res971 = k381716;}var k1718 = if_res971;if (M2.list_p(l1717)!==false) {var if_res972 = M2.rvoid();} else {var if_res972 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-combinations"),$rjs_core.UString.make("list?"),0,l1717);}if_res972;var let_result973 = M2.values();if (k1718!==false) {var if_res974 = M2.not(M2.exact_nonnegative_integer_p(k1718));} else {var if_res974 = false;}if (if_res974!==false) {var if_res975 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-combinations"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1717,k1718);} else {var if_res975 = M2.rvoid();}if_res975;var let_result976 = M2.values();var v1719 = M2.list__gt_vector(l1717);var N1720 = M2.vector_length(v1719);var N_11721 = N1720-1;if (M2.not(k1718)!==false) {var limit1723 = M2.expt(2,N1720);var curr_box1724 = M2.box(0);var if_res1013 = function() {var curr1725 = M2.unbox(curr_box1724);if (M2.__lt_(curr1725,limit1723)!==false) {var start1726 = N_11721;var end1727 = -1;var inc1728 = -1;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res978 = M2.rvoid();} else {var if_res978 = M0.__rjs_quoted__.check_range(start1726,end1727,inc1728);}if_res978;var for_loop1729 = function(acc1730, pos1731) {if (M2.__gt_(pos1731,end1727)!==false) {var i1732 = pos1731;if (true!==false) {var acc1734 = acc1730;if (M2.bitwise_bit_set_p(curr1725,i1732)!==false) {var if_res979 = M2.cons(M2.vector_ref(v1719,i1732),acc1734);} else {var if_res979 = acc1734;}var acc1735 = if_res979;var acc1733 = M2.values(acc1735);if (true!==false) {var if_res980 = M2.not(false);} else {var if_res980 = false;}if (if_res980!==false) {var if_res981 = for_loop1729(acc1733,pos1731+inc1728);} else {var if_res981 = acc1733;}var if_res982 = if_res981;} else {var if_res982 = acc1730;}var if_res983 = if_res982;} else {var if_res983 = acc1730;}return if_res983;};var begin_res977 = for_loop1729($rjs_core.Pair.makeList(),start1726);M2.set_box_bang_(curr_box1724,curr1725+1);var if_res984 = begin_res977;} else {var if_res984 = false;}return if_res984;};} else {if (M2.__lt_(N1720,k1718)!==false) {var if_res1012 = function() {return false;};} else {var running_p1736 = true;var k_times_1737 = M6.build_vector(k1718,function(i1738) {return i1738;});var k_11739 = k1718-1;var if_res1012 = function() {if (running_p1736!==false) {var vec1742 = k_times_1737;M0.__rjs_quoted__.check_vector(vec1742);var let_result986 = M2.values(vec1742,M10.unsafe_vector_length(vec1742));var vec1740 = let_result986.getAt(0);var len1741 = let_result986.getAt(1);false;var for_loop1743 = function(fold_var1744, pos1745) {if (M10.unsafe_fx_lt_(pos1745,len1741)!==false) {var i1746 = M10.unsafe_vector_ref(vec1740,pos1745);if (true!==false) {var fold_var1748 = fold_var1744;var fold_var1749 = M2.cons(M2.vector_ref(v1719,i1746),fold_var1748);var fold_var1747 = M2.values(fold_var1749);if (true!==false) {var if_res987 = M2.not(false);} else {var if_res987 = false;}if (if_res987!==false) {var if_res988 = for_loop1743(fold_var1747,M10.unsafe_fx_plus_(1,pos1745));} else {var if_res988 = fold_var1747;}var if_res989 = if_res988;} else {var if_res989 = fold_var1744;}var if_res990 = if_res989;} else {var if_res990 = fold_var1744;}return if_res990;};var begin_res985 = M8.alt_reverse(for_loop1743(M2.rnull,0));var index_to_change1750 = false;var start1751 = k_11739;var end1752 = -1;var inc1753 = -1;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res991 = M2.rvoid();} else {var if_res991 = M0.__rjs_quoted__.check_range(start1751,end1752,inc1753);}if_res991;var for_loop1754 = function(pos1755) {if (M2.__gt_(pos1755,end1752)!==false) {var i1756 = pos1755;if (true!==false) {var next_k_proc1757 = function() {if (true!==false) {var if_res992 = for_loop1754(pos1755+inc1753);} else {var if_res992 = M2.values();}return if_res992;};if (M2.not(M2.eq_p(M2.vector_ref(k_times_1737,i1756),i1756+N1720+M2.__(k1718)))!==false) {index_to_change1750 = i1756;var if_res993 = true;} else {var if_res993 = false;}if (if_res993!==false) {var if_res996 = M2.values();} else {M2.rvoid();var let_result994 = M2.values();if (false!==false) {var if_res995 = M2.values();} else {var if_res995 = next_k_proc1757();}var if_res996 = if_res995;}var if_res997 = if_res996;} else {var if_res997 = M2.values();}var if_res998 = if_res997;} else {var if_res998 = M2.values();}return if_res998;};for_loop1754(start1751);M2.rvoid();if (index_to_change1750!==false) {var val_to_change1758 = M2.add1(M2.vector_ref(k_times_1737,index_to_change1750));var start1759 = index_to_change1750;var end1760 = k1718;var inc1761 = 1;var start1762 = val_to_change1758;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res999 = M2.rvoid();} else {var if_res999 = M0.__rjs_quoted__.check_range(start1759,end1760,inc1761);}if_res999;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1000 = M2.rvoid();} else {var if_res1000 = M0.__rjs_quoted__.check_naturals(start1762);}if_res1000;var for_loop1763 = function(pos1764, pos1765) {if (M2.__lt_(pos1764,end1760)!==false) {var if_res1001 = true;} else {var if_res1001 = false;}if (if_res1001!==false) {var i1766 = pos1764;var v1767 = pos1765;if (true!==false) {var if_res1002 = true;} else {var if_res1002 = false;}if (if_res1002!==false) {M2.vector_set_bang_(k_times_1737,i1766,v1767);var let_result1003 = M2.values();var let_result1004 = M2.values();if (true!==false) {if (true!==false) {var if_res1005 = M2.not(false);} else {var if_res1005 = false;}var if_res1006 = if_res1005;} else {var if_res1006 = false;}if (if_res1006!==false) {var if_res1007 = for_loop1763(pos1764+inc1761,pos1765+1);} else {var if_res1007 = M2.values();}var if_res1008 = if_res1007;} else {var if_res1008 = M2.values();}var if_res1009 = if_res1008;} else {var if_res1009 = M2.values();}return if_res1009;};for_loop1763(start1759,start1762);var if_res1010 = M2.rvoid();} else {running_p1736 = false;var if_res1010 = null;}if_res1010;var if_res1011 = begin_res985;} else {var if_res1011 = false;}return if_res1011;};}var if_res1013 = if_res1012;}var gen_combinations1722 = if_res1013;return M0.__rjs_quoted__.in_producer(gen_combinations1722,false);};var cl1014 = function(l1768) {return in_combinations1714(l1768,false);};var cl1015 = function(l1769, k381770) {return in_combinations1714(l1769,k381770);};var in_combinations = $rjs_core.attachProcedureArity(function() {var fixed_lam1016 = {'1':cl1014,'2':cl1015}[arguments.length];if (fixed_lam1016!==undefined) {return fixed_lam1016.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var swap_plus_flip = function(l1771, i1772, j1773) {var tmp1774 = j1773;if (M2.equal_p(tmp1774,0)!==false) {var if_res1024 = M2.list_times_(M2.cadr(l1771),M2.car(l1771),M2.cddr(l1771));} else {if (M2.equal_p(tmp1774,1)!==false) {var a1775 = M2.car(l1771);var b1776 = M2.cadr(l1771);var c1777 = M2.caddr(l1771);var l1778 = M2.cdddr(l1771);var tmp1779 = i1772;if (M2.equal_p(tmp1779,0)!==false) {var if_res1017 = M2.list_times_(b1776,c1777,a1775,l1778);} else {var if_res1017 = M2.list_times_(c1777,a1775,b1776,l1778);}var if_res1023 = if_res1017;} else {if (M2.equal_p(tmp1774,2)!==false) {var a1780 = M2.car(l1771);var b1781 = M2.cadr(l1771);var c1782 = M2.caddr(l1771);var d1783 = M2.cadddr(l1771);var l1784 = M2.cddddr(l1771);var tmp1785 = i1772;if (M2.equal_p(tmp1785,0)!==false) {var if_res1019 = M2.list_times_(c1782,b1781,d1783,a1780,l1784);} else {if (M2.equal_p(tmp1785,1)!==false) {var if_res1018 = M2.list_times_(c1782,d1783,a1780,b1781,l1784);} else {var if_res1018 = M2.list_times_(d1783,b1781,a1780,c1782,l1784);}var if_res1019 = if_res1018;}var if_res1022 = if_res1019;} else {var loop1786 = function(n1787, l11788, r11789) {if (M2.__gt_(n1787,0)!==false) {var if_res1021 = loop1786(M2.sub1(n1787),M2.cons(M2.car(r11789),l11788),M2.cdr(r11789));} else {var loop1790 = function(n1791, l21792, r21793) {if (M2.__gt_(n1791,0)!==false) {var if_res1020 = loop1790(M2.sub1(n1791),M2.cons(M2.car(r21793),l21792),M2.cdr(r21793));} else {var if_res1020 = M7.__rjs_quoted__.qq_append(l21792,M2.list_times_(M2.car(r21793),M7.__rjs_quoted__.qq_append(l11788,M2.list_times_(M2.car(r11789),M2.cdr(r21793)))));}return if_res1020;};var if_res1021 = loop1790(j1773-i1772,$rjs_core.Pair.makeList(),M2.cdr(r11789));}return if_res1021;};var if_res1022 = loop1786(i1772,$rjs_core.Pair.makeList(),l1771);}var if_res1023 = if_res1022;}var if_res1024 = if_res1023;}return if_res1024;};var permutations = function(l1794) {if (M2.not(M2.list_p(l1794))!==false) {var if_res1031 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("list?"),0,l1794);} else {var or_part1795 = M2.null_p(l1794);if (or_part1795!==false) {var if_res1025 = or_part1795;} else {var if_res1025 = M2.null_p(M2.cdr(l1794));}if (if_res1025!==false) {var if_res1030 = M2.list(l1794);} else {var N1796 = M2.length(l1794)-2;if (M2.__gt_(N1796,254)!==false) {var if_res1026 = M2.error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("input list too long: ~e"),l1794);} else {var if_res1026 = M2.rvoid();}if_res1026;var let_result1027 = M2.values();var c1797 = M2.make_bytes(M2.add1(N1796),0);var loop1798 = function(i1799, acc1800) {var ci1801 = M2.bytes_ref(c1797,i1799);if (M2.__lt__eq_(ci1801,i1799)!==false) {M2.bytes_set_bang_(c1797,i1799,M2.add1(ci1801));var if_res1029 = loop1798(0,M2.cons(swap_plus_flip(M2.car(acc1800),ci1801,i1799),acc1800));} else {if (M2.__lt_(i1799,N1796)!==false) {M2.bytes_set_bang_(c1797,i1799,0);var if_res1028 = loop1798(M2.add1(i1799),acc1800);} else {var if_res1028 = acc1800;}var if_res1029 = if_res1028;}return if_res1029;};var if_res1030 = loop1798(0,M2.list(M8.alt_reverse(l1794)));}var if_res1031 = if_res1030;}return if_res1031;};var in_permutations = function(l1802) {if (M2.not(M2.list_p(l1802))!==false) {var if_res1040 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-permutations"),$rjs_core.UString.make("list?"),0,l1802);} else {var or_part1803 = M2.null_p(l1802);if (or_part1803!==false) {var if_res1032 = or_part1803;} else {var if_res1032 = M2.null_p(M2.cdr(l1802));}if (if_res1032!==false) {var if_res1039 = M0.__rjs_quoted__.in_value(l1802);} else {var N1804 = M2.length(l1802)-2;if (M2.__gt_(N1804,254)!==false) {var if_res1033 = M2.error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("input list too long: ~e"),l1802);} else {var if_res1033 = M2.rvoid();}if_res1033;var let_result1034 = M2.values();var c1805 = M2.make_bytes(M2.add1(N1804),0);var i1806 = 0;var cur1807 = M8.alt_reverse(l1802);var next1808 = function() {var r1809 = cur1807;var ci1810 = M2.bytes_ref(c1805,i1806);if (M2.__lt__eq_(ci1810,i1806)!==false) {M2.bytes_set_bang_(c1805,i1806,M2.add1(ci1810));var begin_res1035 = swap_plus_flip(cur1807,ci1810,i1806);i1806 = 0;var if_res1037 = begin_res1035;} else {if (M2.__lt_(i1806,N1804)!==false) {M2.bytes_set_bang_(c1805,i1806,0);i1806 = M2.add1(i1806);var if_res1036 = next1808();} else {var if_res1036 = false;}var if_res1037 = if_res1036;}return if_res1037;};var if_res1039 = M0.__rjs_quoted__.in_producer(function() {var begin_res1038 = cur1807;cur1807 = next1808();return begin_res1038;},false);}var if_res1040 = if_res1039;}return if_res1040;};var mk_min = function(cmp1811, name1812, f1813, xs1814) {if (M2.procedure_p(f1813)!==false) {var if_res1041 = M2.procedure_arity_includes_p(f1813,1);} else {var if_res1041 = false;}if (if_res1041!==false) {var if_res1042 = M2.rvoid();} else {var if_res1042 = M2.raise_argument_error(name1812,$rjs_core.UString.make("(any/c . -> . real?)"),0,f1813,xs1814);}if_res1042;if (M2.list_p(xs1814)!==false) {var if_res1043 = M2.pair_p(xs1814);} else {var if_res1043 = false;}if (if_res1043!==false) {var if_res1044 = M2.rvoid();} else {var if_res1044 = M2.raise_argument_error(name1812,$rjs_core.UString.make("(and/c list? (not/c empty?))"),1,f1813,xs1814);}if_res1044;var init_min_var1815 = f1813(M2.car(xs1814));if (M2.real_p(init_min_var1815)!==false) {var if_res1045 = M2.rvoid();} else {var if_res1045 = M2.raise_result_error(name1812,$rjs_core.UString.make("real?"),init_min_var1815);}if_res1045;var loop1816 = function(min1817, min_var1818, xs1819) {if (M2.null_p(xs1819)!==false) {var if_res1048 = min1817;} else {var new_min1820 = f1813(M2.car(xs1819));if (M2.real_p(new_min1820)!==false) {var if_res1046 = M2.rvoid();} else {var if_res1046 = M2.raise_result_error(name1812,$rjs_core.UString.make("real?"),new_min1820);}if_res1046;if (cmp1811(new_min1820,min_var1818)!==false) {var if_res1047 = loop1816(M2.car(xs1819),new_min1820,M2.cdr(xs1819));} else {var if_res1047 = loop1816(min1817,min_var1818,M2.cdr(xs1819));}var if_res1048 = if_res1047;}return if_res1048;};return loop1816(M2.car(xs1814),init_min_var1815,M2.cdr(xs1814));};var argmin = function(f1821, xs1822) {return mk_min(M2.__lt_,$rjs_core.PrimitiveSymbol.make("argmin"),f1821,xs1822);};var argmax = function(f1823, xs1824) {return mk_min(M2.__gt_,$rjs_core.PrimitiveSymbol.make("argmax"),f1823,xs1824);};var group_by1825 = function(key411826, l421827, __eq__p401828) {var key1829 = key411826;var l1830 = l421827;if (M2.eq_p(__eq__p401828,M10.unsafe_undefined)!==false) {var if_res1049 = M2.equal_p;} else {var if_res1049 = __eq__p401828;}var __eq__p1831 = if_res1049;if (M2.procedure_p(key1829)!==false) {var if_res1050 = M2.procedure_arity_includes_p(key1829,1);} else {var if_res1050 = false;}if (if_res1050!==false) {var if_res1051 = M2.rvoid();} else {var if_res1051 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("(-> any/c any/c)"),0,key1829,l1830);}if_res1051;var let_result1052 = M2.values();if (M2.procedure_p(__eq__p1831)!==false) {var if_res1053 = M2.procedure_arity_includes_p(__eq__p1831,2);} else {var if_res1053 = false;}if (if_res1053!==false) {var if_res1054 = M2.rvoid();} else {var if_res1054 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,key1829,l1830,__eq__p1831);}if_res1054;var let_result1055 = M2.values();if (M2.list_p(l1830)!==false) {var if_res1056 = M2.rvoid();} else {var if_res1056 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("list?"),1,key1829,l1830);}if_res1056;var let_result1057 = M2.values();var alist_update1832 = function(al1833, k1834, up1835, fail1836) {var loop1837 = function(al1838) {if (M2.null_p(al1838)!==false) {var if_res1059 = M2.list(M2.cons(k1834,up1835($rjs_core.Pair.makeList())));} else {if (__eq__p1831(M2.car(M2.car(al1838)),k1834)!==false) {var if_res1058 = M2.cons(M2.cons(k1834,up1835(M2.cdr(M2.car(al1838)))),M2.cdr(al1838));} else {var if_res1058 = M2.cons(M2.car(al1838),loop1837(M2.cdr(al1838)));}var if_res1059 = if_res1058;}return if_res1059;};return loop1837(al1833);};if (M2.equal_p(__eq__p1831,M2.eq_p)!==false) {var if_res1062 = M2.values(M2.hasheq(),M9.hash_update);} else {if (M2.equal_p(__eq__p1831,M2.eqv_p)!==false) {var if_res1061 = M2.values(M2.hasheqv(),M9.hash_update);} else {if (M2.equal_p(__eq__p1831,M2.equal_p)!==false) {var if_res1060 = M2.values(M2.hash(),M9.hash_update);} else {var if_res1060 = M2.values($rjs_core.Pair.makeList(),alist_update1832);}var if_res1061 = if_res1060;}var if_res1062 = if_res1061;}var let_result1063 = if_res1062;var base1839 = let_result1063.getAt(0);var update1840 = let_result1063.getAt(1);var lst1842 = l1830;var start1843 = 0;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1064 = M2.rvoid();} else {var if_res1064 = M0.__rjs_quoted__.check_list(lst1842);}if_res1064;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1065 = M2.rvoid();} else {var if_res1065 = M0.__rjs_quoted__.check_naturals(start1843);}if_res1065;var for_loop1844 = function(res1845, lst1846, pos1847) {if (M2.pair_p(lst1846)!==false) {var if_res1066 = true;} else {var if_res1066 = false;}if (if_res1066!==false) {var elt1848 = M10.unsafe_car(lst1846);var rest1849 = M10.unsafe_cdr(lst1846);var idx1850 = pos1847;if (true!==false) {var if_res1067 = true;} else {var if_res1067 = false;}if (if_res1067!==false) {var res1852 = res1845;var k1854 = key1829(elt1848);var v1855 = M2.cons(idx1850,elt1848);var res1853 = update1840(res1852,k1854,function(o1856) {return M2.cons(v1855,o1856);},$rjs_core.Pair.makeList());var res1851 = M2.values(res1853);if (true!==false) {if (true!==false) {var if_res1068 = M2.not(false);} else {var if_res1068 = false;}var if_res1069 = if_res1068;} else {var if_res1069 = false;}if (if_res1069!==false) {var if_res1070 = for_loop1844(res1851,rest1849,pos1847+1);} else {var if_res1070 = res1851;}var if_res1071 = if_res1070;} else {var if_res1071 = res1845;}var if_res1072 = if_res1071;} else {var if_res1072 = res1845;}return if_res1072;};var classes1841 = for_loop1844(base1839,lst1842,start1843);if (M2.list_p(classes1841)!==false) {var lst1858 = classes1841;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1073 = M2.rvoid();} else {var if_res1073 = M0.__rjs_quoted__.check_list(lst1858);}if_res1073;var for_loop1859 = function(fold_var1860, lst1861) {if (M2.pair_p(lst1861)!==false) {var p1862 = M10.unsafe_car(lst1861);var rest1863 = M10.unsafe_cdr(lst1861);if (true!==false) {var fold_var1865 = fold_var1860;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__338851867 = M6.__rjs_quoted__.sort7;var temp531868 = M2.cdr(p1862);var __lt_541869 = M2.__lt_;var car551870 = M2.car;if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1074 = M6.__rjs_quoted__.sort(false,car551870,temp531868,__lt_541869);} else {var if_res1074 = M2.checked_procedure_check_and_extract(M1.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__338851867,M1.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M2.list(car551870),temp531868,__lt_541869);}var fold_var1866 = M2.cons(if_res1074,fold_var1865);var fold_var1864 = M2.values(fold_var1866);if (true!==false) {var if_res1075 = M2.not(false);} else {var if_res1075 = false;}if (if_res1075!==false) {var if_res1076 = for_loop1859(fold_var1864,rest1863);} else {var if_res1076 = fold_var1864;}var if_res1077 = if_res1076;} else {var if_res1077 = fold_var1860;}var if_res1078 = if_res1077;} else {var if_res1078 = fold_var1860;}return if_res1078;};var if_res1086 = M8.alt_reverse(for_loop1859(M2.rnull,lst1858));} else {var ht1871 = classes1841;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1079 = M2.rvoid();} else {var if_res1079 = M0.__rjs_quoted__.check_in_hash(ht1871);}if_res1079;var for_loop1872 = function(fold_var1873, i1874) {if (i1874!==false) {var let_result1080 = M2.hash_iterate_key_plus_value(ht1871,i1874);var _1875 = let_result1080.getAt(0);var c1876 = let_result1080.getAt(1);if (true!==false) {var fold_var1878 = fold_var1873;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__339691880 = M6.__rjs_quoted__.sort7;var c561881 = c1876;var __lt_571882 = M2.__lt_;var car581883 = M2.car;if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1081 = M6.__rjs_quoted__.sort(false,car581883,c561881,__lt_571882);} else {var if_res1081 = M2.checked_procedure_check_and_extract(M1.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__339691880,M1.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M2.list(car581883),c561881,__lt_571882);}var fold_var1879 = M2.cons(if_res1081,fold_var1878);var fold_var1877 = M2.values(fold_var1879);if (true!==false) {var if_res1082 = M2.not(false);} else {var if_res1082 = false;}if (if_res1082!==false) {var if_res1083 = for_loop1872(fold_var1877,M2.hash_iterate_next(ht1871,i1874));} else {var if_res1083 = fold_var1877;}var if_res1084 = if_res1083;} else {var if_res1084 = fold_var1873;}var if_res1085 = if_res1084;} else {var if_res1085 = fold_var1873;}return if_res1085;};var if_res1086 = M8.alt_reverse(for_loop1872(M2.rnull,M2.hash_iterate_first(ht1871)));}var sorted_classes1857 = if_res1086;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__340861885 = M6.__rjs_quoted__.sort7;var sorted_classes591886 = sorted_classes1857;var __lt_601887 = M2.__lt_;var caar611888 = M2.caar;if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1087 = M6.__rjs_quoted__.sort(false,caar611888,sorted_classes591886,__lt_601887);} else {var if_res1087 = M2.checked_procedure_check_and_extract(M1.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__340861885,M1.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M2.list(caar611888),sorted_classes591886,__lt_601887);}var lst1884 = if_res1087;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1088 = M2.rvoid();} else {var if_res1088 = M0.__rjs_quoted__.check_list(lst1884);}if_res1088;var for_loop1889 = function(fold_var1890, lst1891) {if (M2.pair_p(lst1891)!==false) {var c1892 = M10.unsafe_car(lst1891);var rest1893 = M10.unsafe_cdr(lst1891);if (true!==false) {var fold_var1895 = fold_var1890;var fold_var1896 = M2.cons(M4.map(M2.cdr,c1892),fold_var1895);var fold_var1894 = M2.values(fold_var1896);if (true!==false) {var if_res1089 = M2.not(false);} else {var if_res1089 = false;}if (if_res1089!==false) {var if_res1090 = for_loop1889(fold_var1894,rest1893);} else {var if_res1090 = fold_var1894;}var if_res1091 = if_res1090;} else {var if_res1091 = fold_var1890;}var if_res1092 = if_res1091;} else {var if_res1092 = fold_var1890;}return if_res1092;};return M8.alt_reverse(for_loop1889(M2.rnull,lst1884));};var cl1093 = function(key1897, l1898) {return group_by1825(key1897,l1898,M10.unsafe_undefined);};var cl1094 = function(key1899, l1900, __eq__p401901) {return group_by1825(key1899,l1900,__eq__p401901);};var group_by = $rjs_core.attachProcedureArity(function() {var fixed_lam1095 = {'2':cl1093,'3':cl1094}[arguments.length];if (fixed_lam1095!==undefined) {return fixed_lam1095.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var cartesian_product = $rjs_core.attachProcedureArity(function(...ls19021096) {var ls1902 = $rjs_core.Pair.listFromArray(ls19021096);var let_result1097 = M0.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("l")),ls1902);var pos__gt_vals1903 = let_result1097.getAt(0);var pos_pre_inc1904 = let_result1097.getAt(1);var pos_next1905 = let_result1097.getAt(2);var init1906 = let_result1097.getAt(3);var pos_cont_p1907 = let_result1097.getAt(4);var val_cont_p1908 = let_result1097.getAt(5);var all_cont_p1909 = let_result1097.getAt(6);var start1910 = 0;if (M2.rvoid()!==false) {if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1098 = M2.rvoid();} else {var if_res1098 = M0.__rjs_quoted__.check_naturals(start1910);}var if_res1099 = if_res1098;} else {var if_res1099 = false;}if_res1099;var for_loop1911 = function(pos1912, pos1913) {if (pos_cont_p1907!==false) {var if_res1100 = pos_cont_p1907(pos1912);} else {var if_res1100 = true;}if (if_res1100!==false) {var if_res1101 = true;} else {var if_res1101 = false;}if (if_res1101!==false) {var l1918 = pos__gt_vals1903(pos1912);if (all_cont_p1909!==false) {var if_res1102 = function(pos1919) {return all_cont_p1909(pos1919,l1918);};} else {var if_res1102 = false;}var let_result1103 = M2.values(l1918,if_res1102);var l1914 = let_result1103.getAt(0);var all_cont_p_by_pos1915 = let_result1103.getAt(1);if (pos_pre_inc1904!==false) {var if_res1104 = pos_pre_inc1904(pos1912);} else {var if_res1104 = pos1912;}var pos1916 = if_res1104;var i1917 = pos1913;if (val_cont_p1908!==false) {var if_res1105 = val_cont_p1908(l1914);} else {var if_res1105 = true;}if (if_res1105!==false) {var if_res1106 = true;} else {var if_res1106 = false;}if (if_res1106!==false) {if (M2.list_p(l1914)!==false) {var if_res1107 = M2.rvoid();} else {var if_res1107 = M2.apply(M2.raise_argument_error,$rjs_core.PrimitiveSymbol.make("cartesian-product"),$rjs_core.UString.make("list?"),i1917,ls1902);}if_res1107;var let_result1108 = M2.values();var let_result1109 = M2.values();if (all_cont_p_by_pos1915!==false) {var if_res1110 = all_cont_p_by_pos1915(pos1916);} else {var if_res1110 = true;}if (if_res1110!==false) {var if_res1111 = true;} else {var if_res1111 = false;}if (if_res1111!==false) {var if_res1112 = M2.not(false);} else {var if_res1112 = false;}if (if_res1112!==false) {var if_res1113 = for_loop1911(pos_next1905(pos1916),pos1913+1);} else {var if_res1113 = M2.values();}var if_res1114 = if_res1113;} else {var if_res1114 = M2.values();}var if_res1115 = if_res1114;} else {var if_res1115 = M2.values();}return if_res1115;};for_loop1911(init1906,start1910);var let_result1116 = M2.values();M2.rvoid();var let_result1117 = M2.values();var cp_21920 = function(as1921, bs1922) {var lst1923 = as1921;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1118 = M2.rvoid();} else {var if_res1118 = M0.__rjs_quoted__.check_list(lst1923);}if_res1118;var for_loop1924 = function(fold_var1925, lst1926) {if (M2.pair_p(lst1926)!==false) {var i1927 = M10.unsafe_car(lst1926);var rest1928 = M10.unsafe_cdr(lst1926);if (true!==false) {var fold_var1930 = fold_var1925;if (true!==false) {var lst1931 = bs1922;if (M2.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1119 = M2.rvoid();} else {var if_res1119 = M0.__rjs_quoted__.check_list(lst1931);}if_res1119;var for_loop1932 = function(fold_var1933, lst1934) {if (M2.pair_p(lst1934)!==false) {var j1935 = M10.unsafe_car(lst1934);var rest1936 = M10.unsafe_cdr(lst1934);if (true!==false) {var fold_var1938 = fold_var1933;if (true!==false) {var fold_var1939 = fold_var1938;var fold_var1940 = M2.cons(M2.cons(i1927,j1935),fold_var1939);var if_res1120 = M2.values(fold_var1940);} else {var if_res1120 = fold_var1938;}var fold_var1937 = if_res1120;if (true!==false) {var if_res1121 = M2.not(false);} else {var if_res1121 = false;}if (if_res1121!==false) {var if_res1122 = for_loop1932(fold_var1937,rest1936);} else {var if_res1122 = fold_var1937;}var if_res1123 = if_res1122;} else {var if_res1123 = fold_var1933;}var if_res1124 = if_res1123;} else {var if_res1124 = fold_var1933;}return if_res1124;};var if_res1125 = for_loop1932(fold_var1930,lst1931);} else {var if_res1125 = fold_var1930;}var fold_var1929 = if_res1125;if (true!==false) {var if_res1126 = M2.not(false);} else {var if_res1126 = false;}if (if_res1126!==false) {var if_res1127 = for_loop1924(fold_var1929,rest1928);} else {var if_res1127 = fold_var1929;}var if_res1128 = if_res1127;} else {var if_res1128 = fold_var1925;}var if_res1129 = if_res1128;} else {var if_res1129 = fold_var1925;}return if_res1129;};return M8.alt_reverse(for_loop1924(M2.rnull,lst1923));};return M6.foldr(cp_21920,M2.list(M2.list()),ls1902);});var remf = function(f1941, ls1942) {if (M2.list_p(ls1942)!==false) {var if_res1130 = M2.rvoid();} else {var if_res1130 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf"),$rjs_core.UString.make("list?"),1,f1941,ls1942);}if_res1130;if (M2.procedure_p(f1941)!==false) {var if_res1131 = M2.procedure_arity_includes_p(f1941,1);} else {var if_res1131 = false;}if (if_res1131!==false) {var if_res1132 = M2.rvoid();} else {var if_res1132 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf"),$rjs_core.UString.make("(-> any/c any/c)"),0,f1941,ls1942);}if_res1132;if (M2.null_p(ls1942)!==false) {var if_res1134 = $rjs_core.Pair.makeList();} else {if (f1941(M2.car(ls1942))!==false) {var if_res1133 = M2.cdr(ls1942);} else {var if_res1133 = M2.cons(M2.car(ls1942),remf(f1941,M2.cdr(ls1942)));}var if_res1134 = if_res1133;}return if_res1134;};var remf_times_ = function(f1943, ls1944) {if (M2.list_p(ls1944)!==false) {var if_res1135 = M2.rvoid();} else {var if_res1135 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf*"),$rjs_core.UString.make("list?"),1,f1943,ls1944);}if_res1135;if (M2.procedure_p(f1943)!==false) {var if_res1136 = M2.procedure_arity_includes_p(f1943,1);} else {var if_res1136 = false;}if (if_res1136!==false) {var if_res1137 = M2.rvoid();} else {var if_res1137 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf*"),$rjs_core.UString.make("(-> any/c any/c)"),0,f1943,ls1944);}if_res1137;if (M2.null_p(ls1944)!==false) {var if_res1139 = $rjs_core.Pair.makeList();} else {if (f1943(M2.car(ls1944))!==false) {var if_res1138 = remf_times_(f1943,M2.cdr(ls1944));} else {var if_res1138 = M2.cons(M2.car(ls1944),remf_times_(f1943,M2.cdr(ls1944)));}var if_res1139 = if_res1138;}return if_res1139;};var index_of1945 = function(ls441946, v451947, __eq__p431948) {var ls1949 = ls441946;var v1950 = v451947;if (M2.eq_p(__eq__p431948,M10.unsafe_undefined)!==false) {var if_res1140 = M2.equal_p;} else {var if_res1140 = __eq__p431948;}var __eq__p1951 = if_res1140;if (M2.list_p(ls1949)!==false) {var if_res1141 = M2.rvoid();} else {var if_res1141 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-of"),$rjs_core.UString.make("list?"),0,ls1949,v1950);}if_res1141;if (M2.procedure_p(__eq__p1951)!==false) {var if_res1142 = M2.procedure_arity_includes_p(__eq__p1951,2);} else {var if_res1142 = false;}if (if_res1142!==false) {var if_res1143 = M2.rvoid();} else {var if_res1143 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-of"),$rjs_core.UString.make("(-> any/c any/c any/c)"),2,ls1949,v1950,__eq__p1951);}if_res1143;var loop1952 = function(ls1953, i1954) {if (M2.null_p(ls1953)!==false) {var if_res1145 = false;} else {if (__eq__p1951(M2.car(ls1953),v1950)!==false) {var if_res1144 = i1954;} else {var if_res1144 = loop1952(M2.cdr(ls1953),M2.add1(i1954));}var if_res1145 = if_res1144;}return if_res1145;};return loop1952(ls1949,0);};var cl1146 = function(ls1955, v1956) {return index_of1945(ls1955,v1956,M10.unsafe_undefined);};var cl1147 = function(ls1957, v1958, __eq__p431959) {return index_of1945(ls1957,v1958,__eq__p431959);};var index_of = $rjs_core.attachProcedureArity(function() {var fixed_lam1148 = {'2':cl1146,'3':cl1147}[arguments.length];if (fixed_lam1148!==undefined) {return fixed_lam1148.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var index_where = function(ls1960, f1961) {if (M2.list_p(ls1960)!==false) {var if_res1149 = M2.rvoid();} else {var if_res1149 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-where"),$rjs_core.UString.make("list?"),0,ls1960,f1961);}if_res1149;if (M2.procedure_p(f1961)!==false) {var if_res1150 = M2.procedure_arity_includes_p(f1961,1);} else {var if_res1150 = false;}if (if_res1150!==false) {var if_res1151 = M2.rvoid();} else {var if_res1151 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-where"),$rjs_core.UString.make("(-> any/c any/c)"),1,ls1960,f1961);}if_res1151;var loop1962 = function(ls1963, i1964) {if (M2.null_p(ls1963)!==false) {var if_res1153 = false;} else {if (f1961(M2.car(ls1963))!==false) {var if_res1152 = i1964;} else {var if_res1152 = loop1962(M2.cdr(ls1963),M2.add1(i1964));}var if_res1153 = if_res1152;}return if_res1153;};return loop1962(ls1960,0);};var indexes_of1965 = function(ls471966, v481967, __eq__p461968) {var ls1969 = ls471966;var v1970 = v481967;if (M2.eq_p(__eq__p461968,M10.unsafe_undefined)!==false) {var if_res1154 = M2.equal_p;} else {var if_res1154 = __eq__p461968;}var __eq__p1971 = if_res1154;if (M2.list_p(ls1969)!==false) {var if_res1155 = M2.rvoid();} else {var if_res1155 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-of"),$rjs_core.UString.make("list?"),0,ls1969,v1970);}if_res1155;if (M2.procedure_p(__eq__p1971)!==false) {var if_res1156 = M2.procedure_arity_includes_p(__eq__p1971,2);} else {var if_res1156 = false;}if (if_res1156!==false) {var if_res1157 = M2.rvoid();} else {var if_res1157 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-of"),$rjs_core.UString.make("(-> any/c any/c any/c)"),2,ls1969,v1970,__eq__p1971);}if_res1157;var loop1972 = function(ls1973, i1974) {if (M2.null_p(ls1973)!==false) {var if_res1159 = $rjs_core.Pair.makeList();} else {if (__eq__p1971(M2.car(ls1973),v1970)!==false) {var if_res1158 = M2.cons(i1974,loop1972(M2.cdr(ls1973),M2.add1(i1974)));} else {var if_res1158 = loop1972(M2.cdr(ls1973),M2.add1(i1974));}var if_res1159 = if_res1158;}return if_res1159;};return loop1972(ls1969,0);};var cl1160 = function(ls1975, v1976) {return indexes_of1965(ls1975,v1976,M10.unsafe_undefined);};var cl1161 = function(ls1977, v1978, __eq__p461979) {return indexes_of1965(ls1977,v1978,__eq__p461979);};var indexes_of = $rjs_core.attachProcedureArity(function() {var fixed_lam1162 = {'2':cl1160,'3':cl1161}[arguments.length];if (fixed_lam1162!==undefined) {return fixed_lam1162.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var indexes_where = function(ls1980, f1981) {if (M2.list_p(ls1980)!==false) {var if_res1163 = M2.rvoid();} else {var if_res1163 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-where"),$rjs_core.UString.make("list?"),0,ls1980,f1981);}if_res1163;if (M2.procedure_p(f1981)!==false) {var if_res1164 = M2.procedure_arity_includes_p(f1981,1);} else {var if_res1164 = false;}if (if_res1164!==false) {var if_res1165 = M2.rvoid();} else {var if_res1165 = M2.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-where"),$rjs_core.UString.make("(-> any/c any/c)"),1,ls1980,f1981);}if_res1165;var loop1982 = function(ls1983, i1984) {if (M2.null_p(ls1983)!==false) {var if_res1167 = $rjs_core.Pair.makeList();} else {if (f1981(M2.car(ls1983))!==false) {var if_res1166 = M2.cons(i1984,loop1982(M2.cdr(ls1983),M2.add1(i1984)));} else {var if_res1166 = loop1982(M2.cdr(ls1983),M2.add1(i1984));}var if_res1167 = if_res1166;}return if_res1167;};return loop1982(ls1980,0);};var __rjs_quoted__ = {};__rjs_quoted__.remove_duplicates28 = remove_duplicates28;__rjs_quoted__.add_between = add_between;__rjs_quoted__.check_duplicates = check_duplicates;__rjs_quoted__.range_proc = range_proc;__rjs_quoted__.remove_duplicates = remove_duplicates;__rjs_quoted__.inclusive_range_proc = inclusive_range_proc;__rjs_quoted__.add_between23 = add_between23;__rjs_quoted__.check_duplicates35 = check_duplicates35;export { __rjs_quoted__,remf_times_,remf,cartesian_product,group_by,argmax,argmin,in_permutations,permutations,in_combinations,combinations,shuffle,filter_not,append_map,partition,count,filter_map,check_duplicates,remove_duplicates,add_between,flatten,append_times_,drop_common_prefix,take_common_prefix,split_common_prefix,list_prefix_p,splitf_at_right,dropf_right,takef_right,split_at_right,take_right,drop_right,splitf_at,dropf,takef,split_at,take,drop,indexes_where,indexes_of,index_where,index_of,list_set,list_update,make_list,empty,rest,last,last_pair,tenth,ninth,eighth,seventh,sixth,fifth,fourth,third,second,first };