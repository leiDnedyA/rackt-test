import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/main.rkt.js";import * as M1 from "../../../runtime/kernel.rkt.js";import * as M2 from "./path.rkt.js";var check52 = function(x55) {if (M1.real_p(x55)!==false) {var if_res26 = M1.rvoid();} else {var if_res26 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("rationalize"),$rjs_core.UString.make("real?"),x55);}return if_res26;};var find_between53 = function(lo56, hi57) {if (M1.integer_p(lo56)!==false) {var if_res28 = lo56;} else {var lo_int58 = M1.floor(lo56);var hi_int59 = M1.floor(hi57);if (M1.__lt_(lo_int58,hi_int59)!==false) {var if_res27 = M1.add1(lo_int58);} else {var if_res27 = lo_int58+(1/find_between53(1/(hi57-lo_int58),1/(lo56-lo_int58)));}var if_res28 = if_res27;}return if_res28;};var do_find_between54 = function(lo60, hi61) {if (M1.negative_p(lo60)!==false) {var if_res29 = M1.__(find_between53(M1.__(hi61),M1.__(lo60)));} else {var if_res29 = find_between53(lo60,hi61);}return if_res29;};var rationalize = function(x62, within63) {check52(x62);check52(within63);var delta64 = M1.abs(within63);var lo65 = x62-delta64;var hi66 = x62+delta64;if (M1.not(M1.__eq_(x62,x62))!==false) {var if_res39 = x62;} else {var or_part67 = M1.equal_p(x62,Infinity);if (or_part67!==false) {var if_res30 = or_part67;} else {var if_res30 = M1.equal_p(x62,-Infinity);}if (if_res30!==false) {if (M1.equal_p(delta64,Infinity)!==false) {var if_res31 = NaN;} else {var if_res31 = x62;}var if_res38 = if_res31;} else {if (M1.equal_p(delta64,Infinity)!==false) {var if_res37 = 0.0;} else {if (M1.not(M1.__eq_(within63,within63))!==false) {var if_res36 = within63;} else {if (M1.__lt__eq_(lo65,0,hi66)!==false) {if (M1.exact_p(x62)!==false) {var if_res32 = 0;} else {var if_res32 = 0.0;}var if_res35 = if_res32;} else {var or_part68 = M1.__rjs_quoted__.inexact_p(lo65);if (or_part68!==false) {var if_res33 = or_part68;} else {var if_res33 = M1.__rjs_quoted__.inexact_p(hi66);}if (if_res33!==false) {var if_res34 = M1.exact__gt_inexact(do_find_between54(M1.inexact__gt_exact(lo65),M1.inexact__gt_exact(hi66)));} else {var if_res34 = do_find_between54(lo65,hi66);}var if_res35 = if_res34;}var if_res36 = if_res35;}var if_res37 = if_res36;}var if_res38 = if_res37;}var if_res39 = if_res38;}return if_res39;};var load_by_cd = function(n69) {if (M2.path_string_p(n69)!==false) {var if_res40 = M1.rvoid();} else {var if_res40 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("load/cd"),$rjs_core.UString.make("path-string?"),n69);}if_res40;var let_result41 = M1.__rjs_quoted__.split_path(n69);var base70 = let_result41.getAt(0);var name71 = let_result41.getAt(1);var dir_p72 = let_result41.getAt(2);if (dir_p72!==false) {var if_res44 = M1.raise(M1.__rjs_quoted__.exn_fail_filesystem(M1.string__gt_immutable_string(M1.format($rjs_core.UString.make("load/cd: cannot open a directory: ~s"),n69)),M1.current_continuation_marks()));} else {if (M1.not(M1.path_p(base70))!==false) {var if_res43 = M0.__rjs_quoted__.load(n69);} else {if (M1.not(M1.__rjs_quoted__.directory_exists_p(base70))!==false) {var if_res42 = M1.raise(M1.__rjs_quoted__.exn_fail_filesystem(M1.string__gt_immutable_string(M1.format($rjs_core.UString.make("load/cd: directory of ~s does not exist (current directory is ~s)"),n69,M1.__rjs_quoted__.current_directory())),M1.current_continuation_marks()));} else {var if_res42 = M1.rvoid();}if_res42;var orig73 = M1.__rjs_quoted__.current_directory();var if_res43 = M1.dynamic_wind(function() {return M1.__rjs_quoted__.current_directory(base70);},function() {return M0.__rjs_quoted__.load(name71);},function() {return M1.__rjs_quoted__.current_directory(orig73);});}var if_res44 = if_res43;}return if_res44;};var __load = function(load74, name75, path76) {if (M2.path_string_p(path76)!==false) {var if_res45 = M1.rvoid();} else {var if_res45 = M1.raise_argument_error(name75,$rjs_core.UString.make("path-string?"),path76);}if_res45;if (M1.__rjs_quoted__.complete_path_p(path76)!==false) {var if_res47 = load74(path76);} else {var dir77 = M1.__rjs_quoted__.current_load_relative_directory();if (dir77!==false) {var if_res46 = M1.__rjs_quoted__.path__gt_complete_path(path76,dir77);} else {var if_res46 = path76;}var if_res47 = load74(if_res46);}return if_res47;};var load_relative = function(path78) {return __load(M0.__rjs_quoted__.load,$rjs_core.PrimitiveSymbol.make("load-relative"),path78);};var load_relative_extension = function(path79) {return __load(M0.__rjs_quoted__.load_extension,$rjs_core.PrimitiveSymbol.make("load-relative-extension"),path79);};var let_result48 = M1.make_struct_type($rjs_core.PrimitiveSymbol.make("evt"),false,1,0,false,M1.list(M1.cons(M1.prop_evt,0)),M1.current_inspector(),false,$rjs_core.Pair.makeList(0));var struct_guard = let_result48.getAt(0);var make_guard = let_result48.getAt(1);var guard_p = let_result48.getAt(2);var guard_ref = let_result48.getAt(3);var guard_set_bang_ = let_result48.getAt(4);var guard_evt = function(proc80) {if (M1.procedure_p(proc80)!==false) {var if_res49 = M1.procedure_arity_includes_p(proc80,0);} else {var if_res49 = false;}if (if_res49!==false) {var if_res50 = M1.rvoid();} else {var if_res50 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("guard-evt"),$rjs_core.UString.make("(any/c . -> . evt?)"),proc80);}if_res50;return make_guard(function(self81) {return proc80();});};var channel_get = function(ch82) {if (M1.__rjs_quoted__.channel_p(ch82)!==false) {var if_res51 = M1.rvoid();} else {var if_res51 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("channel-get"),$rjs_core.UString.make("channel?"),ch82);}if_res51;return M1.__rjs_quoted__.sync(ch82);};var channel_try_get = function(ch83) {if (M1.__rjs_quoted__.channel_p(ch83)!==false) {var if_res52 = M1.rvoid();} else {var if_res52 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("channel-try-get"),$rjs_core.UString.make("channel?"),ch83);}if_res52;return M1.__rjs_quoted__.sync_by_timeout(0,ch83);};var channel_put = function(ch84, val85) {if (M1.__rjs_quoted__.channel_p(ch84)!==false) {var if_res53 = M1.rvoid();} else {var if_res53 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("channel-put"),$rjs_core.UString.make("channel?"),ch84);}if_res53;if (M1.__rjs_quoted__.sync(M1.__rjs_quoted__.channel_put_evt(ch84,val85))!==false) {var if_res54 = M1.rvoid();} else {var if_res54 = false;}return if_res54;};var port_p = function(x86) {var or_part87 = M1.input_port_p(x86);if (or_part87!==false) {var if_res55 = or_part87;} else {var if_res55 = M1.output_port_p(x86);}return if_res55;};var cl56 = function(v88) {return writeln(v88,M1.current_output_port());};var cl57 = function(v89, p90) {if (M1.output_port_p(p90)!==false) {var if_res59 = M1.rvoid();} else {var if_res59 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("writeln"),$rjs_core.UString.make("output-port?"),1,v89,p90);}if_res59;M1.write(v89,p90);return M1.newline(p90);};var writeln = $rjs_core.attachProcedureArity(function() {var fixed_lam58 = {'1':cl56,'2':cl57}[arguments.length];if (fixed_lam58!==undefined) {return fixed_lam58.apply(null,arguments);} else {return M1.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var cl60 = function(v91) {return displayln(v91,M1.current_output_port());};var cl61 = function(v92, p93) {if (M1.output_port_p(p93)!==false) {var if_res63 = M1.rvoid();} else {var if_res63 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("displayln"),$rjs_core.UString.make("output-port?"),1,v92,p93);}if_res63;M1.display(v92,p93);return M1.newline(p93);};var displayln = $rjs_core.attachProcedureArity(function() {var fixed_lam62 = {'1':cl60,'2':cl61}[arguments.length];if (fixed_lam62!==undefined) {return fixed_lam62.apply(null,arguments);} else {return M1.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var cl64 = function(v94) {return println(v94,M1.current_output_port(),0);};var cl65 = function(v95, p96) {return println(v95,p96,0);};var cl66 = function(v97, p98, d99) {if (M1.output_port_p(p98)!==false) {var if_res68 = M1.rvoid();} else {var if_res68 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("println"),$rjs_core.UString.make("output-port?"),1,v97,p98,d99);}if_res68;if (M1.number_p(d99)!==false) {var or_part100 = M1.__eq_(0,d99);if (or_part100!==false) {var if_res69 = or_part100;} else {var if_res69 = M1.__eq_(d99,1);}var if_res70 = if_res69;} else {var if_res70 = false;}if (if_res70!==false) {var if_res71 = M1.rvoid();} else {var if_res71 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("println"),$rjs_core.UString.make("(or/c 0 1)"),2,v97,p98,d99);}if_res71;M1.print(v97,p98,d99);return M1.newline(p98);};var println = $rjs_core.attachProcedureArity(function() {var fixed_lam67 = {'1':cl64,'2':cl65,'3':cl66}[arguments.length];if (fixed_lam67!==undefined) {return fixed_lam67.apply(null,arguments);} else {return M1.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2,3]);var string_no_nuls_p = function(s101) {if (M1.string_p(s101)!==false) {var if_res72 = M1.not(M1.regexp_match_p($rjs_core.Regexp.fromString("\u0000"),s101));} else {var if_res72 = false;}return if_res72;};var bytes_environment_variable_name_p = function(s102) {if (M1.bytes_p(s102)!==false) {if (M1.eq_p($rjs_core.PrimitiveSymbol.make("windows"),M1.system_type())!==false) {var if_res73 = M1.regexp_match_p($rjs_core.Regexp.fromString("^[^\u0000=]+$"),s102);} else {var if_res73 = M1.regexp_match_p($rjs_core.Regexp.fromString("^[^\u0000=]*$"),s102);}var if_res74 = if_res73;} else {var if_res74 = false;}return if_res74;};var string_environment_variable_name_p = function(s103) {if (M1.string_p(s103)!==false) {var if_res75 = bytes_environment_variable_name_p(M1.string__gt_bytes_by_locale(s103,M1.char__gt_integer($rjs_core.Char.charFromCodepoint(63))));} else {var if_res75 = false;}return if_res75;};var getenv = function(s104) {if (string_environment_variable_name_p(s104)!==false) {var if_res76 = M1.rvoid();} else {var if_res76 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("getenv"),$rjs_core.UString.make("string-environment-variable-name?"),s104);}if_res76;var v105 = M1.environment_variables_ref(M1.current_environment_variables(),M1.string__gt_bytes_by_locale(s104,M1.char__gt_integer($rjs_core.Char.charFromCodepoint(63))));if (v105!==false) {var if_res77 = M1.__rjs_quoted__.bytes__gt_string_by_locale(v105,$rjs_core.Char.charFromCodepoint(63));} else {var if_res77 = false;}return if_res77;};var putenv = function(s106, t107) {if (string_no_nuls_p(s106)!==false) {var if_res78 = M1.rvoid();} else {var if_res78 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("putenv"),$rjs_core.UString.make("string-environment-variable-name?"),0,s106,t107);}if_res78;if (string_no_nuls_p(t107)!==false) {var if_res79 = M1.rvoid();} else {var if_res79 = M1.raise_argument_error($rjs_core.PrimitiveSymbol.make("putenv"),$rjs_core.UString.make("string-no-nuls?"),1,s106,t107);}if_res79;if (M1.environment_variables_set_bang_(M1.current_environment_variables(),M1.string__gt_bytes_by_locale(s106,M1.char__gt_integer($rjs_core.Char.charFromCodepoint(63))),M1.string__gt_bytes_by_locale(t107,M1.char__gt_integer($rjs_core.Char.charFromCodepoint(63))),function() {return false;})!==false) {var if_res80 = true;} else {var if_res80 = false;}return if_res80;};var __rjs_quoted__ = {};export { __rjs_quoted__,putenv,getenv,string_environment_variable_name_p,bytes_environment_variable_name_p,println,displayln,writeln,port_p,channel_put,channel_try_get,channel_get,guard_evt,load_relative_extension,load_relative,load_by_cd,rationalize };