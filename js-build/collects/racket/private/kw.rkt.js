import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result1601 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result1601.getAt(0);var keyword_impersonator_p = let_result1601.getAt(1);var keyword_impersonator_ref = let_result1601.getAt(2);var keyword_procedure_impersonator_of = function(v2655) {if (keyword_impersonator_p(v2655)!==false) {var if_res1602 = keyword_impersonator_ref(v2655)(v2655);} else {var if_res1602 = false;}return if_res1602;};var let_result1603 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result1603.getAt(0);var mk_kw_proc = let_result1603.getAt(1);var keyword_procedure_p = let_result1603.getAt(2);var keyword_procedure_ref = let_result1603.getAt(3);var keyword_procedure_set_bang_ = let_result1603.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result1604 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result1604.getAt(0);var make_km = let_result1604.getAt(1);var keyword_method_p = let_result1604.getAt(2);var km_ref = let_result1604.getAt(3);var km_set_bang_ = let_result1604.getAt(4);var generate_arity_string = function(proc2656) {var let_result1605 = procedure_keywords(proc2656);var req2657 = let_result1605.getAt(0);var allowed2658 = let_result1605.getAt(1);var a2659 = M0.procedure_arity(proc2656);var keywords_desc2660 = function(opt2662, req2663) {var temp1611 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req2663))!==false) {var if_res1610 = M0.format($rjs_core.UString.make("an ~aargument"),opt2662);} else {var if_res1610 = M0.format($rjs_core.UString.make("~aarguments"),opt2662);}if (M0.null_p(M0.cdr(req2663))!==false) {var if_res1609 = $rjs_core.UString.make("");} else {var if_res1609 = $rjs_core.UString.make("s");}var tmp2664 = M0.length(req2663);if (M0.equal_p(tmp2664,1)!==false) {var if_res1608 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req2663));} else {if (M0.equal_p(tmp2664,2)!==false) {var if_res1607 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req2663),M0.cadr(req2663));} else {var loop2665 = function(req2666) {if (M0.null_p(M0.cdr(req2666))!==false) {var if_res1606 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req2666));} else {var if_res1606 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req2666),loop2665(M0.cdr(req2666)));}return if_res1606;};var if_res1607 = loop2665(req2663);}var if_res1608 = if_res1607;}return M0.format(temp1611,if_res1610,if_res1609,if_res1608);};var method_adjust2661 = function(a2667) {var or_part2668 = okm_p(proc2656);if (or_part2668!==false) {var if_res1612 = or_part2668;} else {var if_res1612 = keyword_method_p(proc2656);}if (if_res1612!==false) {if (M0.zero_p(a2667)!==false) {var if_res1613 = 0;} else {var if_res1613 = M0.sub1(a2667);}var if_res1614 = if_res1613;} else {var if_res1614 = a2667;}return if_res1614;};if (M0.number_p(a2659)!==false) {var a2669 = method_adjust2661(a2659);var if_res1621 = M0.format($rjs_core.UString.make("~a"),a2669);} else {if (M0.arity_at_least_p(a2659)!==false) {var a2670 = method_adjust2661(M0.arity_at_least_value(a2659));var if_res1620 = M0.format($rjs_core.UString.make("at least ~a"),a2670);} else {var if_res1620 = $rjs_core.UString.make("a different number");}var if_res1621 = if_res1620;}if (M0.null_p(req2657)!==false) {var if_res1619 = $rjs_core.UString.make("");} else {var if_res1619 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc2660($rjs_core.UString.make(""),req2657));}if (allowed2658!==false) {var loop2672 = function(req2673, allowed2674) {if (M0.null_p(req2673)!==false) {var if_res1616 = allowed2674;} else {if (M0.eq_p(M0.car(req2673),M0.car(allowed2674))!==false) {var if_res1615 = loop2672(M0.cdr(req2673),M0.cdr(allowed2674));} else {var if_res1615 = M0.cons(M0.car(allowed2674),loop2672(req2673,M0.cdr(allowed2674)));}var if_res1616 = if_res1615;}return if_res1616;};var others2671 = loop2672(req2657,allowed2658);if (M0.null_p(others2671)!==false) {var if_res1617 = $rjs_core.UString.make("");} else {var if_res1617 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc2660($rjs_core.UString.make("optional "),others2671));}var if_res1618 = if_res1617;} else {var if_res1618 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res1621,if_res1619,if_res1618);};var let_result1622 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result1622.getAt(0);var make_optional_keyword_procedure = let_result1622.getAt(1);var okp_p = let_result1622.getAt(2);var okp_ref = let_result1622.getAt(3);var okp_set_bang_ = let_result1622.getAt(4);var let_result1623 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result1623.getAt(0);var make_optional_keyword_method = let_result1623.getAt(1);var okm_p = let_result1623.getAt(2);var okm_ref = let_result1623.getAt(3);var okm_set_bang_ = let_result1623.getAt(4);var let_result1624 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result1624.getAt(0);var named_keyword_procedure_p = let_result1624.getAt(1);var keyword_procedure_name_plus_fail = let_result1624.getAt(2);var let_result1626 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v2675, info_l2676) {if (M0.exact_integer_p(v2675)!==false) {var if_res1625 = M0.make_struct_field_accessor(M0.list_ref(info_l2676,3),v2675);} else {var if_res1625 = false;}return if_res1625;});var prop_procedure_accessor = let_result1626.getAt(0);var procedure_accessor_p = let_result1626.getAt(1);var procedure_accessor_ref = let_result1626.getAt(2);var let_result1627 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result1627.getAt(0);var new_procedure_p = let_result1627.getAt(1);var new_procedure_ref = let_result1627.getAt(2);var let_result1628 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v2677) {return kpp_ref(v2677,0);})));var struct_keyword_procedure_impersonator = let_result1628.getAt(0);var make_kpp = let_result1628.getAt(1);var keyword_procedure_impersonator_p = let_result1628.getAt(2);var kpp_ref = let_result1628.getAt(3);var kpp_set_bang_ = let_result1628.getAt(4);var let_result1629 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v2678) {return kmp_ref(v2678,0);})));var struct_keyword_method_impersonator = let_result1629.getAt(0);var make_kmp = let_result1629.getAt(1);var keyword_method_impersonator_p = let_result1629.getAt(2);var kmp_ref = let_result1629.getAt(3);var kmp_set_bang_ = let_result1629.getAt(4);var let_result1630 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v2679) {return okpp_ref(v2679,0);})));var struct_okpp = let_result1630.getAt(0);var make_optional_keyword_procedure_impersonator = let_result1630.getAt(1);var okpp_p = let_result1630.getAt(2);var okpp_ref = let_result1630.getAt(3);var okpp_set_bang_ = let_result1630.getAt(4);var let_result1631 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v2680) {return okmp_ref(v2680,0);})));var struct_okmp = let_result1631.getAt(0);var make_optional_keyword_method_impersonator = let_result1631.getAt(1);var okmp_p = let_result1631.getAt(2);var okmp_ref = let_result1631.getAt(3);var okmp_set_bang_ = let_result1631.getAt(4);var let_result1632 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result1632.getAt(0);var make_kp_by_ae = let_result1632.getAt(1);var kp_by_ae_p = let_result1632.getAt(2);var kp_by_ae_ref = let_result1632.getAt(3);var kp_by_ae_set_bang_ = let_result1632.getAt(4);var let_result1633 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result1633.getAt(0);var make_km_by_ae = let_result1633.getAt(1);var km_by_ae_p = let_result1633.getAt(2);var km_by_ae_ref = let_result1633.getAt(3);var km_by_ae_set_bang_ = let_result1633.getAt(4);var let_result1634 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result1634.getAt(0);var make_kpi_by_ae = let_result1634.getAt(1);var kpi_by_ae_p = let_result1634.getAt(2);var kpi_by_ae_ref = let_result1634.getAt(3);var kpi_by_ae_set_bang_ = let_result1634.getAt(4);var let_result1635 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result1635.getAt(0);var make_kmi_by_ae = let_result1635.getAt(1);var kmi_by_ae_p = let_result1635.getAt(2);var kmi_by_ae_ref = let_result1635.getAt(3);var kmi_by_ae_set_bang_ = let_result1635.getAt(4);var make_required = function(name2681, realm2682, fail_proc2683, method_p2684, impersonator_p2685) {var or_part2691 = name2681;if (or_part2691!==false) {var if_res1639 = or_part2691;} else {var if_res1639 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p2685!==false) {if (method_p2684!==false) {var if_res1636 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res1636 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res1638 = if_res1636;} else {if (method_p2684!==false) {var if_res1637 = struct_keyword_method_by_arity_error;} else {var if_res1637 = struct_keyword_procedure_by_arity_error;}var if_res1638 = if_res1637;}var let_result1640 = M0.make_struct_type(if_res1639,if_res1638,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.vector(name2681,realm2682,fail_proc2683))),M0.current_inspector(),fail_proc2683);var s_2686 = let_result1640.getAt(0);var mk2687 = let_result1640.getAt(1);var __p2688 = let_result1640.getAt(2);var __ref2689 = let_result1640.getAt(3);var __set_bang_2690 = let_result1640.getAt(4);return mk2687;};var cl1641 = function(proc2692) {var proc_name2693 = M0.object_name(proc2692);if (M0.procedure_p(proc2692)!==false) {var if_res1644 = M0.__rjs_quoted__.procedure_realm(proc2692);} else {var if_res1644 = false;}var proc_realm2694 = if_res1644;var plain_proc2695 = $rjs_core.attachProcedureArity(function(...args26961645) {var args2696 = $rjs_core.Pair.listFromArray(args26961645);return M0.apply(proc2692,M0.rnull,M0.rnull,args2696);});if (M0.procedure_p(proc2692)!==false) {var if_res1646 = M0.arithmetic_shift(M0.procedure_arity_mask(proc2692),-2);} else {var if_res1646 = false;}var mask2697 = if_res1646;if (M0.procedure_p(plain_proc2695)!==false) {if (M0.exact_integer_p(mask2697)!==false) {if (M0.symbol_p(proc_name2693)!==false) {if (M0.symbol_p(proc_realm2694)!==false) {var if_res1647 = M0.__rjs_quoted__.procedure_reduce_arity_mask(plain_proc2695,mask2697,proc_name2693,proc_realm2694);} else {var if_res1647 = M0.__rjs_quoted__.procedure_reduce_arity_mask(plain_proc2695,mask2697,false,$rjs_core.PrimitiveSymbol.make("ignored"));}var if_res1648 = if_res1647;} else {var if_res1648 = M0.__rjs_quoted__.procedure_reduce_arity_mask(plain_proc2695,mask2697,false,$rjs_core.PrimitiveSymbol.make("ignored"));}var if_res1649 = if_res1648;} else {var if_res1649 = plain_proc2695;}var if_res1650 = if_res1649;} else {var if_res1650 = plain_proc2695;}return make_keyword_procedure(proc2692,if_res1650);};var cl1642 = function(proc2698, plain_proc2699) {if (M0.procedure_p(proc2698)!==false) {var if_res1651 = M0.procedure_arity_mask(proc2698);} else {var if_res1651 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res1651),proc2698,M0.rnull,false,plain_proc2699);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam1643 = {'1':cl1641,'2':cl1642}[arguments.length];if (fixed_lam1643!==undefined) {return fixed_lam1643.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc2700, kws2701, kw_vals2702, normal_args2703, ...normal_argss27041652) {var normal_argss2704 = $rjs_core.Pair.listFromArray(normal_argss27041652);var type_error2705 = function(what2706, which2707) {return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what2706,which2707,proc2700,kws2701,kw_vals2702,normal_args2703,normal_argss2704);};if (M0.procedure_p(proc2700)!==false) {var if_res1653 = M0.rvoid();} else {var if_res1653 = type_error2705($rjs_core.UString.make("procedure?"),0);}if_res1653;var loop2708 = function(ks2709) {if (M0.null_p(ks2709)!==false) {var if_res1660 = M0.rvoid();} else {var or_part2710 = M0.not(M0.pair_p(ks2709));if (or_part2710!==false) {var if_res1654 = or_part2710;} else {var if_res1654 = M0.not(M0.keyword_p(M0.car(ks2709)));}if (if_res1654!==false) {var if_res1659 = type_error2705($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks2709))!==false) {var if_res1658 = M0.rvoid();} else {var or_part2711 = M0.not(M0.pair_p(M0.cdr(ks2709)));if (or_part2711!==false) {var if_res1655 = or_part2711;} else {var if_res1655 = M0.not(M0.keyword_p(M0.cadr(ks2709)));}if (if_res1655!==false) {var if_res1657 = loop2708(M0.cdr(ks2709));} else {if (M0.keyword_lt__p(M0.car(ks2709),M0.cadr(ks2709))!==false) {var if_res1656 = loop2708(M0.cdr(ks2709));} else {var if_res1656 = type_error2705($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res1657 = if_res1656;}var if_res1658 = if_res1657;}var if_res1659 = if_res1658;}var if_res1660 = if_res1659;}return if_res1660;};loop2708(kws2701);if (M0.list_p(kw_vals2702)!==false) {var if_res1661 = M0.rvoid();} else {var if_res1661 = type_error2705($rjs_core.UString.make("list?"),2);}if_res1661;if (M0.__eq_(M0.length(kws2701),M0.length(kw_vals2702))!==false) {var if_res1662 = M0.rvoid();} else {var if_res1662 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws2701),$rjs_core.UString.make("value list length"),M0.length(kw_vals2702),$rjs_core.UString.make("keyword list"),kws2701,$rjs_core.UString.make("value list"),kw_vals2702);}if_res1662;var loop2713 = function(normal_argss2714, pos2715) {if (M0.null_p(M0.cdr(normal_argss2714))!==false) {var l2716 = M0.car(normal_argss2714);if (M0.list_p(l2716)!==false) {var if_res1663 = l2716;} else {var if_res1663 = type_error2705($rjs_core.UString.make("list?"),pos2715);}var if_res1664 = if_res1663;} else {var if_res1664 = M0.cons(M0.car(normal_argss2714),loop2713(M0.cdr(normal_argss2714),M0.add1(pos2715)));}return if_res1664;};var normal_args2712 = loop2713(M0.cons(normal_args2703,normal_argss2704),3);if (M0.null_p(kws2701)!==false) {var if_res1665 = M0.apply(proc2700,normal_args2712);} else {var if_res1665 = M0.apply(keyword_procedure_extract_by_method(kws2701,2+M0.length(normal_args2712),proc2700,0),kws2701,kw_vals2702,normal_args2712);}return if_res1665;});var procedure_keywords = function(p2717) {if (keyword_procedure_p(p2717)!==false) {var if_res1670 = M0.values(keyword_procedure_required(p2717),keyword_procedure_allowed(p2717));} else {if (M0.procedure_p(p2717)!==false) {if (new_procedure_p(p2717)!==false) {var v2718 = new_procedure_ref(p2717);if (M0.procedure_p(v2718)!==false) {var if_res1667 = procedure_keywords(v2718);} else {var a2719 = procedure_accessor_ref(p2717);if (a2719!==false) {var if_res1666 = procedure_keywords(a2719(p2717));} else {var if_res1666 = M0.values(M0.rnull,M0.rnull);}var if_res1667 = if_res1666;}var if_res1668 = if_res1667;} else {var if_res1668 = M0.values(M0.rnull,M0.rnull);}var if_res1669 = if_res1668;} else {var if_res1669 = M0.__rjs_quoted__.raise_argument_error_times_($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("procedure?"),p2717);}var if_res1670 = if_res1669;}return if_res1670;};var extract_keyword_root = function(p2720) {if (keyword_procedure_p(p2720)!==false) {var if_res1674 = p2720;} else {if (M0.procedure_p(p2720)!==false) {var v2721 = new_procedure_ref(p2720,false);if (M0.procedure_p(v2721)!==false) {var if_res1672 = extract_keyword_root(v2721);} else {var a2722 = procedure_accessor_ref(p2720,false);if (a2722!==false) {var if_res1671 = extract_keyword_root(a2722(p2720));} else {var if_res1671 = false;}var if_res1672 = if_res1671;}var if_res1673 = if_res1672;} else {var if_res1673 = false;}var if_res1674 = if_res1673;}return if_res1674;};var missing_kw = $rjs_core.attachProcedureArity(function(proc2723, ...args27241675) {var args2724 = $rjs_core.Pair.listFromArray(args27241675);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc2723,0),M0.rnull,M0.rnull,args2724);});var check_kw_args = function(p2725, kws2726) {var loop2727 = function(kws2728, required2729, allowed2730) {if (M0.null_p(kws2728)!==false) {if (M0.null_p(required2729)!==false) {var if_res1676 = M0.values(false,false);} else {var if_res1676 = M0.values(M0.car(required2729),false);}var if_res1685 = if_res1676;} else {if (M0.pair_p(required2729)!==false) {var if_res1677 = M0.eq_p(M0.car(required2729),M0.car(kws2728));} else {var if_res1677 = false;}if (if_res1677!==false) {var temp1680 = M0.cdr(kws2728);var temp1679 = M0.cdr(required2729);if (allowed2730!==false) {var if_res1678 = M0.cdr(allowed2730);} else {var if_res1678 = false;}var if_res1684 = loop2727(temp1680,temp1679,if_res1678);} else {if (M0.not(allowed2730)!==false) {var if_res1683 = loop2727(M0.cdr(kws2728),required2729,false);} else {if (M0.pair_p(allowed2730)!==false) {if (M0.eq_p(M0.car(allowed2730),M0.car(kws2728))!==false) {var if_res1681 = loop2727(M0.cdr(kws2728),required2729,M0.cdr(allowed2730));} else {var if_res1681 = loop2727(kws2728,required2729,M0.cdr(allowed2730));}var if_res1682 = if_res1681;} else {var if_res1682 = M0.values(false,M0.car(kws2728));}var if_res1683 = if_res1682;}var if_res1684 = if_res1683;}var if_res1685 = if_res1684;}return if_res1685;};return loop2727(kws2726,keyword_procedure_required(p2725),keyword_procedure_allowed(p2725));};var make_keyword_checker = function(req_kws2731, allowed_kws2732, arity_mask2733) {if (M0.not(allowed_kws2732)!==false) {if (M0.null_p(req_kws2731)!==false) {var if_res1688 = function(kws2734, a2735) {if (true!==false) {var if_res1686 = M0.bitwise_bit_set_p(arity_mask2733,a2735);} else {var if_res1686 = false;}return if_res1686;};} else {var if_res1688 = function(kws2736, a2737) {if (subset_p(req_kws2731,kws2736)!==false) {var if_res1687 = M0.bitwise_bit_set_p(arity_mask2733,a2737);} else {var if_res1687 = false;}return if_res1687;};}var if_res1701 = if_res1688;} else {if (M0.null_p(allowed_kws2732)!==false) {var if_res1700 = function(kws2738, a2739) {if (M0.null_p(kws2738)!==false) {var if_res1689 = M0.bitwise_bit_set_p(arity_mask2733,a2739);} else {var if_res1689 = false;}return if_res1689;};} else {if (M0.null_p(req_kws2731)!==false) {var if_res1699 = function(kws2740, a2741) {if (subset_p(kws2740,allowed_kws2732)!==false) {var if_res1690 = M0.bitwise_bit_set_p(arity_mask2733,a2741);} else {var if_res1690 = false;}return if_res1690;};} else {if (M0.list_p(req_kws2731)!==false) {if (M0.list_p(allowed_kws2732)!==false) {var if_res1691 = M0.eq_p(M0.length(req_kws2731),M0.length(allowed_kws2732));} else {var if_res1691 = false;}var if_res1692 = if_res1691;} else {var if_res1692 = false;}if (if_res1692!==false) {var if_res1698 = function(kws2742, a2743) {var loop2744 = function(kws2745, req_kws2746) {if (M0.null_p(req_kws2746)!==false) {var if_res1695 = M0.null_p(kws2745);} else {if (M0.null_p(kws2745)!==false) {var if_res1694 = false;} else {if (M0.eq_p(M0.car(kws2745),M0.car(req_kws2746))!==false) {var if_res1693 = loop2744(M0.cdr(kws2745),M0.cdr(req_kws2746));} else {var if_res1693 = false;}var if_res1694 = if_res1693;}var if_res1695 = if_res1694;}return if_res1695;};if (loop2744(kws2742,req_kws2731)!==false) {var if_res1696 = M0.bitwise_bit_set_p(arity_mask2733,a2743);} else {var if_res1696 = false;}return if_res1696;};} else {var if_res1698 = function(kws2747, a2748) {if (subsets_p(req_kws2731,kws2747,allowed_kws2732)!==false) {var if_res1697 = M0.bitwise_bit_set_p(arity_mask2733,a2748);} else {var if_res1697 = false;}return if_res1697;};}var if_res1699 = if_res1698;}var if_res1700 = if_res1699;}var if_res1701 = if_res1700;}return if_res1701;};var subset_p = function(l12749, l22750) {if (M0.null_p(l12749)!==false) {var if_res1704 = true;} else {if (M0.null_p(l22750)!==false) {var if_res1703 = false;} else {if (M0.eq_p(M0.car(l12749),M0.car(l22750))!==false) {var if_res1702 = subset_p(M0.cdr(l12749),M0.cdr(l22750));} else {var if_res1702 = subset_p(l12749,M0.cdr(l22750));}var if_res1703 = if_res1702;}var if_res1704 = if_res1703;}return if_res1704;};var subsets_p = function(l12751, l22752, l32753) {if (M0.null_p(l12751)!==false) {var if_res1709 = subset_p(l22752,l32753);} else {if (M0.null_p(l22752)!==false) {var if_res1708 = false;} else {if (M0.null_p(l32753)!==false) {var if_res1707 = false;} else {var v22754 = M0.car(l22752);if (M0.eq_p(M0.car(l12751),v22754)!==false) {var if_res1706 = subsets_p(M0.cdr(l12751),M0.cdr(l22752),M0.cdr(l32753));} else {if (M0.eq_p(v22754,M0.car(l32753))!==false) {var if_res1705 = subsets_p(l12751,M0.cdr(l22752),M0.cdr(l32753));} else {var if_res1705 = subsets_p(l12751,l22752,M0.cdr(l32753));}var if_res1706 = if_res1705;}var if_res1707 = if_res1706;}var if_res1708 = if_res1707;}var if_res1709 = if_res1708;}return if_res1709;};var keyword_procedure_extract_by_method = function(kws2755, n2756, p2757, method_n2758) {if (keyword_procedure_p(p2757)!==false) {var if_res1710 = keyword_procedure_checker(p2757)(kws2755,n2756);} else {var if_res1710 = false;}if (if_res1710!==false) {var if_res1740 = keyword_procedure_proc(p2757);} else {if (M0.not(keyword_procedure_p(p2757))!==false) {if (M0.procedure_p(p2757)!==false) {if (new_procedure_p(p2757)!==false) {var a2761 = procedure_accessor_ref(p2757);if (a2761!==false) {var if_res1711 = a2761(p2757);} else {var if_res1711 = false;}var if_res1712 = if_res1711;} else {var if_res1712 = false;}var or_part2760 = if_res1712;if (or_part2760!==false) {var if_res1715 = or_part2760;} else {var or_part2762 = M0.procedure_extract_target(p2757);if (or_part2762!==false) {var if_res1714 = or_part2762;} else {if (new_procedure_p(p2757)!==false) {var if_res1713 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res1713 = false;}var if_res1714 = if_res1713;}var if_res1715 = if_res1714;}var if_res1716 = if_res1715;} else {var if_res1716 = false;}var if_res1717 = if_res1716;} else {var if_res1717 = false;}var p22759 = if_res1717;if (p22759!==false) {if (M0.eq_p(p22759,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p32763 = keyword_procedure_extract_by_method(kws2755,M0.add1(n2756),new_procedure_ref(p2757),M0.add1(method_n2758));var if_res1719 = $rjs_core.attachProcedureArity(function(kws2764, kw_args2765, ...args27661718) {var args2766 = $rjs_core.Pair.listFromArray(args27661718);return M0.apply(p32763,kws2764,kw_args2765,M0.cons(p2757,args2766));});} else {var if_res1719 = keyword_procedure_extract_by_method(kws2755,n2756,p22759,method_n2758);}var if_res1739 = if_res1719;} else {var if_res1739 = $rjs_core.attachProcedureArity(function(kws2767, kw_args2768, ...args27691720) {var args2769 = $rjs_core.Pair.listFromArray(args27691720);if (keyword_procedure_p(p2757)!==false) {var if_res1721 = check_kw_args(p2757,kws2767);} else {var if_res1721 = M0.values(false,M0.car(kws2767));}var let_result1722 = if_res1721;var missing_kw2770 = let_result1722.getAt(0);var extra_kw2771 = let_result1722.getAt(1);var or_part2776 = keyword_method_p(p2757);if (or_part2776!==false) {var if_res1723 = or_part2776;} else {var if_res1723 = okm_p(p2757);}if (if_res1723!==false) {var if_res1724 = 1;} else {var if_res1724 = 0;}var method_n2775 = method_n2758+if_res1724;if (M0.__gt__eq_(n2756,method_n2775)!==false) {var if_res1725 = n2756-method_n2775;} else {var if_res1725 = n2756;}var n2772 = if_res1725;if (M0.null_p(args2769)!==false) {var if_res1726 = M0.null_p(kws2767);} else {var if_res1726 = false;}if (if_res1726!==false) {var if_res1727 = $rjs_core.UString.make("");} else {var if_res1727 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v2777) {return M0.format($rjs_core.UString.make("\n   ~e"),v2777);},args2769),M0.map(function(kw2778, kw_arg2779) {return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw2778,kw_arg2779);},kws2767,kw_args2768)));}var args_str2773 = if_res1727;var proc_name2774 = function(p2780) {if (named_keyword_procedure_p(p2780)!==false) {var if_res1728 = M0.vector_ref(keyword_procedure_name_plus_fail(p2780),0);} else {var if_res1728 = false;}var or_part2781 = if_res1728;if (or_part2781!==false) {var if_res1730 = or_part2781;} else {var or_part2782 = M0.object_name(p2780);if (or_part2782!==false) {var if_res1729 = or_part2782;} else {var if_res1729 = p2780;}var if_res1730 = if_res1729;}return if_res1730;};var application_message2783 = function(str2784) {return M0.__rjs_quoted__.error_message__gt_adjusted_string($rjs_core.PrimitiveSymbol.make("application"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),str2784,$rjs_core.PrimitiveSymbol.make("racket/primitive"));};var or_part2785 = extra_kw2771;if (or_part2785!==false) {var if_res1737 = or_part2785;} else {var if_res1737 = missing_kw2770;}if (if_res1737!==false) {var if_res1738 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res1738 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw2771!==false) {if (keyword_procedure_p(p2757)!==false) {var if_res1732 = application_message2783(M0.format(M0.string_append($rjs_core.UString.make("procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name2774(p2757),extra_kw2771,args_str2773));} else {if (M0.procedure_p(p2757)!==false) {var if_res1731 = application_message2783(M0.format(M0.string_append($rjs_core.UString.make("procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name2774(p2757),args_str2773));} else {var if_res1731 = application_message2783(M0.format(M0.string_append($rjs_core.UString.make("not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p2757,args_str2773));}var if_res1732 = if_res1731;}var if_res1736 = if_res1732;} else {if (missing_kw2770!==false) {var if_res1735 = application_message2783(M0.format(M0.string_append($rjs_core.UString.make("required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name2774(p2757),missing_kw2770,args_str2773));} else {var temp1734 = M0.string_append($rjs_core.UString.make("no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n2772-2)!==false) {var if_res1733 = $rjs_core.UString.make("");} else {var if_res1733 = $rjs_core.UString.make("s");}var if_res1735 = application_message2783(M0.format(temp1734,n2772-2,if_res1733,proc_name2774(p2757),args_str2773));}var if_res1736 = if_res1735;}return M0.raise(if_res1738(if_res1736,M0.current_continuation_marks()));});}var if_res1740 = if_res1739;}return if_res1740;};var keyword_procedure_extract = function(p2786, kws2787, n2788) {return keyword_procedure_extract_by_method(kws2787,n2788,p2786,0);};var cl1741 = function(proc2789, arity2790, req_kw2791, allowed_kw2792, name2793, realm2794) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc2789,arity2790,false,name2793,realm2794,req_kw2791,allowed_kw2792);};var cl1742 = function(proc2795, arity2796, req_kw2797, allowed_kw2798, name2799) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc2795,arity2796,false,name2799,$rjs_core.PrimitiveSymbol.make("racket"),req_kw2797,allowed_kw2798);};var cl1743 = function(proc2800, arity2801, req_kw2802, allowed_kw2803) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc2800,arity2801,false,false,$rjs_core.PrimitiveSymbol.make("racket"),req_kw2802,allowed_kw2803);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam1744 = {'6':cl1741,'5':cl1742,'4':cl1743}[arguments.length];if (fixed_lam1744!==undefined) {return fixed_lam1744.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6]);var cl1745 = function(proc2804, mask2805, req_kw2806, allowed_kw2807, name2808, realm2809) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc2804,false,mask2805,name2808,realm2809,req_kw2806,allowed_kw2807);};var cl1746 = function(proc2810, mask2811, req_kw2812, allowed_kw2813, name2814) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc2810,false,mask2811,name2814,$rjs_core.PrimitiveSymbol.make("racket"),req_kw2812,allowed_kw2813);};var cl1747 = function(proc2815, mask2816, req_kw2817, allowed_kw2818) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc2815,false,mask2816,false,$rjs_core.PrimitiveSymbol.make("racket"),req_kw2817,allowed_kw2818);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam1748 = {'6':cl1745,'5':cl1746,'4':cl1747}[arguments.length];if (fixed_lam1748!==undefined) {return fixed_lam1748.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6]);var do_procedure_reduce_keyword_arity = function(who2819, proc2820, arity2821, mask2822, name2823, realm2824, req_kw2825, allowed_kw2826) {if (okp_p(proc2820)!==false) {var if_res1749 = okp_ref(proc2820,0);} else {var if_res1749 = proc2820;}var p2828 = if_res1749;if (arity2821!==false) {var if_res1750 = M0.__rjs_quoted__.procedure_reduce_arity(p2828,arity2821,name2823,realm2824);} else {var if_res1750 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p2828,mask2822,name2823,realm2824);}var plain_proc2827 = if_res1750;var sorted_p2829 = function(kws2830) {var loop2831 = function(kws2832) {if (M0.null_p(kws2832)!==false) {var if_res1753 = true;} else {if (M0.null_p(M0.cdr(kws2832))!==false) {var if_res1752 = true;} else {if (M0.keyword_lt__p(M0.car(kws2832),M0.cadr(kws2832))!==false) {var if_res1751 = loop2831(M0.cdr(kws2832));} else {var if_res1751 = false;}var if_res1752 = if_res1751;}var if_res1753 = if_res1752;}return if_res1753;};return loop2831(kws2830);};if (M0.list_p(req_kw2825)!==false) {if (M0.andmap(M0.keyword_p,req_kw2825)!==false) {var if_res1754 = sorted_p2829(req_kw2825);} else {var if_res1754 = false;}var if_res1755 = if_res1754;} else {var if_res1755 = false;}if (if_res1755!==false) {var if_res1759 = M0.rvoid();} else {var temp1758 = $rjs_core.PrimitiveSymbol.make("racket/primitive");var temp1757 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part2833 = arity2821;if (or_part2833!==false) {var if_res1756 = or_part2833;} else {var if_res1756 = mask2822;}var if_res1759 = M0.__rjs_quoted__.raise_argument_error_times_(who2819,temp1758,temp1757,2,proc2820,if_res1756,req_kw2825,allowed_kw2826);}if_res1759;if (allowed_kw2826!==false) {if (M0.list_p(allowed_kw2826)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw2826)!==false) {var if_res1760 = sorted_p2829(allowed_kw2826);} else {var if_res1760 = false;}var if_res1761 = if_res1760;} else {var if_res1761 = false;}if (if_res1761!==false) {var if_res1765 = M0.rvoid();} else {var temp1764 = $rjs_core.PrimitiveSymbol.make("racket/primitive");var temp1763 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part2834 = arity2821;if (or_part2834!==false) {var if_res1762 = or_part2834;} else {var if_res1762 = mask2822;}var if_res1765 = M0.__rjs_quoted__.raise_argument_error_times_(who2819,temp1764,temp1763,3,proc2820,if_res1762,req_kw2825,allowed_kw2826);}if_res1765;if (subset_p(req_kw2825,allowed_kw2826)!==false) {var if_res1766 = M0.rvoid();} else {var if_res1766 = M0.__rjs_quoted__.raise_arguments_error_times_(who2819,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw2826,$rjs_core.UString.make("required keywords"),req_kw2825);}var if_res1767 = if_res1766;} else {var if_res1767 = M0.rvoid();}if_res1767;var let_result1768 = procedure_keywords(proc2820);var old_req2835 = let_result1768.getAt(0);var old_allowed2836 = let_result1768.getAt(1);if (subset_p(old_req2835,req_kw2825)!==false) {var if_res1769 = M0.rvoid();} else {var if_res1769 = M0.__rjs_quoted__.raise_arguments_error_times_(who2819,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req2835,$rjs_core.UString.make("requested required keywords"),req_kw2825);}if_res1769;if (old_allowed2836!==false) {if (subset_p(req_kw2825,old_allowed2836)!==false) {var if_res1770 = M0.rvoid();} else {var if_res1770 = M0.__rjs_quoted__.raise_arguments_error_times_(who2819,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed2836,$rjs_core.UString.make("requested required keywords"),req_kw2825);}if_res1770;var or_part2837 = M0.not(allowed_kw2826);if (or_part2837!==false) {var if_res1771 = or_part2837;} else {var if_res1771 = subset_p(allowed_kw2826,old_allowed2836);}if (if_res1771!==false) {var if_res1772 = M0.rvoid();} else {var if_res1772 = M0.__rjs_quoted__.raise_arguments_error_times_(who2819,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed2836,$rjs_core.UString.make("requested allowed keywords"),allowed_kw2826);}var if_res1773 = if_res1772;} else {var if_res1773 = M0.rvoid();}if_res1773;if (M0.null_p(allowed_kw2826)!==false) {var if_res1787 = plain_proc2827;} else {var or_part2839 = mask2822;if (or_part2839!==false) {var if_res1774 = or_part2839;} else {var if_res1774 = arity__gt_mask(arity2821);}var mask2838 = if_res1774;var new_mask2840 = M0.arithmetic_shift(mask2838,2);var kw_checker2841 = make_keyword_checker(req_kw2825,allowed_kw2826,new_mask2840);var proc2842 = normalize_proc(proc2820);var new_kw_proc2843 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc2842),new_mask2840);if (M0.null_p(req_kw2825)!==false) {if (okm_p(proc2842)!==false) {var if_res1775 = make_optional_keyword_method;} else {var if_res1775 = make_optional_keyword_procedure;}var if_res1786 = if_res1775(kw_checker2841,new_kw_proc2843,req_kw2825,allowed_kw2826,plain_proc2827);} else {var or_part2844 = name2823;if (or_part2844!==false) {var if_res1785 = or_part2844;} else {if (named_keyword_procedure_p(proc2842)!==false) {var if_res1783 = M0.vector_ref(keyword_procedure_name_plus_fail(proc2842),0);} else {var if_res1783 = false;}var or_part2845 = if_res1783;if (or_part2845!==false) {var if_res1784 = or_part2845;} else {var if_res1784 = M0.object_name(proc2842);}var if_res1785 = if_res1784;}if (name2823!==false) {var if_res1778 = realm2824;} else {var if_res1778 = false;}var or_part2846 = if_res1778;if (or_part2846!==false) {var if_res1782 = or_part2846;} else {if (named_keyword_procedure_p(proc2842)!==false) {var or_part2848 = M0.vector_ref(keyword_procedure_name_plus_fail(proc2842),1);if (or_part2848!==false) {var if_res1779 = or_part2848;} else {var if_res1779 = M0.__rjs_quoted__.procedure_realm(M0.vector_ref(keyword_procedure_name_plus_fail(proc2842),2));}var if_res1780 = if_res1779;} else {var if_res1780 = false;}var or_part2847 = if_res1780;if (or_part2847!==false) {var if_res1781 = or_part2847;} else {var if_res1781 = M0.__rjs_quoted__.procedure_realm(proc2842);}var if_res1782 = if_res1781;}var temp1777 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask2838,1));var or_part2849 = okm_p(proc2842);if (or_part2849!==false) {var if_res1776 = or_part2849;} else {var if_res1776 = keyword_method_p(proc2842);}var if_res1786 = make_required(if_res1785,if_res1782,temp1777,if_res1776,false)(kw_checker2841,new_kw_proc2843,req_kw2825,allowed_kw2826);}var if_res1787 = if_res1786;}return if_res1787;};var arity__gt_mask = function(a2850) {if (M0.exact_nonnegative_integer_p(a2850)!==false) {var if_res1793 = M0.arithmetic_shift(1,a2850);} else {if (M0.arity_at_least_p(a2850)!==false) {var if_res1792 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a2850))));} else {if (M0.list_p(a2850)!==false) {var loop2851 = function(mask2852, l2853) {if (M0.null_p(l2853)!==false) {var if_res1790 = mask2852;} else {var a2854 = M0.car(l2853);var or_part2855 = M0.exact_nonnegative_integer_p(a2854);if (or_part2855!==false) {var if_res1788 = or_part2855;} else {var if_res1788 = M0.arity_at_least_p(a2854);}if (if_res1788!==false) {var if_res1789 = loop2851(M0.bitwise_ior(mask2852,arity__gt_mask(a2854)),M0.cdr(l2853));} else {var if_res1789 = false;}var if_res1790 = if_res1789;}return if_res1790;};var if_res1791 = loop2851(0,a2850);} else {var if_res1791 = false;}var if_res1792 = if_res1791;}var if_res1793 = if_res1792;}return if_res1793;};var cl1794 = function(proc2857, arity2858, name2859, realm2860) {if (M0.procedure_p(proc2857)!==false) {var let_result1798 = procedure_keywords(proc2857);var req2861 = let_result1798.getAt(0);var allows2862 = let_result1798.getAt(1);if (M0.pair_p(req2861)!==false) {var if_res1799 = M0.not(M0.null_p(arity2858));} else {var if_res1799 = false;}var if_res1800 = if_res1799;} else {var if_res1800 = false;}if (if_res1800!==false) {var if_res1802 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc2857);} else {if (okm_p(proc2857)!==false) {var if_res1801 = M0.__rjs_quoted__.procedure__gt_method(proc2857);} else {var if_res1801 = proc2857;}var if_res1802 = M0.__rjs_quoted__.procedure_reduce_arity(if_res1801,arity2858,name2859,realm2860);}return if_res1802;};var cl1795 = function(proc2863, arity2864, name2865) {return new_procedure_reduce_arity(proc2863,arity2864,name2865,$rjs_core.PrimitiveSymbol.make("racket"));};var cl1796 = function(proc2866, arity2867) {return new_procedure_reduce_arity(proc2866,arity2867,false,$rjs_core.PrimitiveSymbol.make("racket"));};var procedure_reduce_arity2856 = $rjs_core.attachProcedureArity(function() {var fixed_lam1797 = {'4':cl1794,'3':cl1795,'2':cl1796}[arguments.length];if (fixed_lam1797!==undefined) {return fixed_lam1797.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4]);var new_procedure_reduce_arity = procedure_reduce_arity2856;var cl1803 = function(proc2869, mask2870, name2871, realm2872) {if (M0.procedure_p(proc2869)!==false) {var let_result1807 = procedure_keywords(proc2869);var req2873 = let_result1807.getAt(0);var allows2874 = let_result1807.getAt(1);if (M0.pair_p(req2873)!==false) {var if_res1808 = M0.not(M0.eqv_p(mask2870,0));} else {var if_res1808 = false;}var if_res1809 = if_res1808;} else {var if_res1809 = false;}if (if_res1809!==false) {var if_res1811 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc2869);} else {if (okm_p(proc2869)!==false) {var if_res1810 = M0.__rjs_quoted__.procedure__gt_method(proc2869);} else {var if_res1810 = proc2869;}var if_res1811 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res1810,mask2870,name2871,realm2872);}return if_res1811;};var cl1804 = function(proc2875, mask2876, name2877) {return new_procedure_reduce_arity_mask(proc2875,mask2876,name2877,$rjs_core.PrimitiveSymbol.make("racket"));};var cl1805 = function(proc2878, mask2879) {return new_procedure_reduce_arity_mask(proc2878,mask2879,false,$rjs_core.PrimitiveSymbol.make("racket"));};var procedure_reduce_arity2868 = $rjs_core.attachProcedureArity(function() {var fixed_lam1806 = {'4':cl1803,'3':cl1804,'2':cl1805}[arguments.length];if (fixed_lam1806!==undefined) {return fixed_lam1806.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4]);var new_procedure_reduce_arity_mask = procedure_reduce_arity2868;var procedure__gt_method2880 = function(proc2881) {var proc2882 = normalize_proc(proc2881);if (keyword_procedure_p(proc2882)!==false) {if (okm_p(proc2882)!==false) {var if_res1814 = proc2882;} else {if (keyword_method_p(proc2882)!==false) {var if_res1813 = proc2882;} else {if (okp_p(proc2882)!==false) {var if_res1812 = make_optional_keyword_method(keyword_procedure_checker(proc2882),keyword_procedure_proc(proc2882),keyword_procedure_required(proc2882),keyword_procedure_allowed(proc2882),okp_ref(proc2882,0));} else {var name_plus_fail2883 = keyword_procedure_name_plus_fail(proc2882);var mk2884 = make_required(M0.vector_ref(name_plus_fail2883,0),M0.vector_ref(name_plus_fail2883,1),M0.vector_ref(name_plus_fail2883,2),true,false);var if_res1812 = mk2884(keyword_procedure_checker(proc2882),keyword_procedure_proc(proc2882),keyword_procedure_required(proc2882),keyword_procedure_allowed(proc2882));}var if_res1813 = if_res1812;}var if_res1814 = if_res1813;}var if_res1815 = if_res1814;} else {var if_res1815 = M0.__rjs_quoted__.procedure__gt_method(proc2882);}return if_res1815;};var new_procedure__gt_method = procedure__gt_method2880;var cl1816 = function(proc2886, name2887, realm2888) {if (M0.symbol_p(name2887)!==false) {var if_res1819 = M0.symbol_p(realm2888);} else {var if_res1819 = false;}if (M0.not(if_res1819)!==false) {var if_res1821 = M0.__rjs_quoted__.procedure_rename(proc2886,name2887,realm2888);} else {var c12889 = extract_keyword_root(proc2886);if (c12889!==false) {var if_res1820 = (function(kw_p2890) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-rename"),proc2886,false,M0.procedure_arity_mask(proc2886),name2887,realm2888,keyword_procedure_required(kw_p2890),keyword_procedure_allowed(kw_p2890));})(c12889);} else {var if_res1820 = M0.__rjs_quoted__.procedure_rename(proc2886,name2887,realm2888);}var if_res1821 = if_res1820;}return if_res1821;};var cl1817 = function(proc2891, name2892) {return new_procedure_rename(proc2891,name2892,$rjs_core.PrimitiveSymbol.make("racket"));};var procedure_rename2885 = $rjs_core.attachProcedureArity(function() {var fixed_lam1818 = {'3':cl1816,'2':cl1817}[arguments.length];if (fixed_lam1818!==undefined) {return fixed_lam1818.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_rename = procedure_rename2885;var procedure_realm2893 = function(proc2894) {if (keyword_procedure_p(proc2894)!==false) {if (named_keyword_procedure_p(proc2894)!==false) {var name_plus_fail2895 = keyword_procedure_name_plus_fail(proc2894);var or_part2896 = M0.vector_ref(name_plus_fail2895,1);if (or_part2896!==false) {var if_res1822 = or_part2896;} else {var if_res1822 = M0.__rjs_quoted__.procedure_realm(M0.vector_ref(name_plus_fail2895,2));}var if_res1824 = if_res1822;} else {if (okp_p(proc2894)!==false) {var if_res1823 = M0.__rjs_quoted__.procedure_realm(okp_ref(proc2894,0));} else {var if_res1823 = M0.__rjs_quoted__.procedure_realm(keyword_procedure_proc(proc2894));}var if_res1824 = if_res1823;}var if_res1825 = if_res1824;} else {var if_res1825 = M0.__rjs_quoted__.procedure_realm(proc2894);}return if_res1825;};var new_procedure_realm = procedure_realm2893;var chaperone_procedure2897 = $rjs_core.attachProcedureArity(function(proc2898, wrap_proc2899, ...props29001826) {var props2900 = $rjs_core.Pair.listFromArray(props29001826);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc2898,wrap_proc2899,props2900);});var new_chaperone_procedure = chaperone_procedure2897;var unsafe_chaperone_procedure2901 = $rjs_core.attachProcedureArity(function(proc2902, wrap_proc2903, ...props29041827) {var props2904 = $rjs_core.Pair.listFromArray(props29041827);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc2902,wrap_proc2903,props2904);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure2901;var impersonate_procedure2905 = $rjs_core.attachProcedureArity(function(proc2906, wrap_proc2907, ...props29081828) {var props2908 = $rjs_core.Pair.listFromArray(props29081828);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc2906,wrap_proc2907,props2908);});var new_impersonate_procedure = impersonate_procedure2905;var unsafe_impersonate_procedure2909 = $rjs_core.attachProcedureArity(function(proc2910, wrap_proc2911, ...props29121829) {var props2912 = $rjs_core.Pair.listFromArray(props29121829);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc2910,wrap_proc2911,props2912);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure2909;var chaperone_procedure_times_2913 = $rjs_core.attachProcedureArity(function(proc2914, wrap_proc2915, ...props29161830) {var props2916 = $rjs_core.Pair.listFromArray(props29161830);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc2914,wrap_proc2915,props2916);});var new_chaperone_procedure_times_ = chaperone_procedure_times_2913;var impersonate_procedure_times_2917 = $rjs_core.attachProcedureArity(function(proc2918, wrap_proc2919, ...props29201831) {var props2920 = $rjs_core.Pair.listFromArray(props29201831);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc2918,wrap_proc2919,props2920);});var new_impersonate_procedure_times_ = impersonate_procedure_times_2917;var do_chaperone_procedure = function(is_impersonator_p2921, self_arg_p2922, chaperone_procedure2923, name2924, proc2925, wrap_proc2926, props2927) {var n_proc2928 = normalize_proc(proc2925);var n_wrap_proc2929 = normalize_proc(wrap_proc2926);var or_part2930 = M0.not(keyword_procedure_p(n_proc2928));if (or_part2930!==false) {var if_res1833 = or_part2930;} else {var or_part2931 = M0.not(M0.procedure_p(wrap_proc2926));if (or_part2931!==false) {var if_res1832 = or_part2931;} else {var if_res1832 = bad_props_p(props2927);}var if_res1833 = if_res1832;}if (if_res1833!==false) {var if_res1914 = M0.apply(chaperone_procedure2923,proc2925,wrap_proc2926,props2927);} else {chaperone_arity_match_checking(self_arg_p2922,name2924,proc2925,wrap_proc2926,props2927);var loop2933 = function(props2934) {if (M0.null_p(props2934)!==false) {var if_res1835 = false;} else {if (M0.eq_p(M0.car(props2934),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res1834 = M0.cadr(props2934);} else {var if_res1834 = loop2933(M0.cddr(props2934));}var if_res1835 = if_res1834;}return if_res1835;};var mark_prop2932 = loop2933(props2927);var chaperone_procedure_by_add_mark2935 = function(proc2936, wrap_proc2937) {if (mark_prop2932!==false) {var if_res1836 = chaperone_procedure2923(proc2936,wrap_proc2937,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop2932);} else {var if_res1836 = chaperone_procedure2923(proc2936,wrap_proc2937);}return if_res1836;};var p2939 = keyword_procedure_proc(n_wrap_proc2929);if (self_arg_p2922!==false) {var cl1837 = $rjs_core.attachProcedureArity(function(self_proc2940, kws2941, args2942, ...rest29431842) {var rest2943 = $rjs_core.Pair.listFromArray(rest29431842);return M0.call_with_values(function() {return M0.apply(p2939,kws2941,args2942,self_proc2940,rest2943);},$rjs_core.attachProcedureArity(function(...results29441843) {var results2944 = $rjs_core.Pair.listFromArray(results29441843);var len2945 = M0.length(results2944);var alen2946 = M0.length(rest2943);if (M0.__lt_(len2945,alen2946+1)!==false) {var if_res1844 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen2946+1,$rjs_core.UString.make("received number of results"),len2945,$rjs_core.UString.make("wrapper procedure"),wrap_proc2926);} else {var if_res1844 = M0.rvoid();}if_res1844;var num_extra2947 = len2945-(alen2946+1);var new_args2948 = M0.list_ref(results2944,num_extra2947);if (M0.list_p(new_args2948)!==false) {var if_res1845 = M0.__eq_(M0.length(new_args2948),M0.length(args2942));} else {var if_res1845 = false;}if (if_res1845!==false) {var if_res1850 = M0.rvoid();} else {var temp1849 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp1848 = $rjs_core.PrimitiveSymbol.make("racket/primitive");var temp1847 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len2945,alen2946)!==false) {var if_res1846 = $rjs_core.UString.make("");} else {var if_res1846 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res1850 = M0.__rjs_quoted__.raise_arguments_error_times_(temp1849,temp1848,M0.format(temp1847,if_res1846),$rjs_core.UString.make("first result"),new_args2948,$rjs_core.UString.make("wrapper procedure"),wrap_proc2926);}if_res1850;M0.for_each(function(kw2949, new_arg2950, arg2951) {if (is_impersonator_p2921!==false) {var if_res1852 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg2950,arg2951)!==false) {var if_res1851 = M0.rvoid();} else {var if_res1851 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw2949),$rjs_core.UString.make("result"),new_arg2950,$rjs_core.UString.make("wrapper procedure"),wrap_proc2926);}var if_res1852 = if_res1851;}return if_res1852;},kws2941,new_args2948,args2942);var tmp2952 = num_extra2947;if (M0.equal_p(tmp2952,0)!==false) {var if_res1855 = M0.apply(M0.values,kws2941,results2944);} else {if (M0.equal_p(tmp2952,1)!==false) {var if_res1854 = M0.apply(M0.values,M0.car(results2944),kws2941,M0.cdr(results2944));} else {var loop2953 = function(results2954, c2955) {if (M0.zero_p(c2955)!==false) {var if_res1853 = M0.cons(kws2941,results2954);} else {var if_res1853 = M0.cons(M0.car(results2954),loop2953(M0.cdr(results2954),M0.sub1(c2955)));}return if_res1853;};var if_res1854 = M0.apply(M0.values,loop2953(results2944,num_extra2947));}var if_res1855 = if_res1854;}return if_res1855;}));});var cl1838 = $rjs_core.attachProcedureArity(function(...other29561856) {var other2956 = $rjs_core.Pair.listFromArray(other29561856);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res1877 = $rjs_core.attachProcedureArity(function() {var fixed_lam1839 = {}[arguments.length];if (fixed_lam1839!==undefined) {return fixed_lam1839.apply(null,arguments);} else {if (M0.__gt__eq_(cl1837.length,1)!==false) {var if_res1841 = cl1837.apply(null,arguments);} else {if (true!==false) {var if_res1840 = cl1838.apply(null,arguments);} else {var if_res1840 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res1841 = if_res1840;}return if_res1841;}},[M0.make_arity_at_least(0)]);} else {var cl1857 = $rjs_core.attachProcedureArity(function(kws2957, args2958, ...rest29591862) {var rest2959 = $rjs_core.Pair.listFromArray(rest29591862);return M0.call_with_values(function() {return M0.apply(p2939,kws2957,args2958,rest2959);},$rjs_core.attachProcedureArity(function(...results29601863) {var results2960 = $rjs_core.Pair.listFromArray(results29601863);var len2961 = M0.length(results2960);var alen2962 = M0.length(rest2959);if (M0.__lt_(len2961,alen2962+1)!==false) {var if_res1864 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen2962+1,$rjs_core.UString.make("received number of results"),len2961,$rjs_core.UString.make("wrapper procedure"),wrap_proc2926);} else {var if_res1864 = M0.rvoid();}if_res1864;var num_extra2963 = len2961-(alen2962+1);var new_args2964 = M0.list_ref(results2960,num_extra2963);if (M0.list_p(new_args2964)!==false) {var if_res1865 = M0.__eq_(M0.length(new_args2964),M0.length(args2958));} else {var if_res1865 = false;}if (if_res1865!==false) {var if_res1870 = M0.rvoid();} else {var temp1869 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp1868 = $rjs_core.PrimitiveSymbol.make("racket/primitive");var temp1867 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len2961,alen2962)!==false) {var if_res1866 = $rjs_core.UString.make("");} else {var if_res1866 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res1870 = M0.__rjs_quoted__.raise_arguments_error_times_(temp1869,temp1868,M0.format(temp1867,if_res1866),$rjs_core.UString.make("first result"),new_args2964,$rjs_core.UString.make("wrapper procedure"),wrap_proc2926);}if_res1870;M0.for_each(function(kw2965, new_arg2966, arg2967) {if (is_impersonator_p2921!==false) {var if_res1872 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg2966,arg2967)!==false) {var if_res1871 = M0.rvoid();} else {var if_res1871 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw2965),$rjs_core.UString.make("result"),new_arg2966,$rjs_core.UString.make("wrapper procedure"),wrap_proc2926);}var if_res1872 = if_res1871;}return if_res1872;},kws2957,new_args2964,args2958);var tmp2968 = num_extra2963;if (M0.equal_p(tmp2968,0)!==false) {var if_res1875 = M0.apply(M0.values,kws2957,results2960);} else {if (M0.equal_p(tmp2968,1)!==false) {var if_res1874 = M0.apply(M0.values,M0.car(results2960),kws2957,M0.cdr(results2960));} else {var loop2969 = function(results2970, c2971) {if (M0.zero_p(c2971)!==false) {var if_res1873 = M0.cons(kws2957,results2970);} else {var if_res1873 = M0.cons(M0.car(results2970),loop2969(M0.cdr(results2970),M0.sub1(c2971)));}return if_res1873;};var if_res1874 = M0.apply(M0.values,loop2969(results2960,num_extra2963));}var if_res1875 = if_res1874;}return if_res1875;}));});var cl1858 = $rjs_core.attachProcedureArity(function(...other29721876) {var other2972 = $rjs_core.Pair.listFromArray(other29721876);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res1877 = $rjs_core.attachProcedureArity(function() {var fixed_lam1859 = {}[arguments.length];if (fixed_lam1859!==undefined) {return fixed_lam1859.apply(null,arguments);} else {if (M0.__gt__eq_(cl1857.length,1)!==false) {var if_res1861 = cl1857.apply(null,arguments);} else {if (true!==false) {var if_res1860 = cl1858.apply(null,arguments);} else {var if_res1860 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res1861 = if_res1860;}return if_res1861;}},[M0.make_arity_at_least(0)]);}var kw_chaperone2938 = if_res1877;var wrap2975 = function(proc2976, n_proc2977) {if (M0.not(M0.eq_p(n_proc2977,proc2976))!==false) {var if_res1878 = new_procedure_p(proc2976);} else {var if_res1878 = false;}if (if_res1878!==false) {var v2978 = new_procedure_ref(proc2976);if (M0.exact_integer_p(v2978)!==false) {var acc2979 = procedure_accessor_ref(proc2976);var if_res1906 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc2976,acc2979,function(self2980, sub_proc2981) {var let_result1879 = wrap2975(sub_proc2981,normalize_proc(sub_proc2981));var f2982 = let_result1879.getAt(0);var acc2983 = let_result1879.getAt(1);return f2982;}),acc2979);} else {if (is_impersonator_p2921!==false) {var if_res1905 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res1905 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc2977)!==false) {var if_res1904 = chaperone_procedure_by_add_mark2935(proc2976,wrap_proc2926);} else {var if_res1904 = proc2976;}var new_kw_proc2984 = if_res1905(if_res1904,new_procedure_ref,function(self2985, proc2986) {if (is_impersonator_p2921!==false) {var if_res1903 = new_impersonate_procedure;} else {var if_res1903 = new_chaperone_procedure;}if (self_arg_p2922!==false) {var cl1880 = $rjs_core.attachProcedureArity(function(proc_self2987, kws2988, kw_args2989, self2990, ...args29911885) {var args2991 = $rjs_core.Pair.listFromArray(args29911885);var len2992 = M0.length(args2991);return M0.call_with_values(function() {return M0.apply(kw_chaperone2938,proc_self2987,kws2988,kw_args2989,args2991);},$rjs_core.attachProcedureArity(function(...results29931886) {var results2993 = $rjs_core.Pair.listFromArray(results29931886);var r_len2994 = M0.length(results2993);var list_take2995 = function(l2996, n2997) {if (M0.zero_p(n2997)!==false) {var if_res1887 = M0.rnull;} else {var if_res1887 = M0.cons(M0.car(l2996),list_take2995(M0.cdr(l2996),M0.sub1(n2997)));}return if_res1887;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res1888 = M0.__eq_(r_len2994,2+len2992);} else {var if_res1888 = false;}if (if_res1888!==false) {var if_res1889 = M0.apply(M0.values,M0.cadr(results2993),self2990,M0.cddr(results2993));} else {var skip2998 = r_len2994-len2992;var if_res1889 = M0.apply(M0.values,M0.append(list_take2995(results2993,skip2998-2),M0.list(M0.list_ref(results2993,M0.sub1(skip2998)),self2990),M0.__rjs_quoted__.list_tail(results2993,skip2998)));}return if_res1889;}));});var cl1881 = $rjs_core.attachProcedureArity(function(...args29991890) {var args2999 = $rjs_core.Pair.listFromArray(args29991890);return M0.rvoid();});var if_res1902 = $rjs_core.attachProcedureArity(function() {var fixed_lam1882 = {}[arguments.length];if (fixed_lam1882!==undefined) {return fixed_lam1882.apply(null,arguments);} else {if (M0.__gt__eq_(cl1880.length,1)!==false) {var if_res1884 = cl1880.apply(null,arguments);} else {if (true!==false) {var if_res1883 = cl1881.apply(null,arguments);} else {var if_res1883 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res1884 = if_res1883;}return if_res1884;}},[M0.make_arity_at_least(0)]);} else {var cl1891 = $rjs_core.attachProcedureArity(function(kws3000, kw_args3001, self3002, ...args30031896) {var args3003 = $rjs_core.Pair.listFromArray(args30031896);var len3004 = M0.length(args3003);return M0.call_with_values(function() {return M0.apply(kw_chaperone2938,kws3000,kw_args3001,args3003);},$rjs_core.attachProcedureArity(function(...results30051897) {var results3005 = $rjs_core.Pair.listFromArray(results30051897);var r_len3006 = M0.length(results3005);var list_take3007 = function(l3008, n3009) {if (M0.zero_p(n3009)!==false) {var if_res1898 = M0.rnull;} else {var if_res1898 = M0.cons(M0.car(l3008),list_take3007(M0.cdr(l3008),M0.sub1(n3009)));}return if_res1898;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res1899 = M0.__eq_(r_len3006,2+len3004);} else {var if_res1899 = false;}if (if_res1899!==false) {var if_res1900 = M0.apply(M0.values,M0.cadr(results3005),self3002,M0.cddr(results3005));} else {var skip3010 = r_len3006-len3004;var if_res1900 = M0.apply(M0.values,M0.append(list_take3007(results3005,skip3010-2),M0.list(M0.list_ref(results3005,M0.sub1(skip3010)),self3002),M0.__rjs_quoted__.list_tail(results3005,skip3010)));}return if_res1900;}));});var cl1892 = $rjs_core.attachProcedureArity(function(...args30111901) {var args3011 = $rjs_core.Pair.listFromArray(args30111901);return M0.rvoid();});var if_res1902 = $rjs_core.attachProcedureArity(function() {var fixed_lam1893 = {}[arguments.length];if (fixed_lam1893!==undefined) {return fixed_lam1893.apply(null,arguments);} else {if (M0.__gt__eq_(cl1891.length,1)!==false) {var if_res1895 = cl1891.apply(null,arguments);} else {if (true!==false) {var if_res1894 = cl1892.apply(null,arguments);} else {var if_res1894 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res1895 = if_res1894;}return if_res1895;}},[M0.make_arity_at_least(0)]);}return if_res1903(proc2986,make_keyword_procedure(if_res1902));});var if_res1906 = M0.values(new_kw_proc2984,new_procedure_ref);}var if_res1911 = if_res1906;} else {if (okp_p(n_proc2977)!==false) {if (is_impersonator_p2921!==false) {if (okm_p(n_proc2977)!==false) {var if_res1907 = make_optional_keyword_method_impersonator;} else {var if_res1907 = make_optional_keyword_procedure_impersonator;}var if_res1908 = if_res1907(keyword_procedure_checker(n_proc2977),chaperone_procedure_by_add_mark2935(keyword_procedure_proc(n_proc2977),kw_chaperone2938),keyword_procedure_required(n_proc2977),keyword_procedure_allowed(n_proc2977),chaperone_procedure_by_add_mark2935(okp_ref(n_proc2977,0),okp_ref(n_wrap_proc2929,0)),n_proc2977);} else {var if_res1908 = M0.__rjs_quoted__.chaperone_struct(proc2976,keyword_procedure_proc,function(self3012, proc3013) {return chaperone_procedure_by_add_mark2935(proc3013,kw_chaperone2938);},M0.make_struct_field_accessor(okp_ref,0),function(self3014, proc3015) {return chaperone_procedure_by_add_mark2935(proc3015,okp_ref(n_wrap_proc2929,0));});}var if_res1910 = M0.values(if_res1908,keyword_procedure_proc);} else {if (is_impersonator_p2921!==false) {var name_plus_fail3016 = keyword_procedure_name_plus_fail(n_proc2977);var mk3017 = make_required(M0.vector_ref(name_plus_fail3016,0),M0.vector_ref(name_plus_fail3016,1),M0.vector_ref(name_plus_fail3016,2),keyword_method_p(n_proc2977),true);var if_res1909 = mk3017(keyword_procedure_checker(n_proc2977),chaperone_procedure_by_add_mark2935(keyword_procedure_proc(n_proc2977),kw_chaperone2938),keyword_procedure_required(n_proc2977),keyword_procedure_allowed(n_proc2977),n_proc2977);} else {var if_res1909 = M0.__rjs_quoted__.chaperone_struct(n_proc2977,keyword_procedure_proc,function(self3018, proc3019) {return chaperone_procedure_by_add_mark2935(proc3019,kw_chaperone2938);});}var if_res1910 = M0.values(if_res1909,keyword_procedure_proc);}var if_res1911 = if_res1910;}return if_res1911;};var let_result1912 = wrap2975(proc2925,n_proc2928);var new_proc2973 = let_result1912.getAt(0);var chap_accessor2974 = let_result1912.getAt(1);if (M0.null_p(props2927)!==false) {var if_res1913 = new_proc2973;} else {var if_res1913 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc2973,chap_accessor2974,false,props2927);}var if_res1914 = if_res1913;}return if_res1914;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure3020, name3021, proc3022, wrap_proc3023, props3024) {var n_proc3025 = normalize_proc(proc3022);var n_wrap_proc3026 = normalize_proc(wrap_proc3023);var or_part3027 = M0.not(keyword_procedure_p(n_proc3025));if (or_part3027!==false) {var if_res1916 = or_part3027;} else {var or_part3028 = M0.not(M0.procedure_p(wrap_proc3023));if (or_part3028!==false) {var if_res1915 = or_part3028;} else {var if_res1915 = bad_props_p(props3024);}var if_res1916 = if_res1915;}if (if_res1916!==false) {var if_res1917 = M0.apply(unsafe_chaperone_procedure3020,proc3022,wrap_proc3023,props3024);} else {chaperone_arity_match_checking(false,name3021,proc3022,wrap_proc3023,props3024);var if_res1917 = M0.apply(unsafe_chaperone_procedure3020,proc3022,wrap_proc3023,props3024);}return if_res1917;};var bad_props_p = function(props3029) {var loop3030 = function(props3031) {if (M0.null_p(props3031)!==false) {var if_res1920 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props3031))!==false) {var props3032 = M0.cdr(props3031);var or_part3033 = M0.null_p(props3032);if (or_part3033!==false) {var if_res1918 = or_part3033;} else {var if_res1918 = loop3030(M0.cdr(props3032));}var if_res1919 = if_res1918;} else {var if_res1919 = true;}var if_res1920 = if_res1919;}return if_res1920;};return loop3030(props3029);};var chaperone_arity_match_checking = function(self_arg_p3034, name3035, proc3036, wrap_proc3037, props3038) {var a3039 = M0.procedure_arity(proc3036);var b3040 = M0.procedure_arity(wrap_proc3037);if (self_arg_p3034!==false) {var if_res1921 = 1;} else {var if_res1921 = 0;}var d3041 = if_res1921;var let_result1922 = procedure_keywords(proc3036);var a_req3042 = let_result1922.getAt(0);var a_allow3043 = let_result1922.getAt(1);var let_result1923 = procedure_keywords(wrap_proc3037);var b_req3044 = let_result1923.getAt(0);var b_allow3045 = let_result1923.getAt(1);var includes_p3046 = function(a3047, b3048) {if (M0.number_p(b3048)!==false) {if (M0.number_p(a3047)!==false) {var if_res1925 = M0.__eq_(b3048,a3047+d3041);} else {if (M0.arity_at_least_p(a3047)!==false) {var if_res1924 = M0.__gt__eq_(b3048,M0.arity_at_least_value(a3047)+d3041);} else {var if_res1924 = M0.ormap(function(a3049) {return includes_p3046(a3049,b3048);},a3047);}var if_res1925 = if_res1924;}var if_res1929 = if_res1925;} else {if (M0.arity_at_least_p(b3048)!==false) {if (M0.number_p(a3047)!==false) {var if_res1927 = false;} else {if (M0.arity_at_least_p(a3047)!==false) {var if_res1926 = M0.__gt__eq_(M0.arity_at_least_value(b3048),M0.arity_at_least_value(a3047)+d3041);} else {var if_res1926 = M0.ormap(function(a3050) {return includes_p3046(b3048,a3050);},a3047);}var if_res1927 = if_res1926;}var if_res1928 = if_res1927;} else {var if_res1928 = M0.andmap(function(b3051) {return includes_p3046(a3047,b3051);},b3048);}var if_res1929 = if_res1928;}return if_res1929;};if (includes_p3046(b3040,a3039)!==false) {var if_res1930 = M0.rvoid();} else {var if_res1930 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc3036,wrap_proc3037,props3038);}if_res1930;if (subset_p(b_req3044,a_req3042)!==false) {var if_res1931 = M0.rvoid();} else {var if_res1931 = M0.__rjs_quoted__.raise_arguments_error_times_(name3035,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc3037,$rjs_core.UString.make("original procedure"),proc3036);}if_res1931;var or_part3052 = M0.not(b_allow3045);if (or_part3052!==false) {var if_res1933 = or_part3052;} else {if (a_allow3043!==false) {var if_res1932 = subset_p(a_allow3043,b_allow3045);} else {var if_res1932 = false;}var if_res1933 = if_res1932;}if (if_res1933!==false) {var if_res1934 = M0.rvoid();} else {var if_res1934 = M0.__rjs_quoted__.raise_arguments_error_times_(name3035,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc3037,$rjs_core.UString.make("original procedure"),proc3036);}if_res1934;return M0.rvoid();};var normalize_proc = function(proc3053) {if (keyword_procedure_p(proc3053)!==false) {var if_res1942 = proc3053;} else {if (new_procedure_p(proc3053)!==false) {var let_result1935 = procedure_keywords(proc3053);var req_kws3054 = let_result1935.getAt(0);var allowed_kws3055 = let_result1935.getAt(1);if (M0.null_p(allowed_kws3055)!==false) {var if_res1940 = proc3053;} else {var if_res1940 = make_optional_keyword_procedure(function(given_kws3056, given_argc3057) {if (M0.procedure_arity_includes_p(proc3053,given_argc3057-2,true)!==false) {var or_part3058 = M0.not(allowed_kws3055);if (or_part3058!==false) {var if_res1937 = or_part3058;} else {var if_res1937 = subset_p(given_kws3056,allowed_kws3055);}if (if_res1937!==false) {var if_res1938 = subset_p(req_kws3054,given_kws3056);} else {var if_res1938 = false;}var if_res1939 = if_res1938;} else {var if_res1939 = false;}return if_res1939;},$rjs_core.attachProcedureArity(function(kws3059, kw_args3060, ...vals30611936) {var vals3061 = $rjs_core.Pair.listFromArray(vals30611936);return keyword_apply(proc3053,kws3059,kw_args3060,vals3061);}),req_kws3054,allowed_kws3055,proc3053);}var if_res1941 = if_res1940;} else {var if_res1941 = proc3053;}var if_res1942 = if_res1941;}return if_res1942;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_unsafe_impersonate_procedure,new_impersonate_procedure,new_unsafe_chaperone_procedure,new_chaperone_procedure,new_procedure_realm,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };