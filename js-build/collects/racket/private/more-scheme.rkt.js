import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/paramz.rkt.js";var current_parameterization = function() {return M0.continuation_mark_set_first(false,M1.parameterization_key);};var call_with_parameterization = function(paramz3325, thunk3326) {if (M0.__rjs_quoted__.parameterization_p(paramz3325)!==false) {var if_res2132 = M0.rvoid();} else {var if_res2132 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("parameterization?"),0,paramz3325,thunk3326);}if_res2132;if (M0.procedure_p(thunk3326)!==false) {var if_res2133 = M0.procedure_arity_includes_p(thunk3326,0);} else {var if_res2133 = false;}if (if_res2133!==false) {var if_res2134 = M0.rvoid();} else {var if_res2134 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("(-> any)"),1,paramz3325,thunk3326);}if_res2134;var __context2135 = $rjs_core.Marks.getFrames();var __context2136;try {__context2136 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.parameterization_key,paramz3325);var __wcm_result2137 = thunk3326();} finally {$rjs_core.Marks.updateFrame(__context2135,__context2136);}return __wcm_result2137;};var let_result2139 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("break-parameterization"),false,1,0,false);var struct_break_paramz = let_result2139.getAt(0);var make_break_paramz = let_result2139.getAt(1);var break_paramz_p = let_result2139.getAt(2);var break_paramz_ref = let_result2139.getAt(3);var break_paramz_set_bang_ = let_result2139.getAt(4);var let_result2140 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("break-parameterization"),false,1,0,false,M0.rnull,M0.current_inspector());var type3327 = let_result2140.getAt(0);var maker3328 = let_result2140.getAt(1);var pred3329 = let_result2140.getAt(2);var access3330 = let_result2140.getAt(3);var mutate3331 = let_result2140.getAt(4);var let_result2141 = M0.values(type3327,maker3328,pred3329,M0.make_struct_field_accessor(access3330,0,$rjs_core.PrimitiveSymbol.make("cell")),M0.make_struct_field_mutator(mutate3331,0,$rjs_core.PrimitiveSymbol.make("cell")));var struct_break_parameterization = let_result2141.getAt(0);var make_break_parameterization = let_result2141.getAt(1);var break_parameterization_p = let_result2141.getAt(2);var break_parameterization_cell = let_result2141.getAt(3);var set_break_parameterization_cell_bang_ = let_result2141.getAt(4);var current_break_parameterization = function() {return make_break_paramz(M0.continuation_mark_set_first(false,M1.break_enabled_key));};var call_with_break_parameterization = function(paramz3332, thunk3333) {if (break_paramz_p(paramz3332)!==false) {var if_res2142 = M0.rvoid();} else {var if_res2142 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-break-parameterization"),$rjs_core.UString.make("break-parameterization?"),0,paramz3332,thunk3333);}if_res2142;if (M0.procedure_p(thunk3333)!==false) {var if_res2143 = M0.procedure_arity_includes_p(thunk3333,0);} else {var if_res2143 = false;}if (if_res2143!==false) {var if_res2144 = M0.rvoid();} else {var if_res2144 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("(-> any)"),1,paramz3332,thunk3333);}if_res2144;var __context2146 = $rjs_core.Marks.getFrames();var __context2147;try {__context2147 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,break_paramz_ref(paramz3332,0));M1.check_for_break();var __wcm_result2148 = thunk3333();} finally {$rjs_core.Marks.updateFrame(__context2146,__context2147);}var begin_res2145 = __wcm_result2148;M1.check_for_break();return begin_res2145;};var select_handler_by_no_breaks = function(e3334, bpz3335, l3336) {var __context2157 = $rjs_core.Marks.getFrames();var __context2158;try {__context2158 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,M0.make_thread_cell(false));var loop3337 = function(l3338) {if (M0.null_p(l3338)!==false) {var if_res2156 = M0.raise(e3334);} else {if (M0.caar(l3338)(e3334)!==false) {var begin_res2150 = M0.cdar(l3338)(e3334);var __context2151 = $rjs_core.Marks.getFrames();var __context2152;try {__context2152 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz3335);var __wcm_result2153 = M1.check_for_break();} finally {$rjs_core.Marks.updateFrame(__context2151,__context2152);}__wcm_result2153;var if_res2155 = begin_res2150;} else {var if_res2155 = loop3337(M0.cdr(l3338));}var if_res2156 = if_res2155;}return if_res2156;};var __wcm_result2159 = loop3337(l3336);} finally {$rjs_core.Marks.updateFrame(__context2157,__context2158);}return __wcm_result2159;};var select_handler_by_breaks_as_is = function(e3339, bpz3340, l3341) {if (M0.null_p(l3341)!==false) {var if_res2166 = M0.raise(e3339);} else {if (M0.caar(l3341)(e3339)!==false) {var __context2161 = $rjs_core.Marks.getFrames();var __context2162;try {__context2162 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz3340);M1.check_for_break();var __wcm_result2163 = M0.cdar(l3341)(e3339);} finally {$rjs_core.Marks.updateFrame(__context2161,__context2162);}var if_res2165 = __wcm_result2163;} else {var if_res2165 = select_handler_by_breaks_as_is(e3339,bpz3340,M0.cdr(l3341));}var if_res2166 = if_res2165;}return if_res2166;};var false_thread_cell = M0.make_thread_cell(false);var check_with_handlers_in_context = function(handler_prompt_key3342) {if (M0.__rjs_quoted__.continuation_prompt_available_p(handler_prompt_key3342)!==false) {var if_res2167 = M0.rvoid();} else {var if_res2167 = M0.error($rjs_core.PrimitiveSymbol.make("with-handlers"),$rjs_core.UString.make("exception handler used out of context"));}return if_res2167;};var handler_prompt_key = M0.make_continuation_prompt_tag($rjs_core.PrimitiveSymbol.make("handler-prompt-tag"));var call_handled_body = function(bpz3343, handle_proc3344, body_thunk3345) {var __context2176 = $rjs_core.Marks.getFrames();var __context2177;try {__context2177 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,false_thread_cell);var __wcm_result2178 = M0.call_with_continuation_prompt(function(bpz3346, body_thunk3347) {var __context2172 = $rjs_core.Marks.getFrames();var __context2173;try {__context2173 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz3346);var __context2168 = $rjs_core.Marks.getFrames();var __context2169;try {__context2169 = __context2168;$rjs_core.Marks.setMark(M1.exception_handler_key,function(e3348) {return M0.abort_current_continuation(handler_prompt_key,e3348);});var __wcm_result2170 = body_thunk3347();} finally {$rjs_core.Marks.updateFrame(__context2168,__context2169);}var __wcm_result2174 = __wcm_result2170;} finally {$rjs_core.Marks.updateFrame(__context2172,__context2173);}return __wcm_result2174;},handler_prompt_key,handle_proc3344,bpz3343,body_thunk3345);} finally {$rjs_core.Marks.updateFrame(__context2176,__context2177);}return __wcm_result2178;};var call_with_exception_handler = function(exnh3349, thunk3350) {var __context2181 = $rjs_core.Marks.getFrames();var __context2182;try {__context2182 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.exception_handler_key,exnh3349);var __wcm_result2183 = thunk3350();} finally {$rjs_core.Marks.updateFrame(__context2181,__context2182);}var begin_res2180 = __wcm_result2183;M0.rvoid();return begin_res2180;};var call_by_cc = M0.__rjs_quoted__.call_with_current_continuation;var not_there = M0.gensym();var do_hash_update = function(who3351, mut_p3352, set3353, ht3354, key3355, xform3356, default3357) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2191 = M0.rvoid();} else {if (M0.hash_p(ht3354)!==false) {if (mut_p3352!==false) {var if_res2185 = M0.not(M0.immutable_p(ht3354));} else {var if_res2185 = M0.immutable_p(ht3354);}var if_res2186 = if_res2185;} else {var if_res2186 = false;}if (if_res2186!==false) {var if_res2188 = M0.rvoid();} else {if (mut_p3352!==false) {var if_res2187 = $rjs_core.UString.make("(and/c hash? (not/c immutable?))");} else {var if_res2187 = $rjs_core.UString.make("(and/c hash? immutable?)");}var if_res2188 = M0.raise_argument_error(who3351,if_res2187,ht3354);}if_res2188;if (M0.procedure_p(xform3356)!==false) {var if_res2189 = M0.procedure_arity_includes_p(xform3356,1);} else {var if_res2189 = false;}if (if_res2189!==false) {var if_res2190 = M0.rvoid();} else {var if_res2190 = M0.raise_argument_error(who3351,$rjs_core.UString.make("(any/c . -> . any/c)"),xform3356);}var if_res2191 = if_res2190;}if_res2191;var v3358 = M0.hash_ref(ht3354,key3355,default3357);if (M0.eq_p(v3358,not_there)!==false) {var if_res2192 = M0.raise_mismatch_error(who3351,$rjs_core.UString.make("no value found for key: "),key3355);} else {var if_res2192 = set3353(ht3354,key3355,xform3356(v3358));}return if_res2192;};var cl2193 = function(ht3359, key3360, xform3361, default3362) {return do_hash_update($rjs_core.PrimitiveSymbol.make("hash-update"),false,M0.hash_set,ht3359,key3360,xform3361,default3362);};var cl2194 = function(ht3363, key3364, xform3365) {return hash_update(ht3363,key3364,xform3365,not_there);};var hash_update = $rjs_core.attachProcedureArity(function() {var fixed_lam2195 = {'4':cl2193,'3':cl2194}[arguments.length];if (fixed_lam2195!==undefined) {return fixed_lam2195.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var cl2196 = function(ht3366, key3367, xform3368, default3369) {return do_hash_update($rjs_core.PrimitiveSymbol.make("hash-update!"),true,M0.hash_set_bang_,ht3366,key3367,xform3368,default3369);};var cl2197 = function(ht3370, key3371, xform3372) {return hash_update_bang_(ht3370,key3371,xform3372,not_there);};var hash_update_bang_ = $rjs_core.attachProcedureArity(function() {var fixed_lam2198 = {'4':cl2196,'3':cl2197}[arguments.length];if (fixed_lam2198!==undefined) {return fixed_lam2198.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var hash_has_key_p = function(ht3373, key3374) {if (M0.hash_p(ht3373)!==false) {var if_res2199 = M0.rvoid();} else {var if_res2199 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("hash-has-key?"),$rjs_core.UString.make("hash?"),0,ht3373,key3374);}if_res2199;return M0.not(M0.eq_p(not_there,M0.hash_ref(ht3373,key3374,not_there)));};var hash_ref_bang_ = function(ht3375, key3376, new3377) {if (M0.hash_p(ht3375)!==false) {var if_res2200 = M0.not(M0.immutable_p(ht3375));} else {var if_res2200 = false;}if (if_res2200!==false) {var if_res2201 = M0.rvoid();} else {var if_res2201 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("hash-ref!"),$rjs_core.UString.make("(and/c hash? (not/c immutable?))"),0,ht3375,key3376,new3377);}if_res2201;var v3378 = M0.hash_ref(ht3375,key3376,not_there);if (M0.eq_p(not_there,v3378)!==false) {if (M0.procedure_p(new3377)!==false) {var if_res2202 = new3377();} else {var if_res2202 = new3377;}var n3379 = if_res2202;M0.hash_set_bang_(ht3375,key3376,n3379);var if_res2203 = n3379;} else {var if_res2203 = v3378;}return if_res2203;};var __rjs_quoted__ = {};__rjs_quoted__.call_by_cc = call_by_cc;__rjs_quoted__.select_handler_by_no_breaks = select_handler_by_no_breaks;__rjs_quoted__.call_handled_body = call_handled_body;__rjs_quoted__.select_handler_by_breaks_as_is = select_handler_by_breaks_as_is;export { __rjs_quoted__,hash_update_bang_,hash_update,hash_has_key_p,hash_ref_bang_,call_by_cc,call_with_exception_handler,break_paramz_p as break_parameterization_p,call_with_break_parameterization,current_break_parameterization,call_with_parameterization,current_parameterization };