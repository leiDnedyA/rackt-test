import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "./kw.rkt.js";var cl1987 = function(f3155, l3156) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1994 = true;} else {if (M0.procedure_p(f3155)!==false) {if (M0.procedure_arity_includes_p(f3155,1)!==false) {var if_res1992 = M0.list_p(l3156);} else {var if_res1992 = false;}var if_res1993 = if_res1992;} else {var if_res1993 = false;}var if_res1994 = if_res1993;}if (if_res1994!==false) {var loop3157 = function(l3158) {if (M0.null_p(l3158)!==false) {var if_res1995 = M0.rnull;} else {var r3159 = M0.cdr(l3158);var if_res1995 = M0.cons(f3155(M0.car(l3158)),loop3157(r3159));}return if_res1995;};var if_res1996 = loop3157(l3156);} else {var if_res1996 = gen_map(f3155,M0.list(l3156));}return if_res1996;};var cl1988 = function(f3160, l13161, l23162) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2001 = true;} else {if (M0.procedure_p(f3160)!==false) {if (M0.procedure_arity_includes_p(f3160,2)!==false) {if (M0.list_p(l13161)!==false) {if (M0.list_p(l23162)!==false) {var if_res1997 = M0.__eq_(M0.length(l13161),M0.length(l23162));} else {var if_res1997 = false;}var if_res1998 = if_res1997;} else {var if_res1998 = false;}var if_res1999 = if_res1998;} else {var if_res1999 = false;}var if_res2000 = if_res1999;} else {var if_res2000 = false;}var if_res2001 = if_res2000;}if (if_res2001!==false) {var loop3163 = function(l13164, l23165) {if (M0.null_p(l13164)!==false) {var if_res2002 = M0.rnull;} else {var r13166 = M0.cdr(l13164);var r23167 = M0.cdr(l23165);var if_res2002 = M0.cons(f3160(M0.car(l13164),M0.car(l23165)),loop3163(r13166,r23167));}return if_res2002;};var if_res2003 = loop3163(l13161,l23162);} else {var if_res2003 = gen_map(f3160,M0.list(l13161,l23162));}return if_res2003;};var cl1989 = $rjs_core.attachProcedureArity(function(f3168, l3169, ...args31702004) {var args3170 = $rjs_core.Pair.listFromArray(args31702004);return gen_map(f3168,M0.cons(l3169,args3170));});var map3154 = $rjs_core.attachProcedureArity(function() {var fixed_lam1990 = {'2':cl1987,'3':cl1988}[arguments.length];if (fixed_lam1990!==undefined) {return fixed_lam1990.apply(null,arguments);} else {if (M0.__gt__eq_(cl1989.length,1)!==false) {var if_res1991 = cl1989.apply(null,arguments);} else {var if_res1991 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res1991;}},[M0.make_arity_at_least(2)]);var map2 = map3154;var cl2005 = function(f3172, l3173) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2012 = true;} else {if (M0.procedure_p(f3172)!==false) {if (M0.procedure_arity_includes_p(f3172,1)!==false) {var if_res2010 = M0.list_p(l3173);} else {var if_res2010 = false;}var if_res2011 = if_res2010;} else {var if_res2011 = false;}var if_res2012 = if_res2011;}if (if_res2012!==false) {var loop3174 = function(l3175) {if (M0.null_p(l3175)!==false) {var if_res2013 = M0.rvoid();} else {var r3176 = M0.cdr(l3175);f3172(M0.car(l3175));var if_res2013 = loop3174(r3176);}return if_res2013;};var if_res2014 = loop3174(l3173);} else {var if_res2014 = gen_for_each(f3172,M0.list(l3173));}return if_res2014;};var cl2006 = function(f3177, l13178, l23179) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2019 = true;} else {if (M0.procedure_p(f3177)!==false) {if (M0.procedure_arity_includes_p(f3177,2)!==false) {if (M0.list_p(l13178)!==false) {if (M0.list_p(l23179)!==false) {var if_res2015 = M0.__eq_(M0.length(l13178),M0.length(l23179));} else {var if_res2015 = false;}var if_res2016 = if_res2015;} else {var if_res2016 = false;}var if_res2017 = if_res2016;} else {var if_res2017 = false;}var if_res2018 = if_res2017;} else {var if_res2018 = false;}var if_res2019 = if_res2018;}if (if_res2019!==false) {var loop3180 = function(l13181, l23182) {if (M0.null_p(l13181)!==false) {var if_res2020 = M0.rvoid();} else {var r13183 = M0.cdr(l13181);var r23184 = M0.cdr(l23182);f3177(M0.car(l13181),M0.car(l23182));var if_res2020 = loop3180(r13183,r23184);}return if_res2020;};var if_res2021 = loop3180(l13178,l23179);} else {var if_res2021 = gen_for_each(f3177,M0.list(l13178,l23179));}return if_res2021;};var cl2007 = $rjs_core.attachProcedureArity(function(f3185, l3186, ...args31872022) {var args3187 = $rjs_core.Pair.listFromArray(args31872022);return gen_for_each(f3185,M0.cons(l3186,args3187));});var for_each3171 = $rjs_core.attachProcedureArity(function() {var fixed_lam2008 = {'2':cl2005,'3':cl2006}[arguments.length];if (fixed_lam2008!==undefined) {return fixed_lam2008.apply(null,arguments);} else {if (M0.__gt__eq_(cl2007.length,1)!==false) {var if_res2009 = cl2007.apply(null,arguments);} else {var if_res2009 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res2009;}},[M0.make_arity_at_least(2)]);var for_each2 = for_each3171;var cl2023 = function(f3189, l3190) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2030 = true;} else {if (M0.procedure_p(f3189)!==false) {if (M0.procedure_arity_includes_p(f3189,1)!==false) {var if_res2028 = M0.list_p(l3190);} else {var if_res2028 = false;}var if_res2029 = if_res2028;} else {var if_res2029 = false;}var if_res2030 = if_res2029;}if (if_res2030!==false) {if (M0.null_p(l3190)!==false) {var if_res2033 = true;} else {var loop3191 = function(l3192) {if (M0.null_p(M0.cdr(l3192))!==false) {var if_res2032 = f3189(M0.car(l3192));} else {var r3193 = M0.cdr(l3192);if (f3189(M0.car(l3192))!==false) {var if_res2031 = loop3191(r3193);} else {var if_res2031 = false;}var if_res2032 = if_res2031;}return if_res2032;};var if_res2033 = loop3191(l3190);}var if_res2034 = if_res2033;} else {var if_res2034 = gen_andmap(f3189,M0.list(l3190));}return if_res2034;};var cl2024 = function(f3194, l13195, l23196) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2039 = true;} else {if (M0.procedure_p(f3194)!==false) {if (M0.procedure_arity_includes_p(f3194,2)!==false) {if (M0.list_p(l13195)!==false) {if (M0.list_p(l23196)!==false) {var if_res2035 = M0.__eq_(M0.length(l13195),M0.length(l23196));} else {var if_res2035 = false;}var if_res2036 = if_res2035;} else {var if_res2036 = false;}var if_res2037 = if_res2036;} else {var if_res2037 = false;}var if_res2038 = if_res2037;} else {var if_res2038 = false;}var if_res2039 = if_res2038;}if (if_res2039!==false) {if (M0.null_p(l13195)!==false) {var if_res2042 = true;} else {var loop3197 = function(l13198, l23199) {if (M0.null_p(M0.cdr(l13198))!==false) {var if_res2041 = f3194(M0.car(l13198),M0.car(l23199));} else {var r13200 = M0.cdr(l13198);var r23201 = M0.cdr(l23199);if (f3194(M0.car(l13198),M0.car(l23199))!==false) {var if_res2040 = loop3197(r13200,r23201);} else {var if_res2040 = false;}var if_res2041 = if_res2040;}return if_res2041;};var if_res2042 = loop3197(l13195,l23196);}var if_res2043 = if_res2042;} else {var if_res2043 = gen_andmap(f3194,M0.list(l13195,l23196));}return if_res2043;};var cl2025 = $rjs_core.attachProcedureArity(function(f3202, l3203, ...args32042044) {var args3204 = $rjs_core.Pair.listFromArray(args32042044);return gen_andmap(f3202,M0.cons(l3203,args3204));});var andmap3188 = $rjs_core.attachProcedureArity(function() {var fixed_lam2026 = {'2':cl2023,'3':cl2024}[arguments.length];if (fixed_lam2026!==undefined) {return fixed_lam2026.apply(null,arguments);} else {if (M0.__gt__eq_(cl2025.length,1)!==false) {var if_res2027 = cl2025.apply(null,arguments);} else {var if_res2027 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res2027;}},[M0.make_arity_at_least(2)]);var andmap2 = andmap3188;var cl2045 = function(f3206, l3207) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2052 = true;} else {if (M0.procedure_p(f3206)!==false) {if (M0.procedure_arity_includes_p(f3206,1)!==false) {var if_res2050 = M0.list_p(l3207);} else {var if_res2050 = false;}var if_res2051 = if_res2050;} else {var if_res2051 = false;}var if_res2052 = if_res2051;}if (if_res2052!==false) {if (M0.null_p(l3207)!==false) {var if_res2055 = false;} else {var loop3208 = function(l3209) {if (M0.null_p(M0.cdr(l3209))!==false) {var if_res2054 = f3206(M0.car(l3209));} else {var r3210 = M0.cdr(l3209);var or_part3211 = f3206(M0.car(l3209));if (or_part3211!==false) {var if_res2053 = or_part3211;} else {var if_res2053 = loop3208(r3210);}var if_res2054 = if_res2053;}return if_res2054;};var if_res2055 = loop3208(l3207);}var if_res2056 = if_res2055;} else {var if_res2056 = gen_ormap(f3206,M0.list(l3207));}return if_res2056;};var cl2046 = function(f3212, l13213, l23214) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2061 = true;} else {if (M0.procedure_p(f3212)!==false) {if (M0.procedure_arity_includes_p(f3212,2)!==false) {if (M0.list_p(l13213)!==false) {if (M0.list_p(l23214)!==false) {var if_res2057 = M0.__eq_(M0.length(l13213),M0.length(l23214));} else {var if_res2057 = false;}var if_res2058 = if_res2057;} else {var if_res2058 = false;}var if_res2059 = if_res2058;} else {var if_res2059 = false;}var if_res2060 = if_res2059;} else {var if_res2060 = false;}var if_res2061 = if_res2060;}if (if_res2061!==false) {if (M0.null_p(l13213)!==false) {var if_res2064 = false;} else {var loop3215 = function(l13216, l23217) {if (M0.null_p(M0.cdr(l13216))!==false) {var if_res2063 = f3212(M0.car(l13216),M0.car(l23217));} else {var r13218 = M0.cdr(l13216);var r23219 = M0.cdr(l23217);var or_part3220 = f3212(M0.car(l13216),M0.car(l23217));if (or_part3220!==false) {var if_res2062 = or_part3220;} else {var if_res2062 = loop3215(r13218,r23219);}var if_res2063 = if_res2062;}return if_res2063;};var if_res2064 = loop3215(l13213,l23214);}var if_res2065 = if_res2064;} else {var if_res2065 = gen_ormap(f3212,M0.list(l13213,l23214));}return if_res2065;};var cl2047 = $rjs_core.attachProcedureArity(function(f3221, l3222, ...args32232066) {var args3223 = $rjs_core.Pair.listFromArray(args32232066);return gen_ormap(f3221,M0.cons(l3222,args3223));});var ormap3205 = $rjs_core.attachProcedureArity(function() {var fixed_lam2048 = {'2':cl2045,'3':cl2046}[arguments.length];if (fixed_lam2048!==undefined) {return fixed_lam2048.apply(null,arguments);} else {if (M0.__gt__eq_(cl2047.length,1)!==false) {var if_res2049 = cl2047.apply(null,arguments);} else {var if_res2049 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res2049;}},[M0.make_arity_at_least(2)]);var ormap2 = ormap3205;var check_args = function(who3224, f3225, ls3226) {if (M0.procedure_p(f3225)!==false) {var if_res2067 = M0.rvoid();} else {var if_res2067 = M0.raise_argument_error(who3224,$rjs_core.UString.make("procedure?"),f3225);}if_res2067;var loop3227 = function(prev_len3228, ls3229, i3230) {if (M0.null_p(ls3229)!==false) {var if_res2071 = M0.rvoid();} else {var l3231 = M0.car(ls3229);if (M0.list_p(l3231)!==false) {var if_res2068 = M0.rvoid();} else {var if_res2068 = M0.raise_argument_error(who3224,$rjs_core.UString.make("list?"),l3231);}if_res2068;var len3232 = M0.length(l3231);if (prev_len3228!==false) {var if_res2069 = M0.not(M0.__eq_(len3232,prev_len3228));} else {var if_res2069 = false;}if (if_res2069!==false) {var if_res2070 = M0.raise_arguments_error(who3224,$rjs_core.UString.make("all lists must have same size"),$rjs_core.UString.make("first list length"),prev_len3228,$rjs_core.UString.make("other list length"),len3232,$rjs_core.UString.make("procedure"),f3225);} else {var if_res2070 = M0.rvoid();}if_res2070;var if_res2071 = loop3227(len3232,M0.cdr(ls3229),M0.add1(i3230));}return if_res2071;};loop3227(false,ls3226,1);if (M0.procedure_arity_includes_p(f3225,M0.length(ls3226))!==false) {var if_res2088 = M0.rvoid();} else {var let_result2072 = M1.procedure_keywords(f3225);var required_keywords3233 = let_result2072.getAt(0);var optional_keywords3234 = let_result2072.getAt(1);if (M0.pair_p(required_keywords3233)!==false) {var if_res2087 = M0.string_append($rjs_core.UString.make("argument mismatch;\n"),$rjs_core.UString.make(" the given procedure expects keyword arguments"));} else {var if_res2087 = M0.string_append($rjs_core.UString.make("argument mismatch;\n"),$rjs_core.UString.make(" the given procedure's expected number of arguments does not match"),$rjs_core.UString.make(" the given number of lists"));}var temp2086 = $rjs_core.UString.make("given procedure");var n3236 = M0.object_name(f3225);if (M0.symbol_p(n3236)!==false) {var if_res2083 = M0.symbol__gt_string(n3236);} else {var if_res2083 = false;}var or_part3235 = if_res2083;if (or_part3235!==false) {var if_res2084 = or_part3235;} else {var if_res2084 = $rjs_core.UString.make("#<procedure>");}var temp2085 = M0.unquoted_printing_string(if_res2084);var a3237 = M0.procedure_arity(f3225);if (M0.pair_p(required_keywords3233)!==false) {var if_res2082 = M0.rnull;} else {if (M0.integer_p(a3237)!==false) {var if_res2081 = M0.list($rjs_core.UString.make("expected"),a3237);} else {if (M0.arity_at_least_p(a3237)!==false) {var if_res2080 = M0.list($rjs_core.UString.make("expected"),M0.unquoted_printing_string(M0.string_append($rjs_core.UString.make("at least "),M0.number__gt_string(M0.arity_at_least_value(a3237)))));} else {var if_res2080 = M0.rnull;}var if_res2081 = if_res2080;}var if_res2082 = if_res2081;}if (M0.pair_p(required_keywords3233)!==false) {var if_res2079 = M0.rnull;} else {var if_res2079 = M0.list($rjs_core.UString.make("given"),M0.length(ls3226));}if (M0.pair_p(required_keywords3233)!==false) {var temp2077 = $rjs_core.UString.make("required keywords");var loop3238 = function(kws3239) {if (M0.null_p(kws3239)!==false) {var if_res2076 = M0.rnull;} else {var if_res2076 = M0.list_times_($rjs_core.UString.make(" "),M0.string_append($rjs_core.UString.make("#:"),M0.__rjs_quoted__.keyword__gt_string(M0.car(kws3239))),loop3238(M0.cdr(kws3239)));}return if_res2076;};var if_res2078 = M0.list(temp2077,M0.unquoted_printing_string(M0.apply(M0.string_append,M0.cdr(loop3238(required_keywords3233)))));} else {var if_res2078 = M0.rnull;}var w3240 = M0.quotient(M0.error_print_width(),M0.length(ls3226));if (M0.__gt_(w3240,10)!==false) {var temp2074 = $rjs_core.UString.make("argument lists...");var loop3241 = function(ls3242) {if (M0.null_p(ls3242)!==false) {var if_res2073 = M0.rnull;} else {var if_res2073 = M0.cons(M0.string_append($rjs_core.UString.make("\n   "),M0.error_value__gt_string_handler()(M0.car(ls3242),w3240)),loop3241(M0.cdr(ls3242)));}return if_res2073;};var if_res2075 = M0.list(temp2074,M0.unquoted_printing_string(M0.apply(M0.string_append,loop3241(ls3226))));} else {var if_res2075 = M0.rnull;}var if_res2088 = M0.apply(M0.raise_arguments_error,who3224,if_res2087,temp2086,temp2085,M0.append(if_res2082,if_res2079,if_res2078,if_res2075));}return if_res2088;};var gen_map = function(f3243, ls3244) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2089 = true;} else {var if_res2089 = check_args($rjs_core.PrimitiveSymbol.make("map"),f3243,ls3244);}if_res2089;var loop3245 = function(ls3246) {if (M0.null_p(M0.car(ls3246))!==false) {var if_res2090 = M0.rnull;} else {var next_ls3247 = map2(M0.cdr,ls3246);var if_res2090 = M0.cons(M0.apply(f3243,map2(M0.car,ls3246)),loop3245(next_ls3247));}return if_res2090;};return loop3245(ls3244);};var gen_for_each = function(f3248, ls3249) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2091 = true;} else {var if_res2091 = check_args($rjs_core.PrimitiveSymbol.make("for-each"),f3248,ls3249);}if_res2091;var loop3250 = function(ls3251) {if (M0.null_p(M0.car(ls3251))!==false) {var if_res2092 = M0.rvoid();} else {var next_ls3252 = map2(M0.cdr,ls3251);M0.apply(f3248,map2(M0.car,ls3251));var if_res2092 = loop3250(next_ls3252);}return if_res2092;};return loop3250(ls3249);};var gen_andmap = function(f3253, ls3254) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2093 = true;} else {var if_res2093 = check_args($rjs_core.PrimitiveSymbol.make("andmap"),f3253,ls3254);}if_res2093;var loop3255 = function(ls3256) {if (M0.null_p(M0.car(ls3256))!==false) {var if_res2096 = true;} else {if (M0.null_p(M0.cdar(ls3256))!==false) {var if_res2095 = M0.apply(f3253,map2(M0.car,ls3256));} else {var next_ls3257 = map2(M0.cdr,ls3256);if (M0.apply(f3253,map2(M0.car,ls3256))!==false) {var if_res2094 = loop3255(next_ls3257);} else {var if_res2094 = false;}var if_res2095 = if_res2094;}var if_res2096 = if_res2095;}return if_res2096;};return loop3255(ls3254);};var gen_ormap = function(f3258, ls3259) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2097 = true;} else {var if_res2097 = check_args($rjs_core.PrimitiveSymbol.make("ormap"),f3258,ls3259);}if_res2097;var loop3260 = function(ls3261) {if (M0.null_p(M0.car(ls3261))!==false) {var if_res2100 = false;} else {if (M0.null_p(M0.cdar(ls3261))!==false) {var if_res2099 = M0.apply(f3258,map2(M0.car,ls3261));} else {var next_ls3262 = map2(M0.cdr,ls3261);var or_part3263 = M0.apply(f3258,map2(M0.car,ls3261));if (or_part3263!==false) {var if_res2098 = or_part3263;} else {var if_res2098 = loop3260(next_ls3262);}var if_res2099 = if_res2098;}var if_res2100 = if_res2099;}return if_res2100;};return loop3260(ls3259);};M0.rvoid();var __rjs_quoted__ = {};export { __rjs_quoted__,ormap2 as ormap,andmap2 as andmap,for_each2 as for_each,map2 as map };